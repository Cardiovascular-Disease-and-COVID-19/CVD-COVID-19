---
title: "CVD+COVID-19"
output: html_document
date: "2023-03-04"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

#Loading and naming the dataset
```{r}
load("C:/Users/[name_of_author]/Downloads/import.tbl_partner_general3 (2).rda")
ls()
data<-import.tbl_partner_general3
rm(import.tbl_partner_general3)
```

#Packages
```{r, eval=FALSE}
.libPaths()
help(.libPaths)
.libPaths( "C:/Program Files/R/R-4.1.3/library" )
.libPaths()
install.packages("tidyverse")
install.packages("finalfit")
install.packages("table1")
install.packages("flextable")
install.packages("survival")
```

# Overall number of each cardiovascular comorbidity
```{r}
label(data$comorbid_cardiac_arrhythmia) <- "Comorbidity- Cardiac arrhythmia"
label(data$comorbid_chronic_cardiac_disease) <- "Comorbidity- Chronic cardiac disease"
label(data$comorbid_congestive_heart_failure) <- "Comorbidity- Congestive heart failure"
label(data$comorbid_hypertension) <- "Comorbidity- Hypertension"
label(data$comorbid_myocardial_infarction) <- "Comorbidity- Myocardial infarction"
label(data$comorbid_peripheral_vascular_disease) <- "Comorbidity- Peripheral vascular disease"

table1(~ comorbid_cardiac_arrhythmia + comorbid_chronic_cardiac_disease + comorbid_congestive_heart_failure + comorbid_hypertension + comorbid_myocardial_infarction + comorbid_peripheral_vascular_disease, data = data)

dataforoverallcardiovascularcomorbidity <- data.frame(Comorbidity=rep(c("Cardiac arrhythmia", "Chronic cardiac disease", "Congestive heart failure", "Hypertension", "Myocardial infarction", "Peripheral vascular disease"), each=3), Result=rep(c("Yes", "No", "Missing"),6), Overall_frequency_of_comorbidity=c(20, 20, 800419, 23786, 15997, 760676, 3, 0, 800456, 115003, 16435, 669021, 24, 0, 800435, 9, 1, 800449))
dataforoverallcardiovascularcomorbidity
ggplot(data=dataforoverallcardiovascularcomorbidity, aes(x=Comorbidity, y=Overall_frequency_of_comorbidity, fill=Result)) + geom_bar(stat="identity", position=position_dodge()) + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + geom_text(aes(label=Overall_frequency_of_comorbidity), vjust=1.6, color="black", position = position_dodge(0.9), size=4.5) + xlab("Comorbidity") + ylab("Frequency of comorbidity (pseudo log scale)") + theme(axis.title.x=element_text(size=20), axis.title.y=element_text(size=20), axis.text.x=element_text(size=13), axis.text.y=element_text(size=15))
```

# Overall number of each cardiovascular complication
```{r}
label(data$comps_atrial_fibrillation) <- "Complication- Atrial fibrillation"
label(data$comps_cardiac_arrest) <- "Complication- Cardiac arrest"
label(data$comps_cardiac_arrhythmia) <- "Complication- Cardiac arrhythmia"
label(data$comps_cardiac_ischaemia) <- "Complication- Cardiac ischaemia"
label(data$comps_cardiomyopathy) <- "Complication- Cardiomyopathy"
label(data$comps_coagulation_disorder) <- "Complication- Coagulation disorder"
label(data$comps_congestive_heart_failure) <- "Complication- Congestive heart failure"
label(data$comps_endocarditis) <- "Complication- Endocarditis"
label(data$comps_endocarditis_myocarditis_pericarditis) <- "Complication- Endocarditis, Myocarditis, Pericarditis"
label(data$comps_myocardial_infarction) <- "Complication- Myocardial infarction"
label(data$comps_myocarditis) <- "Complication- Myocarditis"
label(data$comps_myocarditis_pericarditis) <- "Complication- Myocarditis, Pericarditis"
label(data$comps_pericarditis) <- "Complication- Pericarditis"
label(data$comps_pleural_effusion) <- "Complication- Pleural effusion"
label(data$comps_pulmonary_embolism) <- "Complication- Pulmonary embolism"
label(data$comps_pulmonary_embolism_or_dvt) <- "Complication- Pulmonary embolism or DVT"
label(data$comps_stroke) <- "Complication- Stroke"
label(data$comps_thromboembolic_phenomena) <- "Complication- Thromboembolic phenomena"
label(data$comps_thromboembolsim) <- "Complication- Thromboembolism"

table1(~ comps_atrial_fibrillation + comps_cardiac_arrest + comps_cardiac_arrhythmia + comps_cardiac_ischaemia + comps_cardiomyopathy + comps_coagulation_disorder + comps_congestive_heart_failure + comps_endocarditis + comps_endocarditis_myocarditis_pericarditis + comps_myocardial_infarction + comps_myocarditis + comps_myocarditis_pericarditis + comps_pericarditis + comps_pleural_effusion + comps_pulmonary_embolism + comps_pulmonary_embolism_or_dvt + comps_stroke + comps_thromboembolic_phenomena + comps_thromboembolsim, data = data)

dataforoverallcardiovascularcomplication <- data.frame(Complication=rep(c("Atrial fibrillation", "Cardiac arrest", "Cardiac arrhythmia", "Cardiac ischaemia", "Cardiomyopathy", "Coagulation disorder", "Congestive heart failure", "Endocarditis", "Endocarditis, Myocarditis, Pericarditis", "Myocardial infarction", "Myocarditis", "Myocarditis, Pericarditis", "Pericarditis", "Pleural effusion", "Pulmonary embolism", "Pulmonary embolism or DVT", "Stroke", "Thromboembolic phenomena", "Thromboembolism"), each=3), Result=rep(c("Yes", "No", "Missing"),19), Overall_frequency_of_complication=c(4, 0, 800455, 7702, 248118, 544639, 17108, 236181, 547170, 3319, 240533, 556607, 1237, 208640, 590582, 9640, 243024, 547795, 7671, 245700, 547088, 239, 54732, 745488, 596, 205132, 594731, 389, 42103, 757967, 46, 3401, 797012, 1023, 198352, 601084, 7, 2435, 798017, 13146, 241310, 546003, 5450, 155022, 639987, 405, 188293, 611761, 3870, 251326, 545263, 64, 2174, 798221, 73, 5327, 795059))
dataforoverallcardiovascularcomplication
ggplot(data=dataforoverallcardiovascularcomplication, aes(x=Complication, y=Overall_frequency_of_complication, fill=Result)) + geom_bar(stat="identity", position=position_dodge()) + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + geom_text(aes(label=Overall_frequency_of_complication), hjust = 1, angle=90, color="black", position = position_dodge(0.9), size=5) + xlab("Complication") + ylab("Frequency of complication (pseudo log scale)") + theme(axis.title.x=element_text(size=15), axis.title.y=element_text(size=15), axis.text.x=element_text(size=13, angle=90, hjust=1, vjust=0.5), axis.text.y=element_text(size=10))
```

#Number of each cardiovascular comorbidity by country
```{r}
table1(~ country, data = data)
table1(~ comorbid_cardiac_arrhythmia + comorbid_chronic_cardiac_disease + comorbid_congestive_heart_failure + comorbid_hypertension + comorbid_myocardial_infarction + comorbid_peripheral_vascular_disease | country, data = data)

data2 <- data
# group countries with fewer than 1000 individuals together
data2$country_grouped <- as.character(data2$country)
data2[which(data2$country %in% names(which(table(data2$country) < 1000))),]$country_grouped <- "Other"
data2$country_grouped
table1(~ country_grouped, data=data2)
table1(~ comorbid_cardiac_arrhythmia + comorbid_chronic_cardiac_disease + comorbid_congestive_heart_failure + comorbid_hypertension + comorbid_myocardial_infarction + comorbid_peripheral_vascular_disease | country_grouped, data = data2)
table1(~ country_grouped | comorbid_cardiac_arrhythmia, data=data2)
table1(~ country_grouped | comorbid_chronic_cardiac_disease, data=data2)
table1(~ country_grouped | comorbid_congestive_heart_failure, data=data2)
table1(~ country_grouped | comorbid_hypertension, data=data2)
table1(~ country_grouped | comorbid_myocardial_infarction, data=data2)
table1(~ country_grouped | comorbid_peripheral_vascular_disease, data=data2)

dataforcomorbiditiesbycountry1 <- data.frame(Comorbidity=rep(c("Cardiac arrhythmia- Yes", "Cardiac arrhythmia- No", "Cardiac arrhythmia- Missing", "Chronic cardiac disease- Yes", "Chronic cardiac disease- No", "Chronic cardiac disease- Missing", "Congestive heart failure- Yes", "Congestive heart failure- No", "Congestive heart failure- Missing", "Hypertension- Yes", "Hypertension- No", "Hypertension- Missing", "Myocardial infarction- Yes", "Myocardial infarction- No", "Myocardial infarction- Missing", "Peripheral vascular disease- Yes", "Peripheral vascular disease- No", "Peripheral vascular disease- Missing"), each=25), Country=rep(c("Belgium", "Brazil", "Canada", "Colombia", "France", "India", "Indonesia", "Ireland", "Israel", "Italy", "Lao PDR", "Malaysia", "Nepal", "Netherlands", "Norway", "Other", "Pakistan", "Peru", "Portugal", "Romania", "Russian Federation", "South Africa", "Spain","United Kingdom", "United States"),18), Frequency_of_comorbidity=c(0,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,                                 0,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 1367,2950,5047,1041,5694,6811,1325,2198,2918,3791,1140,6646,3226,2599,7463,5557,7422,1097,1012,1102,4110,432596,15341,273149,4814,                                         126,109,264,27,494,204,104,162,149,125,11,100,59,199,78,246,310,6,43,35,261,3077,379,17012,206, 8,116,7,9,33,94,11,12,136,30,46,225,75,15,249,158,152,18,8,25,48,12888,279,1331,24, 1233,2765,4776,1005,5167,6513,1210,2024,2633,3636,1083,6321,3092,2385,7136,5153,6960,1073,961,1042,3801,416631,14683,254806,4584,                                                                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,                       0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 1367,2990,5047,1041,5694,6811,1325,2198,2918,3791,1140,6646,3226,2599,7463,5557,7422,1097,1012,1102,4110,432596,15341,273149,4811,                                       154,667,708,97,775,839,193,208,49,1499,64,631,1026,280,217,483,2509,113,193,102,778,75951,2254,24451,762, 8,24,10,7,25,109,17,7,102,27,45,198,69,14,221,56,170,15,4,19,33,14300,331,593,31, 1205,2299,4329,937,4894,5863,1115,1983,2767,2265,1031,5817,2131,2305,7025,5018,4743,969,815,981,3299,342345,12756,248105,4021,                                                                     0,0,0,0,23,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,                      0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 1367,2990,5047,1041,5671,6811,1325,2198,2918,3791,1140,6646,3226,2598,7463,5557,7422,1097,1012,1102,4110,432596,15341,273149,4814,                                                                       0,0,0,0,7,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,                       0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0, 1367,2990,5047,1041,5687,6811,1325,2198,2918,3791,1140,6646,3226,2596,7463,5557,7422,1097,1012,1102,4110,432596,15341,273149,4814))
dataforcomorbiditiesbycountry1
ggplot(data=dataforcomorbiditiesbycountry1, aes(x=Country, y=Frequency_of_comorbidity, fill=Comorbidity)) + geom_bar(stat="identity", position=position_dodge()) + xlab("Country") + ylab("Frequency of comorbidity (pseudo log scale)") + facet_wrap(vars(Comorbidity)) + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10), limits=c(0,500000)) + theme(axis.title.x=element_text(size=15), axis.title.y=element_text(size=15), axis.text.y=element_text(size=5)) + theme(axis.text.x = element_text(angle = 90, hjust=1, vjust=0.5, size = 8)) + geom_text(aes(label=Frequency_of_comorbidity), vjust=0.4, hjust=1, angle = 90, color="black", size=3)
```

# Number of each cardiovascular complication by country
```{r}
#Ungrouped countries
table1(~ comps_atrial_fibrillation + comps_cardiac_arrest + comps_cardiac_arrhythmia + comps_cardiac_ischaemia + comps_cardiomyopathy + comps_coagulation_disorder + comps_congestive_heart_failure + comps_endocarditis + comps_endocarditis_myocarditis_pericarditis + comps_myocardial_infarction + comps_myocarditis + comps_myocarditis_pericarditis + comps_pericarditis + comps_pleural_effusion + comps_pulmonary_embolism + comps_pulmonary_embolism_or_dvt + comps_stroke + comps_thromboembolic_phenomena + comps_thromboembolsim | country, data = data)
#Grouped with countries with less than 1000 individuals grouped together
table1(~ comps_atrial_fibrillation + comps_cardiac_arrest + comps_cardiac_arrhythmia + comps_cardiac_ischaemia + comps_cardiomyopathy + comps_coagulation_disorder + comps_congestive_heart_failure + comps_endocarditis + comps_endocarditis_myocarditis_pericarditis + comps_myocardial_infarction + comps_myocarditis + comps_myocarditis_pericarditis + comps_pericarditis + comps_pleural_effusion + comps_pulmonary_embolism + comps_pulmonary_embolism_or_dvt + comps_stroke + comps_thromboembolic_phenomena + comps_thromboembolsim | country_grouped, data = data2)
table1(~ country_grouped | comps_atrial_fibrillation, data=data2)
table1(~ country_grouped | comps_cardiac_arrest, data=data2)
table1(~ country_grouped | comps_cardiac_arrhythmia, data=data2)
table1(~ country_grouped | comps_cardiac_ischaemia, data=data2)
table1(~ country_grouped | comps_cardiomyopathy, data=data2)
table1(~ country_grouped | comps_coagulation_disorder, data=data2)
table1(~ country_grouped | comps_congestive_heart_failure, data=data2)
table1(~ country_grouped | comps_endocarditis, data=data2)
table1(~ country_grouped | comps_endocarditis_myocarditis_pericarditis, data=data2)
table1(~ country_grouped | comps_myocardial_infarction, data=data2)
table1(~ country_grouped | comps_myocarditis, data=data2)
table1(~ country_grouped | comps_myocarditis_pericarditis, data=data2)
table1(~ country_grouped | comps_pericarditis, data=data2)
table1(~ country_grouped | comps_pleural_effusion, data=data2)
table1(~ country_grouped | comps_pulmonary_embolism, data=data2)
table1(~ country_grouped | comps_pulmonary_embolism_or_dvt, data=data2)
table1(~ country_grouped | comps_stroke, data=data2)
table1(~ country_grouped | comps_thromboembolic_phenomena, data=data2)
table1(~ country_grouped | comps_thromboembolsim, data=data2)

#Full form of data and graph
dataforcomplicationsbycountry1 <- data.frame(Complication=rep(c("Atrial fibrillation- Yes", "Atrial fibrillation- No", "Atrial fibrillation- Missing", "Cardiac arrest- Yes", "Cardiac arrest- No", "Cardiac arrest- Missing", "Cardiac arrhythmia- Yes", "Cardiac arrhythmia- No", "Cardiac arrhythmia- Missing", "Cardiac ischaemia- Yes", "Cardiac ischaemia- No", "Cardiac ischaemia- Missing", "Cardiomyopathy- Yes", "Cardiomyopathy- No", "Cardiomyopathy- Missing", "Coagulation disorder- Yes", "Coagulation disorder- No", "Coagulation disorder- Missing", "Congestive heart failure- Yes", "Congestive heart failure- No", "Congestive heart failure- Missing", "Endocarditis- Yes", "Endocarditis- No", "Endocarditis- Missing", "Endocarditis, Myocarditis, Pericarditis- Yes", "Endocarditis, Myocarditis, Pericarditis- No", "Endocarditis, Myocarditis, Pericarditis- Missing", "Myocardial infarction- Yes", "Myocardial infarction- No", "Myocardial infarction- Missing", "Myocarditis- Yes", "Myocarditis- No", "Myocarditis- Missing", "Myocarditis, Pericarditis- Yes", "Myocarditis, Pericarditis- No", "Myocarditis, Pericarditis- Missing", "Pericarditis- Yes", "Pericarditis- No", "Pericarditis- Missing", "Pleural effusion- Yes", "Pleural effusion- No", "Pleural effusion- Missing", "Pulmonary embolism- Yes", "Pulmonary embolism- No", "Pulmonary embolism- Missing", "Pulmonary embolism or DVT- Yes", "Pulmonary embolism or DVT- No", "Pulmonary embolism or DVT- Missing", "Stroke- Yes", "Stroke- No", "Stroke- Missing", "Thromboembolic phenomena- Yes", "Thromboembolic phenomena- No", "Thromboembolic phenomena- Missing", "Thromboembolism- Yes","Thromboembolism- No", "Thromboembolism- Missing"), each=25, Country=rep(c("Belgium", "Brazil", "Canada", "Colombia", "France", "India", "Indonesia", "Ireland", "Israel", "Italy", "Lao PDR", "Malaysia", "Nepal", "Netherlands", "Norway", "Other,", "Pakistan", "Peru", "Portugal", "Romania", "Russian Federation", "South Africa", "Spain","United Kingdom", "United States"),57), Frequency_of_complication=c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 1367,2990,5047,1041,5694,6811,1325,2198,2918,3791,1140,6646,3226,2599,7463,5557,7422,1097,1012,1102,4110,432596,15341,273149,4810,                                77,254,179,88,173,356,340,43,7,97,4,40,47,34,4,330,368,44,63,5,0,14,301,4575,259, 976,2640,4439,561,4337,3485,824,1406,381,813,345,6512,3179,2225,534,3208,7053,942,780,961,0,38,12865,186721,2893, 314,96,429,392,1184,2970,161,749,2530,2881,791,94,0,340,6925,2019,1,111,169,136,4110,432544,2175,81853,1662, 100,93,596,59,284,75,102,176,5,131,3,47,5,285,31,412,64,9,151,11,0,6,120,13892,451, 948,568,3983,587,3206,3766,1059,1273,383,770,347,6505,3221,1931,506,3121,7357,978,689,957,0,45,8039,183247,2695, 319,2329,468,395,2204,2970,164,749,2530,2890,790,94,0,383,6926,2024,1,110,172,134,4110,432545,7182,76010,1668, 17,10,64,52,33,56,89,17,3,19,2,1,0,49,3,77,10,2,50,6,0,1,105,2587,66,     1032,105,1196,598,3443,2959,1069,1421,384,890,347,166,3226,2039,535,2068,7411,985,711,962,0,51,12930,194490,1515, 318,2875,3787,391,2218,3796,167,760,2531,2882,791,6479,0,511,6925,3412,1,110,251,134,4110,432544,2306,76072,3233, 9,13,99,18,0,8,20,9,0,15,4,0,1,8,1,67,4,2,30,7,0,0,106,716,100,   624,589,4420,627,1,3832,1134,1128,363,771,346,167,3225,1397,403,1807,7417,985,793,778,0,21,12855,162309,2648, 734,2388,528,396,5693,2971,171,1061,2555,3005,790,6479,0,1194,7059,3683,1,110,189,317,4110,432575,2380,110124,2066, 60,38,24,83,129,41,225,32,2,93,2,15,2,49,6,276,39,8,35,33,0,6,1075,7182,185, 988,2317,1240,566,3349,2974,914,1415,386,812,348,6537,3224,1826,532,1861,7382,979,730,934,0,46,11947,190258,1459, 319,635,3783,392,2216,3796,186,751,2530,2886,790,94,0,724,6925,3420,1,110,247,135,4110,432544,2319,75709,3170, 34,60,48,62,61,43,153,42,12,41,4,23,3,68,7,72,20,17,75,5,0,0,120,6605,96,     1009,2289,1217,587,3415,2973,1006,1405,375,867,345,6529,3223,1943,530,2083,7401,970,688,963,0,51,13050,191231,1550, 324,641,3782,392,2218,3795,166,751,2531,2883,791,94,0,588,6926,3402,1,110,249,134,4110,432545,2171,75313,3168, 10,4,17,9,21,2,3,5,2,1,2,0,0,6,1,14,80,10,5,0,0,0,24,1,22,     1023,2879,4521,638,3361,3839,1151,1396,386,819,348,167,3226,2095,537,2084,7341,976,832,968,0,21,13091,1,3032, 334,107,509,394,2312,2970,171,797,2530,2971,790,6479,0,498,6925,3459,1,111,175,134,4110,432575,2226,273147,1760, 0,0,0,0,0,0,1,2,0,1,0,13,0,1,0,2,0,0,0,0,0,0,2,572,2, 14,0,0,1,0,0,3,41,0,106,0,6372,0,53,0,908,0,0,2,0,0,30,53,197443,106, 1353,2990,5047,1040,5694,6811,1321,2155,2918,3684,1140,261,3226,2545,7463,4647,7422,1097,1010,1102,4110,432566,15286,75134,4706,                                                      3,64,24,33,0,31,50,8,2,2,2,0,3,17,2,32,14,1,19,0,0,1,52,0,29,  629,2020,1210,540,1,2984,1106,1123,361,786,347,167,3223,1539,402,1726,7407,937,726,785,0,21,12913,1,1149, 735,906,3813,468,5693,3796,169,1067,2555,3003,791,6479,0,1043,7059,3799,1,159,267,317,4110,432574,2376,273148,3636, 0,24,0,0,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,            0,2222,0,0,982,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,131,0,65, 1367,744,5047,1041,4690,6811,1325,2198,2918,3791,1140,6646,3226,2599,7463,5556,7422,1097,1012,1102,4110,432596,15210,273149,4749,
7,4,47,20,14,15,40,16,6,7,3,0,0,19,1,32,0,10,13,7,0,0,106,621,35, 627,599,4445,625,1124,2039,1112,1129,358,780,347,22,0,1532,403,1836,0,977,806,778,0,21,13397,162741,2654, 733,2387,555,396,4556,4757,173,1053,2554,3004,790,6624,3226,1048,7059,3689,7422,110,193,317,4110,432575,1838,109787,2125,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,                0,2237,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,132,0,65, 1367,746,5047,1041,5694,6811,1325,2198,2918,3791,1140,6646,3226,2599,7463,5556,7422,1097,1012,1102,4110,432596,15209,273149,4749,                               114,91,205,98,105,47,64,185,17,130,16,30,0,166,13,200,27,10,66,5,0,1,569,10703,284, 935,2265,1062,553,3373,2967,1098,1267,376,773,333,6522,3226,2072,524,1941,7394,976,698,961,0,52,12597,187975,1370, 318,634,3780,390,2216,3797,163,746,2525,2888,791,94,0,361,6926,3416,1,111,248,136,4110,432543,2175,74471,3160, 22,6,112,29,105,18,10,47,3,40,3,1,6,163,14,95,22,2,41,2,0,0,577,4076,56, 610,76,1118,542,1067,2996,1144,1087,360,742,347,166,3220,1248,390,2172,7399,936,691,782,0,21,12807,113984,1117, 735,2908,3817,470,4522,3797,171,1064,2555,3009,790,6479,0,1188,7059,3290,1,159,280,318,4110,432575,1957,155089,3641, 0,0,0,0,143,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,262,0,0,0,            0,0,0,0,861,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,187432,0,0,0, 1367,2990,5047,1041,4690,6811,1325,2198,2918,3791,1140,6646,3226,2599,7463,5557,7422,1097,1012,1102,4110,244902,15341,273149,4814,                                           23,53,33,18,21,37,18,18,0,12,0,6,2,22,3,55,34,10,10,1,0,1,130,3305,58,         1027,2307,1235,632,3461,2979,1146,1431,387,899,350,6546,3224,2358,535,2663,7387,977,755,967,0,51,13037,195380,1592, 317,630,3779,391,2212,3795,161,749,2531,2880,790,94,0,219,6925,2839,1,110,247,134,4110,432544,2174,74464,3164, 0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,                   0,2174,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 1367,752,5047,1041,5694,6811,1325,2198,2918,3791,1140,6646,3226,2599,7463,5557,7422,1097,1012,1102,4110,432596,15341,273149,4814,                                                             1,2,21,4,0,3,2,1,0,1,1,0,0,1,2,19,0,0,2,0,0,0,0,0,13, 74,76,814,162,0,595,234,30,51,330,349,22,0,229,204,849,0,689,192,11,0,2,169,0,245, 1292,2912,4212,875,5694,6213,1089,2167,2867,3460,790,6624,3226,2369,7257,4689,7422,408,818,1091,4110,432594,15172,273149,4556))) 
dataforcomplicationsbycountry1
#With the legend
ggplot(data=dataforcomplicationsbycountry1, aes(x=Country, y=Frequency_of_complication, fill=Complication)) + geom_bar(stat="identity", position=position_dodge()) + xlab("Complication") + ylab("Frequency of complication (pseudo log scale)") + facet_wrap(vars(Complication)) + ggtitle("Frequencies of the cardiovascular complications by country") + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10), limits=c(0,500000)) + theme(plot.title=element_text(size=20), axis.title.x=element_text(size=15), axis.title.y=element_text(size=15), axis.text.y=element_text(size=5)) + theme(axis.text.x = element_text(angle = 90, hjust=1, vjust=0.5, size = 6)) +
geom_text(aes(label=Frequency_of_complication), vjust=0.4, hjust=1, angle = 90, color="black", size=2)
#Without the legend- could use this one and then add the legend as a separate image to allow the graph itself to be larger
ggplot(data=dataforcomplicationsbycountry1, aes(x=Country, y=Frequency_of_complication, fill=Complication)) + geom_bar(stat="identity", position=position_dodge()) + xlab("Complication") + ylab("Frequency of complication (pseudo log scale)") + facet_wrap(vars(Complication)) + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10), limits=c(0,500000)) + theme(axis.title.x=element_text(size=10), axis.title.y=element_text(size=10), axis.text.y=element_text(size=5)) + theme(axis.text.x = element_text(angle = 90, hjust=1, vjust=0.5, size = 6)) + theme(legend.position = "none") + geom_text(aes(label=Frequency_of_complication), vjust=0.4, hjust=1, angle = 90, color="black", size=2)

#First half of data and graph
dataforcomplicationsbycountry2 <- data.frame(Complication=rep(c("Atrial fibrillation- Yes", "Atrial fibrillation- No", "Atrial fibrillation- Missing", "Cardiac arrest- Yes", "Cardiac arrest- No", "Cardiac arrest- Missing", "Cardiac arrhythmia- Yes", "Cardiac arrhythmia- No", "Cardiac arrhythmia- Missing", "Cardiac ischaemia- Yes", "Cardiac ischaemia- No", "Cardiac ischaemia- Missing", "Cardiomyopathy- Yes", "Cardiomyopathy- No", "Cardiomyopathy- Missing", "Coagulation disorder- Yes", "Coagulation disorder- No", "Coagulation disorder- Missing", "Congestive heart failure- Yes", "Congestive heart failure- No", "Congestive heart failure- Missing", "Endocarditis- Yes", "Endocarditis- No", "Endocarditis- Missing", "Endocarditis, Myocarditis, Pericarditis- Yes", "Endocarditis, Myocarditis, Pericarditis- No", "Endocarditis, Myocarditis, Pericarditis- Missing"), each=25), Country=rep(c("Belgium", "Brazil", "Canada", "Colombia", "France", "India", "Indonesia", "Ireland", "Israel", "Italy", "Lao PDR", "Malaysia", "Nepal", "Netherlands", "Norway", "Other,", "Pakistan", "Peru", "Portugal", "Romania", "Russian Federation", "South Africa", "Spain","United Kingdom", "United States"),27), Frequency_of_complication=c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 1367,2990,5047,1041,5694,6811,1325,2198,2918,3791,1140,6646,3226,2599,7463,5557,7422,1097,1012,1102,4110,432596,15341,273149,4810,                                77,254,179,88,173,356,340,43,7,97,4,40,47,34,4,330,368,44,63,5,0,14,301,4575,259, 976,2640,4439,561,4337,3485,824,1406,381,813,345,6512,3179,2225,534,3208,7053,942,780,961,0,38,12865,186721,2893, 314,96,429,392,1184,2970,161,749,2530,2881,791,94,0,340,6925,2019,1,111,169,136,4110,432544,2175,81853,1662, 100,93,596,59,284,75,102,176,5,131,3,47,5,285,31,412,64,9,151,11,0,6,120,13892,451, 948,568,3983,587,3206,3766,1059,1273,383,770,347,6505,3221,1931,506,3121,7357,978,689,957,0,45,8039,183247,2695, 319,2329,468,395,2204,2970,164,749,2530,2890,790,94,0,383,6926,2024,1,110,172,134,4110,432545,7182,76010,1668, 17,10,64,52,33,56,89,17,3,19,2,1,0,49,3,77,10,2,50,6,0,1,105,2587,66,     1032,105,1196,598,3443,2959,1069,1421,384,890,347,166,3226,2039,535,2068,7411,985,711,962,0,51,12930,194490,1515, 318,2875,3787,391,2218,3796,167,760,2531,2882,791,6479,0,511,6925,3412,1,110,251,134,4110,432544,2306,76072,3233, 9,13,99,18,0,8,20,9,0,15,4,0,1,8,1,67,4,2,30,7,0,0,106,716,100,   624,589,4420,627,1,3832,1134,1128,363,771,346,167,3225,1397,403,1807,7417,985,793,778,0,21,12855,162309,2648, 734,2388,528,396,5693,2971,171,1061,2555,3005,790,6479,0,1194,7059,3683,1,110,189,317,4110,432575,2380,110124,2066, 60,38,24,83,129,41,225,32,2,93,2,15,2,49,6,276,39,8,35,33,0,6,1075,7182,185, 988,2317,1240,566,3349,2974,914,1415,386,812,348,6537,3224,1826,532,1861,7382,979,730,934,0,46,11947,190258,1459, 319,635,3783,392,2216,3796,186,751,2530,2886,790,94,0,724,6925,3420,1,110,247,135,4110,432544,2319,75709,3170, 34,60,48,62,61,43,153,42,12,41,4,23,3,68,7,72,20,17,75,5,0,0,120,6605,96,     1009,2289,1217,587,3415,2973,1006,1405,375,867,345,6529,3223,1943,530,2083,7401,970,688,963,0,51,13050,191231,1550, 324,641,3782,392,2218,3795,166,751,2531,2883,791,94,0,588,6926,3402,1,110,249,134,4110,432545,2171,75313,3168, 10,4,17,9,21,2,3,5,2,1,2,0,0,6,1,14,80,10,5,0,0,0,24,1,22,     1023,2879,4521,638,3361,3839,1151,1396,386,819,348,167,3226,2095,537,2084,7341,976,832,968,0,21,13091,1,3032, 334,107,509,394,2312,2970,171,797,2530,2971,790,6479,0,498,6925,3459,1,111,175,134,4110,432575,2226,273147,1760, 0,0,0,0,0,0,1,2,0,1,0,13,0,1,0,2,0,0,0,0,0,0,2,572,2, 14,0,0,1,0,0,3,41,0,106,0,6372,0,53,0,908,0,0,2,0,0,30,53,197443,106, 1353,2990,5047,1040,5694,6811,1321,2155,2918,3684,1140,261,3226,2545,7463,4647,7422,1097,1010,1102,4110,432566,15286,75134,4706))   
#With legend
ggplot(data=dataforcomplicationsbycountry2, aes(x=Country, y=Frequency_of_complication, fill=Complication)) + geom_bar(stat="identity", position=position_dodge()) + xlab("Country") + ylab("Frequency of complication (pseudo log scale)") + facet_wrap(vars(Complication)) + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10), limits=c(0,500000)) + theme(axis.title.x=element_text(size=10), axis.title.y=element_text(size=10), axis.text.y=element_text(size=5)) + theme(axis.text.x = element_text(angle = 90, hjust=1, vjust=0.5, size = 8)) + geom_text(aes(label=Frequency_of_complication), vjust=0.4, hjust=1, angle = 90, color="black", size=3)
#Without legend
ggplot(data=dataforcomplicationsbycountry2, aes(x=Country, y=Frequency_of_complication, fill=Complication)) + geom_bar(stat="identity", position=position_dodge()) + xlab("Country") + ylab("Frequency of complication (pseudo log scale)") + facet_wrap(vars(Complication)) + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10), limits=c(0,500000)) + theme(axis.title.x=element_text(size=15), axis.title.y=element_text(size=15), axis.text.y=element_text(size=5)) + theme(axis.text.x = element_text(angle = 90, hjust=1, vjust=0.5, size = 8)) + geom_text(aes(label=Frequency_of_complication), vjust=0.4, hjust=1, angle = 90, color="black", size=3) + theme(legend.position = "none")

#Second half of data and graph
dataforcomplicationsbycountry3 <- data.frame(Complication=rep(c("Myocardial infarction- Yes", "Myocardial infarction- No", "Myocardial infarction- Missing", "Myocarditis- Yes", "Myocarditis- No", "Myocarditis- Missing", "Myocarditis, Pericarditis- Yes", "Myocarditis, Pericarditis- No", "Myocarditis, Pericarditis- Missing", "Pericarditis- Yes", "Pericarditis- No", "Pericarditis- Missing", "Pleural effusion- Yes", "Pleural effusion- No", "Pleural effusion- Missing", "Pulmonary embolism- Yes", "Pulmonary embolism- No", "Pulmonary embolism- Missing", "Pulmonary embolism or DVT- Yes", "Pulmonary embolism or DVT- No", "Pulmonary embolism or DVT- Missing", "Stroke- Yes", "Stroke- No", "Stroke- Missing", "Thromboembolic phenomena- Yes", "Thromboembolic phenomena- No", "Thromboembolic phenomena- Missing", "Thromboembolism- Yes","Thromboembolism- No", "Thromboembolism- Missing"), each=25), Country=rep(c("Belgium", "Brazil", "Canada", "Colombia", "France", "India", "Indonesia", "Ireland", "Israel", "Italy", "Lao PDR", "Malaysia", "Nepal", "Netherlands", "Norway", "Other,", "Pakistan", "Peru", "Portugal", "Romania", "Russian Federation", "South Africa", "Spain","United Kingdom", "United States"),30), Frequency_of_complication=c(3,64,24,33,0,31,50,8,2,2,2,0,3,17,2,32,14,1,19,0,0,1,52,0,29,                629,2020,1210,540,1,2984,1106,1123,361,786,347,167,3223,1539,402,1726,7407,937,726,785,0,21,12913,1,1149,   735,906,3813,468,5693,3796,169,1067,2555,3003,791,6479,0,1043,7059,3799,1,159,267,317,4110,432574,2376,273148,3636,  0,24,0,0,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,                    0,2222,0,0,982,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,131,0,65, 1367,744,5047,1041,4690,6811,1325,2198,2918,3791,1140,6646,3226,2599,7463,5556,7422,1097,1012,1102,4110,432596,15210,273149,4749,                                                  7,4,47,20,14,15,40,16,6,7,3,0,0,19,1,32,0,10,13,7,0,0,106,621,35, 627,599,4445,625,1124,2039,1112,1129,358,780,347,22,0,1532,403,1836,0,977,806,778,0,21,13397,162741,2654, 733,2387,555,396,4556,4757,173,1053,2554,3004,790,6624,3226,1048,7059,3689,7422,110,193,317,4110,432575,1838,109787,2125,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,                0,2237,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,132,0,65, 1367,746,5047,1041,5694,6811,1325,2198,2918,3791,1140,6646,3226,2599,7463,5556,7422,1097,1012,1102,4110,432596,15209,273149,4749,                               114,91,205,98,105,47,64,185,17,130,16,30,0,166,13,200,27,10,66,5,0,1,569,10703,284, 935,2265,1062,553,3373,2967,1098,1267,376,773,333,6522,3226,2072,524,1941,7394,976,698,961,0,52,12597,187975,1370, 318,634,3780,390,2216,3797,163,746,2525,2888,791,94,0,361,6926,3416,1,111,248,136,4110,432543,2175,74471,3160,   22,6,112,29,105,18,10,47,3,40,3,1,6,163,14,95,22,2,41,2,0,0,577,4076,56, 610,76,1118,542,1067,2996,1144,1087,360,742,347,166,3220,1248,390,2172,7399,936,691,782,0,21,12807,113984,1117, 735,2908,3817,470,4522,3797,171,1064,2555,3009,790,6479,0,1188,7059,3290,1,159,280,318,4110,432575,1957,155089,3641, 0,0,0,0,143,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,262,0,0,0,           0,0,0,0,861,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,187432,0,0,0, 1367,2990,5047,1041,4690,6811,1325,2198,2918,3791,1140,6646,3226,2599,7463,5557,7422,1097,1012,1102,4110,244902,15341,273149,4814,                                            23,53,33,18,21,37,18,18,0,12,0,6,2,22,3,55,34,10,10,1,0,1,130,3305,58,         1027,2307,1235,632,3461,2979,1146,1431,387,899,350,6546,3224,2358,535,2663,7387,977,755,967,0,51,13037,195380,1592, 317,630,3779,391,2212,3795,161,749,2531,2880,790,94,0,219,6925,2839,1,110,247,134,4110,432544,2174,74464,3164, 0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,                  0,2174,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,  1367,752,5047,1041,5694,6811,1325,2198,2918,3791,1140,6646,3226,2599,7463,5557,7422,1097,1012,1102,4110,432596,15341,273149,4814,                                                             1,2,21,4,0,3,2,1,0,1,1,0,0,1,2,19,0,0,2,0,0,0,0,0,13, 74,76,814,162,0,595,234,30,51,330,349,22,0,229,204,849,0,689,192,11,0,2,169,0,245, 1292,2912,4212,875,5694,6213,1089,2167,2867,3460,790,6624,3226,2369,7257,4689,7422,408,818,1091,4110,432594,15172,273149,4556))   
#With legend
ggplot(data=dataforcomplicationsbycountry3, aes(x=Country, y=Frequency_of_complication, fill=Complication)) + geom_bar(stat="identity", position=position_dodge()) + xlab("Country") + ylab("Frequency of complication (pseudo log scale)") + facet_wrap(vars(Complication)) + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10), limits=c(0,500000)) + theme(axis.title.x=element_text(size=10), axis.title.y=element_text(size=10), axis.text.y=element_text(size=5)) + theme(axis.text.x = element_text(angle = 90, hjust=1, vjust=0.5, size = 8))
#Without legend
ggplot(data=dataforcomplicationsbycountry3, aes(x=Country, y=Frequency_of_complication, fill=Complication)) + geom_bar(stat="identity", position=position_dodge()) + xlab("Country") + ylab("Frequency of complication (pseudo log scale)") + facet_wrap(vars(Complication)) + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10), limits=c(0,500000)) + theme(axis.title.x=element_text(size=15), axis.title.y=element_text(size=15), axis.text.y=element_text(size=5)) + theme(axis.text.x = element_text(angle = 90, hjust=1, vjust=0.5, size = 8)) + geom_text(aes(label=Frequency_of_complication), vjust=0.4, hjust=1, angle = 90, color="black", size=3) + theme(legend.position = "none")
```

#Characteristic variables for cardiovascular comorbidities- Age, sex, VS and COVID-19
```{r}
label(data$agegp5) <- "Age in groups of 5 years (years)"
label(data$sex) <- "Sex"
label(data$vs_bmi) <- "BMI (kg/m^2)"
label(data$vs_sysbp) <- "Systolic blood pressure (mmHg)"
label(data$vs_diabp) <- "Diastolic blood pressure (mmHg)"
label(data$vs_hr) <- "Heart rate (beats per minute)"
label(data$vs_resp) <- "Respiration (breaths per minute)"
label(data$vs_temp) <- "Temperature (degrees Celsius)"
label(data$vs_oxysat) <- "Oxygen saturation (%)"
label(data$vs_oxysat_room_air) <- "Oxygen saturation, room air (%)"
label(data$vs_oxysat_oxygen_therapy) <- "Oxygen saturation, oxygen therapy (%)"
label(data$vs_oxysat_unknown) <- "Oxygen saturation, unknown (%)"
label(data$cov_det_id) <- "COVID-19 Test Result"
label(data$clin_diag_covid_19) <- "COVID-19 Clinical diagnosis"

AGE<-data$age
summary(AGE)
hist(AGE)
AGEgrp<-cut(AGE,c(0,10,20,30,40,50,60,70,80,90,100,120), labels=c("0-9","10-19","20-29","30-39","40-49","50-59","60-69","70-79","80-89","90-99","100+"))

table1(~ AGEgrp + sex + vs_bmi + vs_sysbp + vs_diabp + vs_hr + vs_resp + vs_temp + vs_oxysat + vs_oxysat_room_air + vs_oxysat_oxygen_therapy + vs_oxysat_unknown + cov_det_id + clin_diag_covid_19 | comorbid_cardiac_arrhythmia, data = data, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ AGEgrp + sex + vs_bmi + vs_sysbp + vs_diabp + vs_hr + vs_resp + vs_temp + vs_oxysat + vs_oxysat_room_air + vs_oxysat_oxygen_therapy + vs_oxysat_unknown + cov_det_id + clin_diag_covid_19 | comorbid_chronic_cardiac_disease, data = data, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ AGEgrp + sex + vs_bmi + vs_sysbp + vs_diabp + vs_hr + vs_resp + vs_temp + vs_oxysat + vs_oxysat_room_air + vs_oxysat_oxygen_therapy + vs_oxysat_unknown + cov_det_id + clin_diag_covid_19 | comorbid_congestive_heart_failure, data = data, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ AGEgrp + sex + vs_bmi + vs_sysbp + vs_diabp + vs_hr + vs_resp + vs_temp + vs_oxysat + vs_oxysat_room_air + vs_oxysat_oxygen_therapy + vs_oxysat_unknown + cov_det_id + clin_diag_covid_19 | comorbid_hypertension, data = data, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ AGEgrp + sex + vs_bmi + vs_sysbp + vs_diabp + vs_hr + vs_resp + vs_temp + vs_oxysat + vs_oxysat_room_air + vs_oxysat_oxygen_therapy + vs_oxysat_unknown + cov_det_id + clin_diag_covid_19 | comorbid_myocardial_infarction, data = data, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ AGEgrp + sex + vs_bmi + vs_sysbp + vs_diabp + vs_hr + vs_resp + vs_temp + vs_oxysat + vs_oxysat_room_air + vs_oxysat_oxygen_therapy + vs_oxysat_unknown + cov_det_id + clin_diag_covid_19 | comorbid_peripheral_vascular_disease, data = data, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
```

# Frequencies of other comorbidities for cardiovascular comorbidities- appear to all be 0?
```{r}
label(data$comorbid_smoking) <- "Comorbidity- Smoking"
label(data$comorbid_asplenia) <- "Comorbidity- Asplenia"
label(data$comorbid_asthma) <- "Comorbidity- Asthma"
label(data$comorbid_autoimmune_disease) <- "Comorbidity- Autoimmune disease"
label(data$comorbid_chronic_haematological_disease) <- "Comorbidity- Chronic haematological disease"
label(data$comorbid_chronic_inflammatory_condition) <- "Comorbidity- Chronic inflammatory condition"
label(data$comorbid_chronic_kidney_disease) <- "Comorbidity- Chronic kidney disease"
label(data$comorbid_chronic_metabolic_endocrine_disease) <- "Comorbidity- Chronic metabolic endocrine disease"
label(data$comorbid_chronic_neurological_disorder) <- "Comorbidity- Chronic neurological disorder"
label(data$comorbid_chronic_pulmonary_disease) <- "Comorbidity- Chronic pulmonary disease"
label(data$comorbid_other_chronic_disease) <- "Comorbidity- Other chronic disease"
label(data$comorbid_dementia) <- "Comorbidity- Dementia"
label(data$comorbid_diabetes_mellitus_type_1) <- "Comorbidity- Diabetes mellitus type 1"
label(data$comorbid_diabetes_mellitus_type_2) <- "Comorbidity- Diabetes mellitus type 2"
label(data$comorbid_diabetes_mellitus_gestational) <- "Comorbidity- Diabetes mellitus gestational"
label(data$comorbid_diabetes_mellitus_type_not_specified) <- "Comorbidity- Diabetes mellitus type not specified"
label(data$comorbid_gastrointestinal_bleeding) <- "Comorbidity- Gastrointestinal bleeding"
label(data$comorbid_hiv) <- "Comorbidity- HIV"
label(data$comorbid_immunosuppression) <- "Comorbidity- Immunosuppression"
label(data$comorbid_lipid_disorder) <- "Comorbidity- Lipid disorder"
label(data$comorbid_liver_disease) <- "Comorbidity- Liver disease"
label(data$comorbid_mild_liver_disease) <- "Comorbidity- Mild liver disease"
label(data$comorbid_moderate_or_severe_liver_disease) <- "Comorbidity- Moderate or severe liver disease"
label(data$comorbid_severe_liver_disease) <- "Comorbidity- Severe liver disease"
label(data$comorbid_malignant_neoplasm) <- "Comorbidity- Malignant neoplasm"
label(data$comorbid_malnutrition) <- "Comorbidity- Malnutrition"
label(data$comorbid_mental_disorder) <- "Comorbidity- Mental disorder"
label(data$comorbid_obesity) <- "Comorbidity- Obesity"
label(data$comorbid_other) <- "Comorbidity- Other"
label(data$comorbid_other_relevant_risk_factor) <- "Comorbidity- Other relevant risk factor"
label(data$comorbid_peptic_ulcer_disease) <- "Comorbidity- Peptic ulcer disease"
label(data$`comorbid_previous_covid-19_infection`) <- "Comorbidity- Previous COVID-19 infection"
label(data$comorbid_rare_diseases_and_inborn_errors_of_metabolism) <- "Comorbidity- Rare disease and inborn errors of metabolism"
label(data$comorbid_rheumatological_disorder) <- "Comorbidity- Rheumatological disorder"
label(data$comorbid_solid_organ_transplant) <- "Comorbidity- Solid organ transplant"
label(data$comorbid_transplantation) <- "Comorbidity- Transplantation"
label(data$comorbid_tuberculosis) <- "Comorbidity- Tuberculosis"
label(data$comorbid_) <- "Comorbidity- _"
#Cardiac arrhythmia- all the results are 0
table1(~ comorbid_chronic_cardiac_disease + comorbid_congestive_heart_failure + comorbid_hypertension + comorbid_myocardial_infarction + comorbid_peripheral_vascular_disease + comorbid_smoking + comorbid_asplenia + comorbid_asthma + comorbid_autoimmune_disease + comorbid_chronic_haematological_disease + comorbid_chronic_inflammatory_condition + comorbid_chronic_kidney_disease + comorbid_chronic_metabolic_endocrine_disease + comorbid_chronic_neurological_disorder + comorbid_chronic_pulmonary_disease + comorbid_other_chronic_disease + comorbid_dementia + comorbid_diabetes_mellitus_type_1 + comorbid_diabetes_mellitus_type_2 + comorbid_diabetes_mellitus_gestational + comorbid_diabetes_mellitus_type_not_specified + comorbid_gastrointestinal_bleeding + comorbid_hiv + comorbid_immunosuppression + comorbid_lipid_disorder + comorbid_liver_disease + comorbid_mild_liver_disease + comorbid_moderate_or_severe_liver_disease + comorbid_severe_liver_disease + comorbid_malignant_neoplasm + comorbid_malnutrition + comorbid_mental_disorder + comorbid_obesity + comorbid_other + comorbid_other_relevant_risk_factor + comorbid_peptic_ulcer_disease + `comorbid_previous_covid-19_infection` + comorbid_rare_diseases_and_inborn_errors_of_metabolism + comorbid_rheumatological_disorder + comorbid_solid_organ_transplant + comorbid_transplantation + comorbid_tuberculosis + comorbid_ | comorbid_cardiac_arrhythmia, data = data)
#Chronic cardiac disease- all the results are 0
table1(~ comorbid_cardiac_arrhythmia + comorbid_congestive_heart_failure + comorbid_hypertension + comorbid_myocardial_infarction + comorbid_peripheral_vascular_disease + comorbid_smoking + comorbid_asplenia + comorbid_asthma + comorbid_autoimmune_disease + comorbid_chronic_haematological_disease + comorbid_chronic_inflammatory_condition + comorbid_chronic_kidney_disease + comorbid_chronic_metabolic_endocrine_disease + comorbid_chronic_neurological_disorder + comorbid_chronic_pulmonary_disease + comorbid_other_chronic_disease + comorbid_dementia + comorbid_diabetes_mellitus_type_1 + comorbid_diabetes_mellitus_type_2 + comorbid_diabetes_mellitus_gestational + comorbid_diabetes_mellitus_type_not_specified + comorbid_gastrointestinal_bleeding + comorbid_hiv + comorbid_immunosuppression + comorbid_lipid_disorder + comorbid_liver_disease + comorbid_mild_liver_disease + comorbid_moderate_or_severe_liver_disease + comorbid_severe_liver_disease + comorbid_malignant_neoplasm + comorbid_malnutrition + comorbid_mental_disorder + comorbid_obesity + comorbid_other + comorbid_other_relevant_risk_factor + comorbid_peptic_ulcer_disease + `comorbid_previous_covid-19_infection` + comorbid_rare_diseases_and_inborn_errors_of_metabolism + comorbid_rheumatological_disorder + comorbid_solid_organ_transplant + comorbid_transplantation + comorbid_tuberculosis + comorbid_ | comorbid_chronic_cardiac_disease, data = data)
#Congestive heart failure- all the results are 0
table1(~ comorbid_cardiac_arrhythmia + comorbid_chronic_cardiac_disease + comorbid_hypertension + comorbid_myocardial_infarction + comorbid_peripheral_vascular_disease + comorbid_smoking + comorbid_asplenia + comorbid_asthma + comorbid_autoimmune_disease + comorbid_chronic_haematological_disease + comorbid_chronic_inflammatory_condition + comorbid_chronic_kidney_disease + comorbid_chronic_metabolic_endocrine_disease + comorbid_chronic_neurological_disorder + comorbid_chronic_pulmonary_disease + comorbid_other_chronic_disease + comorbid_dementia + comorbid_diabetes_mellitus_type_1 + comorbid_diabetes_mellitus_type_2 + comorbid_diabetes_mellitus_gestational + comorbid_diabetes_mellitus_type_not_specified + comorbid_gastrointestinal_bleeding + comorbid_hiv + comorbid_immunosuppression + comorbid_lipid_disorder + comorbid_liver_disease + comorbid_mild_liver_disease + comorbid_moderate_or_severe_liver_disease + comorbid_severe_liver_disease + comorbid_malignant_neoplasm + comorbid_malnutrition + comorbid_mental_disorder + comorbid_obesity + comorbid_other + comorbid_other_relevant_risk_factor + comorbid_peptic_ulcer_disease + `comorbid_previous_covid-19_infection` + comorbid_rare_diseases_and_inborn_errors_of_metabolism + comorbid_rheumatological_disorder + comorbid_solid_organ_transplant + comorbid_transplantation + comorbid_tuberculosis + comorbid_ | comorbid_congestive_heart_failure, data = data)
#Hypertension- all the results are 0
table1(~ comorbid_cardiac_arrhythmia + comorbid_chronic_cardiac_disease + comorbid_congestive_heart_failure + comorbid_myocardial_infarction + comorbid_peripheral_vascular_disease + comorbid_smoking + comorbid_asplenia + comorbid_asthma + comorbid_autoimmune_disease + comorbid_chronic_haematological_disease + comorbid_chronic_inflammatory_condition + comorbid_chronic_kidney_disease + comorbid_chronic_metabolic_endocrine_disease + comorbid_chronic_neurological_disorder + comorbid_chronic_pulmonary_disease + comorbid_other_chronic_disease + comorbid_dementia + comorbid_diabetes_mellitus_type_1 + comorbid_diabetes_mellitus_type_2 + comorbid_diabetes_mellitus_gestational + comorbid_diabetes_mellitus_type_not_specified + comorbid_gastrointestinal_bleeding + comorbid_hiv + comorbid_immunosuppression + comorbid_lipid_disorder + comorbid_liver_disease + comorbid_mild_liver_disease + comorbid_moderate_or_severe_liver_disease + comorbid_severe_liver_disease + comorbid_malignant_neoplasm + comorbid_malnutrition + comorbid_mental_disorder + comorbid_obesity + comorbid_other + comorbid_other_relevant_risk_factor + comorbid_peptic_ulcer_disease + `comorbid_previous_covid-19_infection` + comorbid_rare_diseases_and_inborn_errors_of_metabolism + comorbid_rheumatological_disorder + comorbid_solid_organ_transplant + comorbid_transplantation + comorbid_tuberculosis + comorbid_ | comorbid_hypertension, data = data)
#Myocardial infarction- all the results are 0
table1(~ comorbid_cardiac_arrhythmia + comorbid_chronic_cardiac_disease + + comorbid_congestive_heart_failure + comorbid_hypertension + comorbid_peripheral_vascular_disease + comorbid_smoking + comorbid_asplenia + comorbid_asthma + comorbid_autoimmune_disease + comorbid_chronic_haematological_disease + comorbid_chronic_inflammatory_condition + comorbid_chronic_kidney_disease + comorbid_chronic_metabolic_endocrine_disease + comorbid_chronic_neurological_disorder + comorbid_chronic_pulmonary_disease + comorbid_other_chronic_disease + comorbid_dementia + comorbid_diabetes_mellitus_type_1 + comorbid_diabetes_mellitus_type_2 + comorbid_diabetes_mellitus_gestational + comorbid_diabetes_mellitus_type_not_specified + comorbid_gastrointestinal_bleeding + comorbid_hiv + comorbid_immunosuppression + comorbid_lipid_disorder + comorbid_liver_disease + comorbid_mild_liver_disease + comorbid_moderate_or_severe_liver_disease + comorbid_severe_liver_disease + comorbid_malignant_neoplasm + comorbid_malnutrition + comorbid_mental_disorder + comorbid_obesity + comorbid_other + comorbid_other_relevant_risk_factor + comorbid_peptic_ulcer_disease + `comorbid_previous_covid-19_infection` + comorbid_rare_diseases_and_inborn_errors_of_metabolism + comorbid_rheumatological_disorder + comorbid_solid_organ_transplant + comorbid_transplantation + comorbid_tuberculosis + comorbid_ | comorbid_myocardial_infarction, data = data)
#Peripheral vascular disease- all the results are 0
table1(~ comorbid_cardiac_arrhythmia + comorbid_chronic_cardiac_disease + comorbid_congestive_heart_failure + comorbid_hypertension + comorbid_myocardial_infarction + comorbid_smoking + comorbid_asplenia + comorbid_asthma + comorbid_autoimmune_disease + comorbid_chronic_haematological_disease + comorbid_chronic_inflammatory_condition + comorbid_chronic_kidney_disease + comorbid_chronic_metabolic_endocrine_disease + comorbid_chronic_neurological_disorder + comorbid_chronic_pulmonary_disease + comorbid_other_chronic_disease + comorbid_dementia + comorbid_diabetes_mellitus_type_1 + comorbid_diabetes_mellitus_type_2 + comorbid_diabetes_mellitus_gestational + comorbid_diabetes_mellitus_type_not_specified + comorbid_gastrointestinal_bleeding + comorbid_hiv + comorbid_immunosuppression + comorbid_lipid_disorder + comorbid_liver_disease + comorbid_mild_liver_disease + comorbid_moderate_or_severe_liver_disease + comorbid_severe_liver_disease + comorbid_malignant_neoplasm + comorbid_malnutrition + comorbid_mental_disorder + comorbid_obesity + comorbid_other + comorbid_other_relevant_risk_factor + comorbid_peptic_ulcer_disease + `comorbid_previous_covid-19_infection` + comorbid_rare_diseases_and_inborn_errors_of_metabolism + comorbid_rheumatological_disorder + comorbid_solid_organ_transplant + comorbid_transplantation + comorbid_tuberculosis + comorbid_ | comorbid_peripheral_vascular_disease, data = data)
```

#Frequencies of symptoms by cardiovascular comorbidities
```{r}
#Decided not to do the faceting for this as there is too much variation in the number of the symptoms recorded for the different cardiovascular comorbidities
label(data$symptoms_abdominal_pain) <- "Symptoms- Abdominal pain"
label(data$symptoms_acute_kidney_injury) <- "Symptoms- Acute kidney injury"
label(data$symptoms_altered_consciousness_confusion) <- "Symptoms- Altered consciousness, confusion"
label(data$symptoms_anorexia) <- "Symptoms- Anorexia"
label(data$symptoms_apnoea) <- "Symptoms- Apnoea"
label(data$symptoms_ards) <- "Symptoms- ARDS"
label(data$symptoms_asymptomatic) <- "Symptoms- Asymptomatic"
label(data$symptoms_atrial_fibrillation) <- "Symptoms- Atrial fibrillation"
label(data$symptoms_bacteraemia) <- "Symptoms- Bacteraemia"
label(data$symptoms_bacterial_pneumonia) <- "Symptoms- Bacterial pneumonia"
label(data$symptoms_bleeding) <- "Symptoms- Bleeding"
label(data$symptoms_cardiac_arrest) <- "Symptoms- Cardiac arrest"
label(data$symptoms_chest_pain) <- "Symptoms- Chest pain"
label(data$symptoms_chronic_cardiac_disease) <- "Symptoms- Chronic cardiac disease"
label(data$symptoms_comorbidities) <- "Symptoms- Comorbidities"
label(data$symptoms_conjunctivitis) <- "Symptoms- Conjunctivitis"
label(data$symptoms_convulsions) <- "Symptoms- Convulsions"
label(data$symptoms_cough) <- "Symptoms- Cough"
label(data$symptoms_crepitant) <- "Symptoms- Crepitant"
label(data$symptoms_diabetic_ketoacidosis) <- "Symptoms- Diabetic ketoacidosis"
label(data$symptoms_diarrhoea) <- "Symptoms- Diarrhoea"
label(data$symptoms_disseminated_intravascular_coagulation) <- "Symptoms- Disseminated intravascular coagulation"
label(data$symptoms_dizziness) <- "Symptoms- Dizziness"
label(data$symptoms_ear_pain) <- "Symptoms- Ear pain"
label(data$symptoms_encephalopathy) <- "Symptoms- Encephalopathy"
label(data$symptoms_fatigue_malaise) <- "Symptoms- Fatigue, malaise"
label(data$symptoms_gastrointestinal_bleeding) <- "Symptoms- Gastrointestinal bleeding"
label(data$symptoms_haemoglobinuria) <- "Symptoms- Haemoglobinuria"
label(data$symptoms_headache) <- "Symptoms- Headache"
label(data$symptoms_hematuria) <- "Symptoms- Hematuria"
label(data$symptoms_history_of_fever) <- "Symptoms- History of fever"
label(data$symptoms_hyperglycaemia) <- "Symptoms- Hyperglycaemia"
label(data$symptoms_hypoglycaemia) <- "Symptoms- Hypoglycaemia"
label(data$symptoms_inability_to_walk) <- "Symptoms- Inability to walk"
label(data$symptoms_irritability) <- "Symptoms- Irritability"
label(data$symptoms_leukocyturia) <- "Symptoms- Leukocyturia"
label(data$symptoms_liver_disease) <- "Symptoms- Liver disease"
label(data$symptoms_lost_altered_sense_of_smell) <- "Symptoms- Lost, altered sense of smell"
label(data$symptoms_lost_altered_sense_of_taste) <- "Symptoms- Lost, altered sense of taste"
label(data$symptoms_lymphadenopathy) <- "Symptoms- Lymphadenopathy"
label(data$symptoms_meningitis_encephalitis) <- "Symptoms- Meningitis, encephalitis"
label(data$symptoms_mouth_ulcers) <- "Symptoms- Mouth ulcers"
label(data$symptoms_muscle_aches_joint_pain) <- "Symptoms- Muscle aches, joint pain"
label(data$symptoms_myocardial_infarction) <- "Symptoms- Myocardial infarction"
label(data$symptoms_myocarditis) <- "Symptoms- Myocarditis"
label(data$symptoms_nausea) <- "Symptoms- Nausea"
label(data$symptoms_other_signs) <- "Symptoms- Other signs"
label(data$symptoms_other_signs_and_symptoms) <- "Symptoms- Other signs and symptoms"
label(data$symptoms_pharyngeal_exudate) <- "Symptoms- Pharyngeal exudate"
label(data$symptoms_pleural_effusion) <- "Symptoms- Pleural effusion"
label(data$symptoms_pneumothorax) <- "Symptoms- Pneumothorax"
label(data$symptoms_pretibial_edema_or_limb_peeling) <- "Symptoms- Pretibial edema or limb peeling"
label(data$symptoms_proteinuria) <- "Symptoms- Proteinuria"
label(data$symptoms_rhabdomyolysis) <- "Symptoms- Rhabdomyolysis"
label(data$symptoms_ronchus) <- "Symptoms- Ronchus"
label(data$symptoms_runny_nose) <- "Symptoms- Runny nose"
label(data$symptoms_seizures) <- "Symptoms- Seizures"
label(data$symptoms_sepsis) <- "Symptoms- Sepsis"
label(data$symptoms_severe_dehydration) <- "Symptoms- Severe dehydration"
label(data$symptoms_shock) <- "Symptoms- Shock"
label(data$symptoms_shortness_of_breath) <- "Symptoms- Shortness of breath"
label(data$symptoms_skin_rash) <- "Symptoms- Skin rash"
label(data$symptoms_sore_throat) <- "Symptoms- Sore throat"
label(data$symptoms_strawberry_tongue) <- "Symptoms- Strawberry tongue"
label(data$symptoms_stroke) <- "Symptoms- Stroke"
label(data$symptoms_sub_crepitant) <- "Symptoms- Sub crepitant"
label(data$symptoms_transplantation) <- "Symptoms- Transplantation"
label(data$symptoms_upper_respiratory_tract_symptoms) <- "Symptoms- Upper respiratory tract symptoms"
label(data$symptoms_vomiting_nausea) <- "Symptoms- Vomiting, nausea"
label(data$symptoms_wheezing) <- "Symptoms- Wheezing"
label(data$pulmonary_embolism) <- "Pulmonary embolism"
label(data$pulmonary_embolism_or_dvt) <- "Pulmonary embolism or DVT"
label(data$thromboembolsim) <- "Thromboembolism"
label(data$symptrcd_upper_respiratory_tract_symptoms) <- "Symptrcd- Upper respiratory tract symptoms"

#Cardiac arrhythmia- works
table1(~ symptoms_abdominal_pain + symptoms_acute_kidney_injury + symptoms_altered_consciousness_confusion + symptoms_anorexia + symptoms_apnoea + symptoms_ards + symptoms_asymptomatic + symptoms_atrial_fibrillation + symptoms_bacteraemia + symptoms_bacterial_pneumonia + symptoms_bleeding + symptoms_cardiac_arrest + symptoms_chest_pain + symptoms_chronic_cardiac_disease + symptoms_comorbidities + symptoms_conjunctivitis + symptoms_convulsions + symptoms_cough + symptoms_crepitant + symptoms_diabetic_ketoacidosis + symptoms_diarrhoea + symptoms_disseminated_intravascular_coagulation + symptoms_dizziness + symptoms_ear_pain + symptoms_encephalopathy + symptoms_fatigue_malaise + symptoms_gastrointestinal_bleeding + symptoms_haemoglobinuria + symptoms_headache + symptoms_hematuria + symptoms_history_of_fever + symptoms_hyperglycaemia + symptoms_hypoglycaemia + symptoms_inability_to_walk + symptoms_irritability + symptoms_leukocyturia + symptoms_liver_disease + symptoms_lost_altered_sense_of_smell + symptoms_lost_altered_sense_of_taste + symptoms_lymphadenopathy + symptoms_meningitis_encephalitis + symptoms_mouth_ulcers + symptoms_muscle_aches_joint_pain + symptoms_myocardial_infarction + symptoms_myocarditis + symptoms_nausea + symptoms_other_signs + symptoms_other_signs_and_symptoms + symptoms_pharyngeal_exudate + symptoms_pleural_effusion + symptoms_pneumothorax + symptoms_pretibial_edema_or_limb_peeling + symptoms_proteinuria + symptoms_rhabdomyolysis + symptoms_ronchus + symptoms_runny_nose + symptoms_seizures + symptoms_sepsis + symptoms_severe_dehydration + symptoms_shock + symptoms_shortness_of_breath + symptoms_skin_rash + symptoms_sore_throat + symptoms_strawberry_tongue + symptoms_stroke + symptoms_sub_crepitant + symptoms_transplantation + symptoms_upper_respiratory_tract_symptoms + symptoms_vomiting_nausea + symptoms_wheezing + pulmonary_embolism + pulmonary_embolism_or_dvt + thromboembolsim + symptrcd_upper_respiratory_tract_symptoms | comorbid_cardiac_arrhythmia, data = data)

dataforcardiacarrhythmiacomorbiditybysymptoms <- data.frame(Comorbidity=rep(c("Cardiac arrhythmia- Yes", "Cardiac arrhythmia- No"),each=84), Symptoms=rep(c("Abdominal pain- Yes", "Abdominal pain- No","Abdominal pain- Missing", "Altered consciousness confusion- Yes", "Altered consciousness confusion- No","Altered consciousness confusion- Missing", "Bleeding- Yes", "Bleeding- No","Bleeding- Missing", "Chest pain- Yes", "Chest pain- No","Chest pain- Missing", "Conjunctivitis- Yes", "Conjunctivitis- No","Conjunctivitis- Missing", "Cough- Yes", "Cough- No", "Cough- Missing", "Diarrhoea- Yes", "Diarrhoea- No","Diarrhoea- Missing", "Ear pain- Yes", "Ear pain- No","Ear pain- Missing", "Fatigue malaise- Yes", "Fatigue malaise- No","Fatigue malaise- Missing", "Haemoglobinuria- Yes", "Haemoglobinuria- No", "Haemoglobinuria- Missing", "Headache- Yes", "Headache- No","Headache- Missing", "Hematuria- Yes", "Hematuria- No","Hematuria- Missing", "History of fever- Yes", "History of fever- No","History of fever- Missing", "Leukocyturia- Yes", "Leukocyturia- No","Leukocyturia- Missing", "Lost altered sense of smell- Yes", "Lost altered sense of smell- No", "Lost altered sense of smell- Missing", "Lost altered sense of taste- Yes", "Lost altered sense of taste- No", "Lost altered sense of taste- Missing", "Lymphadenopathy- Yes", "Lymphadenopathy- No", "Lymphadenopathy- Missing", "Muscle aches joint pain- Yes", "Muscle aches joint pain- No","Muscle aches joint pain- Missing", "Proteinuria- Yes", "Proteinuria- No","Proteinuria- Missing", "Runny nose- Yes", "Runny nose- No","Runny nose- Missing", "Seizures- Yes", "Seizures- No", "Seizures- Missing", "Severe dehydration- Yes", "Severe dehydration- No", "Severe dehydration- Missing", "Shortness of breath- Yes", "Shortness of breath- No", "Shortness of breath- Missing", "Skin rash- Yes", "Skin rash- No", "Skin rash- Missing", "Sore throat- Yes", "Sore throat- No","Sore throat- Missing", "Vomiting nausea- Yes", "Vomiting nausea- No", "Vomiting nausea- Missing", "Wheezing- Yes", "Wheezing- No","Wheezing- Missing", "Symptrcd upper respiratory tract symptoms- Yes", "Symptrcd upper respiratory tract symptoms- No", "Symptrcd upper respiratory tract symptoms- Missing"),2),Frequency_of_comorbidity=c(1,18,1,2,17,1,3,16,1,2,18,0,0,19,1,12,7,1,3,16,1,0,20,0,11,8,1,1,2,17,0,19,1,2,1,17,11,9,0,3,0,17,2,17,1,1,18,1,0,18,2,4,15,1,1,2,17,2,17,1,0,19,1,0,16,4,12,7,1,0,19,1,1,19,0,0,19,1,2,18,0,3,17,0,            0,19,1,0,19,1,0,19,1,3,16,1,0,19,1,13,7,0,0,19,1,0,19,1,6,13,1,0,1,19,5,14,1,0,1,19,12,8,0,0,1,19,2,17,1,2,17,1,0,19,1,6,14,0,0,1,19,3,16,1,0,19,1,0,19,1,6,13,1,0,19,1,2,17,1,2,17,1,0,19,1,4,15,1))
dataforcardiacarrhythmiacomorbiditybysymptoms
ggplot(data=dataforcardiacarrhythmiacomorbiditybysymptoms, aes(x=Symptoms, y=Frequency_of_comorbidity, fill=Comorbidity)) + geom_bar(stat="identity", position=position_dodge()) + geom_text(aes(label=Frequency_of_comorbidity), hjust=1, angle=90, color="black", position = position_dodge(0.9), size=3) + xlab("Symptoms") + ylab("Frequency of symptoms") + theme(axis.text.x = element_text(angle = 90, hjust=1, vjust=0.5, size = 12)) + theme(axis.title.x=element_text(size=15), axis.title.y=element_text(size=15), axis.text.y=element_text(size=10))

#Chronic cardiac disease
table1(~ symptoms_abdominal_pain + symptoms_acute_kidney_injury + symptoms_altered_consciousness_confusion + symptoms_anorexia + symptoms_apnoea + symptoms_ards + symptoms_asymptomatic + symptoms_atrial_fibrillation + symptoms_bacteraemia + symptoms_bacterial_pneumonia + symptoms_bleeding + symptoms_cardiac_arrest + symptoms_chest_pain + symptoms_chronic_cardiac_disease + symptoms_comorbidities + symptoms_conjunctivitis + symptoms_convulsions + symptoms_cough + symptoms_crepitant + symptoms_diabetic_ketoacidosis + symptoms_diarrhoea + symptoms_disseminated_intravascular_coagulation + symptoms_dizziness + symptoms_ear_pain + symptoms_encephalopathy + symptoms_fatigue_malaise + symptoms_gastrointestinal_bleeding + symptoms_haemoglobinuria + symptoms_headache + symptoms_hematuria + symptoms_history_of_fever + symptoms_hyperglycaemia + symptoms_hypoglycaemia + symptoms_inability_to_walk + symptoms_irritability + symptoms_leukocyturia + symptoms_liver_disease + symptoms_lost_altered_sense_of_smell + symptoms_lost_altered_sense_of_taste + symptoms_lymphadenopathy + symptoms_meningitis_encephalitis + symptoms_mouth_ulcers + symptoms_muscle_aches_joint_pain + symptoms_myocardial_infarction + symptoms_myocarditis + symptoms_nausea + symptoms_other_signs + symptoms_other_signs_and_symptoms + symptoms_pharyngeal_exudate + symptoms_pleural_effusion + symptoms_pneumothorax + symptoms_pretibial_edema_or_limb_peeling + symptoms_proteinuria + symptoms_rhabdomyolysis + symptoms_ronchus + symptoms_runny_nose + symptoms_seizures + symptoms_sepsis + symptoms_severe_dehydration + symptoms_shock + symptoms_shortness_of_breath + symptoms_skin_rash + symptoms_sore_throat + symptoms_strawberry_tongue + symptoms_stroke + symptoms_sub_crepitant + symptoms_transplantation + symptoms_upper_respiratory_tract_symptoms + symptoms_vomiting_nausea + symptoms_wheezing + pulmonary_embolism + pulmonary_embolism_or_dvt + thromboembolsim + symptrcd_upper_respiratory_tract_symptoms | comorbid_chronic_cardiac_disease, data = data)

#First half of the graph
dataforchroniccardiacdiseasecomorbiditybysymptoms1 <- data.frame(Comorbidity=rep(c("Chronic cardiac disease- Yes", "Chronic cardiac disease- No"),each=93), Symptoms=rep(c("Abdominal pain- Yes", "Abdominal pain- No", "Abdominal pain- Missing", "Acute kidney injury- Yes", "Acute kidney injury- No", "Acute kidney injury- Missing", "Altered consciousness confusion- Yes", "Altered consciousness confusion- No", "Altered consciousness confusion- Missing", "Anorexia- Yes", "Anorexia- No", "Anorexia- Missing", "Apnoea- Yes", "Apnoea- No", "Apnoea- Missing", "ARDS- Yes", "ARDS- No", "ARDS- Missing", "Asymptomatic- Yes", "Asymptomatic- No", "Asymptomatic- Missing", "Atrial fibrillation- Yes", "Atrial fibrillation- No", "Atrial fibrillation- Missing", "Bacteriaemia- Yes", "Bacteriaemia- No", "Bacteraemia- Missing", "Bacterial pneumonia- Yes", "Bacterial pneumonia- No", "Bacterial pneumonia- Missing", "Bleeding- Yes", "Bleeding- No", "Bleeding- Missing", "Cardiac arrest- Yes", "Cardiac arrest- No", "Cardiac arrest- Missing", "Chest pain- Yes", "Chest pain- No", "Chest pain- Missing", "Conjunctivitis- Yes", "Conjunctivitis- No", "Conjunctivitis- Missing", "Cough- Yes", "Cough- No", "Cough- Missing", "Diabetic ketoacidosis- Yes", "Diabetic ketoacidosis- No", "Diabetic ketoacidosis- Missing", "Diarrhoea- Yes", "Diarrhoea- No", "Diarrhoea- Missing", "Disseminated intravascular coagulation- Yes", "Disseminated intravascular coagulation- No", "Disseminated intravascular coagulation- Missing", "Dizziness- Yes", "Dizziness- No", "Dizziness- Missing", "Ear pain- Yes", "Ear pain- No", "Ear pain- Missing", "Encephalopathy- Yes", "Encephalopathy- No", "Encephalopathy- Missing", "Fatigue malaise- Yes", "Fatigue malaise- No", "Fatigue malaise- Missing", "Gastrointestinal bleeding- Yes", "Gastrointestinal bleeding- No", "Gastrointestinal bleeding- Missing", "Haemoglobinuria- Yes", "Haemoglobinuria- No", "Haemoglobinuria- Missing", "Headache- Yes", "Headache- No", "Headache- Missing,", "Hematuria- Yes", "Hematuria- No", "Hematuria- Missing", "History of fever- Yes", "History of fever- No", "History of fever- Missing", "Hyperglycaemia- Yes", "Hyperglycaemia- No", "Hyperglycaemia- Missing", "Hypoglycaemia- Yes", "Hypoglycaemia- No", "Hypoglycaemia- Missing", "Inability to walk- Yes", "Inability to walk- No", "Inability to walk- Missing", "Irritability- Yes", "Irritability- No", "Irritability- Missing"),2), Frequency_of_comorbidity=c(1238,14993,7555,  0,4,23782,   4419,12557,6810,   254,1103,22429,   0,3,23783,    0,4,23782,    876,10043,12867,    0,4,23782,  0,4,23782,     0,4,23782,     363,15770,7653,    0,4,23782,   2158,14243,7385,   52,15326,8408,     9717,8211,5858,   0,4,23782,    2288,14457,7041,    0,4,23782,     0,4,23782,     31,13194,10561,     6,204,23576,     6288,9710,7788,    0,4,23782,    0,9,23777,     1054,14443,8289,      1,9,23776,      8735,9156,5895,     0,4,23782,    0,4,23782,      149,1471,22166,   0,3,23783,                144,1767,14086,   0,0,15997,   110,1614,14273,    35,336,15626,     0,14,15983,   0,0,15997,      65,821,15111,   0,0,15997,     0,0,15997,   0,0,15997,   16,1881,14100,    0,0,15997,     269,1665,14063,     15,1839,14143,    1250,808,13939,      0,0,15997,   324,1624,14049,        0,0,15997,     0,0,15997,      7,1429,14561,    0,0,15997,     633,1284,14080,       0,0,15997,   1,2,15994,      319,1548,14130,     1,2,15994,    1268,779,13950,      0,0,15997,     0,0,15997,    15,320,15662,      0,19,15978))
dataforchroniccardiacdiseasecomorbiditybysymptoms1
ggplot(data=dataforchroniccardiacdiseasecomorbiditybysymptoms1, aes(x=Symptoms, y=Frequency_of_comorbidity, fill=Comorbidity)) + geom_bar(stat="identity", position=position_dodge()) + geom_text(aes(label=Frequency_of_comorbidity), hjust=1, angle=90, color="black",position = position_dodge(0.9), size=3) + xlab("Symptoms") + ylab("Frequency of symptoms (pseudo log scale)") + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + theme(axis.text.x = element_text(angle = 90, hjust=1, vjust=0.5, size = 12)) + theme(axis.title.x=element_text(size=15), axis.title.y=element_text(size=15), axis.text.y=element_text(size=10))

#Second half of the graph
dataforchroniccardiacdiseasecomorbiditybysymptoms2 <- data.frame(Comorbidity=rep(c("Chronic cardiac disease- Yes", "Chronic cardiac disease- No"),each=96), Symptoms=rep(c("Leukocyturia- Yes", "Leukocyturia- No", "Leukocyturia- Missing", "Liver disease- Yes", "Liver disease- No", "Liver disease- Missing", "Lost altered sense of smell- Yes", "Lost altered sense of smell- No", "Lost altered sense of smell- Missing", "Lost altered sense of taste- Yes", "Lost altered sense of taste- No", "Lost altered sense of taste- Missing", "Lymphadenopathy- Yes", "Lymphadenopathy- No", "Lymphadenopathy- Missing", "Meningitis encephalitis- Yes", "Meningitis encephalitis- No", "Meningitis encephalitis- Missing", "Mouth ulcers- Yes", "Mouth ulcers- No", "Mouth ulcers- Missing", "Muscle aches joint pain- Yes", "Muscle aches joint pain- No", "Muscle aches joint pain- Missing", "Myocardial infarction- Yes", "Myocardial infarction- No", "Myocardial infarction- Missing", "Myocarditis- Yes", "Myocarditis- No", "Myocarditis- Missing", "Other signs- Yes", "Other signs- No", "Other signs- Missing", "Other signs and symptoms- Yes", "Other signs and symptoms- No", "Other signs and symptoms- Missing", "Pleural effusion- Yes", "Pleural effusion- No", "Pleural effusion- Missing", "Pneumothorax- Yes", "Pneumothorax- No", "Pneumothorax- Missing", "Proteinuria- Yes", "Proteinuria- No", "Proteinuria- Missing", "Rhabdomyolysis- Yes", "Rhabdomyolysis- No", "Rhabdomyolysis- Missing", "Runny nose- Yes", "Runny nose- No", "Runny nose- Missing", "Seizures- Yes", "Seizures- No", "Seizures- Missing", "Sepsis- Yes", "Sepsis- No", "Sepsis- Missing", "Sever dehydration- Yes", "Severe dehydration- No", "Severe dehydration- Missing", "Shock- Yes", "Shock- No", "Shock- Missing", "Shortness of breath- Yes", "Shortness of breath- No", "Shortness of breath- Missing", "Skin rash- Yes", "Skin rash- No", "Skin rash- Missing", "Sore throat- Yes", "Sore throat- No", "Sore throat- Missing", "Stroke- Yes", "Stroke- No", "Stroke- Missing", "Upper respiratory tract symptoms- Yes", "Upper respiratory tract symptoms- No", "Upper respiratory tract symptoms- Missing", "Vomiting nausea- Yes", "Vomiting nausea- No", "Vomiting nausea- Missing", "Wheezing- Yes", "Wheezing- No", "Wheezing- Missing", "Pulmonary embolism- Yes", "Pulmonary embolism- No", "Pulmonary embolism- Missing", "Pulmonary embolism or DVT- Yes", "Pulmonary embolism or DVT- No", "Pulmonary embolism or DVT- Missing", "Thromboembolism- Yes", "Thromboembolism- No", "Thromboembolism- Missing",  "Symptrcd Upper respiratory tract symptoms- Yes", "Symptrcd Upper respiratory tract symptoms- No", "Symptrcd Upper respiratory tract symptoms- Missing"),2), Frequency_of_comorbidity=c(3,7,23776,    0,1,23785,    458,11499,11829,     563,10974,12249,     95,15255,8436,      0,4,23782,     1,6,23779,    1999,13408,8379,      0,4,23782,     0,4,23782,    68,142,23576,     248,1176,22362,    0,4,23782,    0,4,23782,     4,6,23776,       0,4,23782,     328,14532,8926,    172,15988,7626,    0,4,23782,       1112,7028,15646,    0,4,23782,     10709,7367,5710,    440,15283,8063,     659,14275,8852,    0,4,23782,       1,10,23775,   2323,14220,7243,      1105,14569,8112,    253,9709,13824,     23,187,23576,   3,242,23541,    927,14387,8472,                      1,2,15994,     0,0,15997,     139,1436,14422,     140,1395,14462,     11,1626,14360,   0,0,15997,     0,54,15943,      401,1487,14109,   0,0,15997,  0,0,15997,     0,0,15997,    19,257,15721,       0,0,15997,     0,0,15997,       2,1,15994,      0,0,15997,   165,1661,14171,      15,1688,14294,           0,0,15997,      41,758,15198,    0,0,15997,     1083,969,13945,        38,1854,14105,     223,1603,14171,    0,0,15997,    1,6,15990,    332,1617,14048,    61,1754,14182,     32,1376,14589,    0,0,15997,     1,50,15946,      341,1541,14115))
dataforchroniccardiacdiseasecomorbiditybysymptoms2
ggplot(data=dataforchroniccardiacdiseasecomorbiditybysymptoms2, aes(x=Symptoms, y=Frequency_of_comorbidity, fill=Comorbidity)) + geom_bar(stat="identity", position=position_dodge()) + geom_text(aes(label=Frequency_of_comorbidity), hjust=1, angle=90, color="black", position = position_dodge(0.9), size=3) + xlab("Symptoms") + ylab("Frequency of symptoms (pseudo log scale)") + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + theme(axis.text.x = element_text(angle = 90, hjust=1, vjust=0.5, size = 12)) + theme(axis.title.x=element_text(size=15), axis.title.y=element_text(size=15), axis.text.y=element_text(size=10))

#Congestive heart failure- works
table1(~ symptoms_abdominal_pain + symptoms_acute_kidney_injury + symptoms_altered_consciousness_confusion + symptoms_anorexia + symptoms_apnoea + symptoms_ards + symptoms_asymptomatic + symptoms_atrial_fibrillation + symptoms_bacteraemia + symptoms_bacterial_pneumonia + symptoms_bleeding + symptoms_cardiac_arrest + symptoms_chest_pain + symptoms_chronic_cardiac_disease + symptoms_comorbidities + symptoms_conjunctivitis + symptoms_convulsions + symptoms_cough + symptoms_crepitant + symptoms_diabetic_ketoacidosis + symptoms_diarrhoea + symptoms_disseminated_intravascular_coagulation + symptoms_dizziness + symptoms_ear_pain + symptoms_encephalopathy + symptoms_fatigue_malaise + symptoms_gastrointestinal_bleeding + symptoms_haemoglobinuria + symptoms_headache + symptoms_hematuria + symptoms_history_of_fever + symptoms_hyperglycaemia + symptoms_hypoglycaemia + symptoms_inability_to_walk + symptoms_irritability + symptoms_leukocyturia + symptoms_liver_disease + symptoms_lost_altered_sense_of_smell + symptoms_lost_altered_sense_of_taste + symptoms_lymphadenopathy + symptoms_meningitis_encephalitis + symptoms_mouth_ulcers + symptoms_muscle_aches_joint_pain + symptoms_myocardial_infarction + symptoms_myocarditis + symptoms_nausea + symptoms_other_signs + symptoms_other_signs_and_symptoms + symptoms_pharyngeal_exudate + symptoms_pleural_effusion + symptoms_pneumothorax + symptoms_pretibial_edema_or_limb_peeling + symptoms_proteinuria + symptoms_rhabdomyolysis + symptoms_ronchus + symptoms_runny_nose + symptoms_seizures + symptoms_sepsis + symptoms_severe_dehydration + symptoms_shock + symptoms_shortness_of_breath + symptoms_skin_rash + symptoms_sore_throat + symptoms_strawberry_tongue + symptoms_stroke + symptoms_sub_crepitant + symptoms_transplantation + symptoms_upper_respiratory_tract_symptoms + symptoms_vomiting_nausea + symptoms_wheezing + pulmonary_embolism + pulmonary_embolism_or_dvt + thromboembolsim + symptrcd_upper_respiratory_tract_symptoms | comorbid_congestive_heart_failure, data = data)

dataforcongestiveheartfailurecomorbiditybysymptoms <- data.frame(Comorbidity=rep(c("Congestive heart failure- Yes"),each=132), Symptoms=c("Abdominal pain- Yes", "Abdominal pain- No", "Abdominal pain- Missing", "Acute kidney injury- Yes", "Acute kidney injury- No", "Acute kidney injury- Missing", "Altered consciousness confusion- Yes", "Altered consciousness confusion- No", "Altered consciousness confusion- Missing", "Anorexia- Yes", "Anorexia- No", "Anorexia- Missing", "ARDS- Yes", "ARDS- No", "ARDS- Missing", "Atrial fibrillation- Yes", "Atrial fibrillation- No", "Atrial fibrillation- Missing", "Bacteraemia- Yes", "Bacteraemia- No", "Bacteraemia- Missing", "Bacterial pneumonia- Yes", "Bacterial pneumonia- No", "Bacterial pneumonia- Missing", "Cardiac arrest- Yes", "Cardiac arrest- No", "Cardiac arrest- Missing", "Chest pain- Yes", "Chest pain- No", "Chest pain- Missing", "Conjunctivitis- Yes", "Conjunctivitis- No", "Conjunctivitis- Missing", "Cough- Yes", "Cough- No", "Cough- Missing", "Diabetic ketoacidosis- Yes", "Diabetic ketoacidosis- No", "Diabetic ketoacidosis- Missing", "Diarrhoea- Yes", "Diarrhoea- No", "Diarrhoea- Missing", "Disseminated intravascular coagulation- Yes", "Disseminated intravascular coagulation- No", "Disseminated intravascular coagulation- Missing", "Dizziness- Yes", "Dizziness- No", "Dizziness- Missing", "Fatigue malaise- Yes", "Fatigue malaise- No", "Fatigue malaise- Missing", "Gastrointestinal bleeding- Yes", "Gastrointestinal bleeding- No", "Gastrointestinal bleeding- Missing", "Headache- Yes", "Headache- No", "Headache- Missing", "History of fever- Yes", "History of fever- No", "History of fever- Missing", "Hyperglycaemia- Yes", "Hyperglycaemia- No", "Hyperglycaemia- Missing", "Hypoglycaemia- Yes", "Hypoglycaemia- No", "Hypoglycaemia- Missing", "Liver disease- Yes", "Liver disease- No", "Liver disease- Missing", "Lost altered sense of smell- Yes", "Lost altered sense of smell- No", "Lost altered sense of smell- Missing", "Lost altered sense of taste- Yes", "Lost altered sense of taste- No", "Lost altered sense of taste- No", "Lymphadenopathy- Yes", "Lymphadenopathy- No", "Lymphadenopathy- Missing", "Meningitis Encephalitis- Yes", "Meningitis Encephalitis- No","Meningitis Encephalitis- Missing", "Muscle aches joint pain- Yes", "Muscle aches joint pain- No", "Muscle aches joint pain- Missing", "Myocardial infarction- Yes", "Myocardial infarction- No", "Myocardial infarction- Missing", "Myocarditis- Yes", "Myocarditis- No", "Myocarditis- Missing", "Pleural effusion- Yes", "Pleural effusion- No", "Pleural effusion- Missing", "Pneumothorax- Yes", "Pneumothorax- No", "Pneumothorax- Missing", "Rhabdomyolysis- Yes", "Rhabdomyolysis- No", "Rhabdomyolysis- Missing", "Runny nose- Yes", "Runny nose- No", "Runny nose- Missing", "Seizures- Yes", "Seizures- No", "Seizures- Missing", "Sepsis- Yes", "Sepsis- No", "Sepsis- Missing", "Shock- Yes", "Shock- No", "Shock- Missing", "Shortness of breath- Yes", "Shortness of breath- No", "Shortness of breath- Missing", "Skin rash- Yes", "Skin rash- No", "Skin rash- Missing", "Sore throat- Yes", "Sore throat- No", "Sore throat- Missing", "Stroke- Yes", "Stroke- No", "Stroke- Missing", "Upper respiratory tract symptoms- Yes", "Upper respiratory tract symptoms- No", "Upper respiratory tract symptoms- Missing", "Vomiting nausea- Yes", "Vomiting nausea- No", "Vomiting nausea- Missing", "Symptrcd upper respiratory tract symptoms- Yes", "Symptrcd upper respiratory tract symptoms- No", "Symptrcd upper respiratory tract symptoms- Missing"), Frequency_of_comorbidity=c(1,2,0,      0,3,0,     2,1,0,    0,3,0,   0,3,0,  0,3,0,     0,3,0,    0,3,0,     0,3,0,    0,3,0,     0,3,0,      2,1,0,  0,3,0,      1,2,0,     0,3,0,       0,3,0,     1,2,0,    0,3,0,        0,3,0,    3,0,0,    0,3,0,    0,3,0,      0,1,2,   0,3,0,        0,3,0,     0,3,0,      0,3,0,     1,2,0,    0,3,0,     0,3,0,     0,3,0,     0,3,0,     0,3,0,      0,3,0,    1,2,0,   1,2,0,        1,2,0,   2,1,0,   0,3,0,     0,3,0,    0,3,0,    0,3,0,    1,2,0,    0,3,0))
dataforcongestiveheartfailurecomorbiditybysymptoms
ggplot(data=dataforcongestiveheartfailurecomorbiditybysymptoms, aes(x=Symptoms, y=Frequency_of_comorbidity, fill=Comorbidity)) +geom_bar(stat="identity", position=position_dodge()) + xlab("Symptoms") + ylab("Frequency of symptoms") + theme(axis.title.x=element_text(size=15), axis.title.y=element_text(size=15), axis.text.y=element_text(size=10)) + theme(axis.text.x = element_text(angle = 90, hjust=1, vjust=0.5, size = 8)) + geom_text(aes(label=Frequency_of_comorbidity), vjust=0.4, hjust=1, angle = 90, color="black", size=3)

#Hypertension
table1(~ symptoms_abdominal_pain + symptoms_acute_kidney_injury + symptoms_altered_consciousness_confusion + symptoms_anorexia + symptoms_apnoea + symptoms_ards + symptoms_asymptomatic + symptoms_atrial_fibrillation + symptoms_bacteraemia + symptoms_bacterial_pneumonia + symptoms_bleeding + symptoms_cardiac_arrest + symptoms_chest_pain + symptoms_chronic_cardiac_disease + symptoms_comorbidities + symptoms_conjunctivitis + symptoms_convulsions + symptoms_cough + symptoms_crepitant + symptoms_diabetic_ketoacidosis + symptoms_diarrhoea + symptoms_disseminated_intravascular_coagulation + symptoms_dizziness + symptoms_ear_pain + symptoms_encephalopathy + symptoms_fatigue_malaise + symptoms_gastrointestinal_bleeding + symptoms_haemoglobinuria + symptoms_headache + symptoms_hematuria + symptoms_history_of_fever + symptoms_hyperglycaemia + symptoms_hypoglycaemia + symptoms_inability_to_walk + symptoms_irritability + symptoms_leukocyturia + symptoms_liver_disease + symptoms_lost_altered_sense_of_smell + symptoms_lost_altered_sense_of_taste + symptoms_lymphadenopathy + symptoms_meningitis_encephalitis + symptoms_mouth_ulcers + symptoms_muscle_aches_joint_pain + symptoms_myocardial_infarction + symptoms_myocarditis + symptoms_nausea + symptoms_other_signs + symptoms_other_signs_and_symptoms + symptoms_pharyngeal_exudate + symptoms_pleural_effusion + symptoms_pneumothorax + symptoms_pretibial_edema_or_limb_peeling + symptoms_proteinuria + symptoms_rhabdomyolysis + symptoms_ronchus + symptoms_runny_nose + symptoms_seizures + symptoms_sepsis + symptoms_severe_dehydration + symptoms_shock + symptoms_shortness_of_breath + symptoms_skin_rash + symptoms_sore_throat + symptoms_strawberry_tongue + symptoms_stroke + symptoms_sub_crepitant + symptoms_transplantation + symptoms_upper_respiratory_tract_symptoms + symptoms_vomiting_nausea + symptoms_wheezing + pulmonary_embolism + pulmonary_embolism_or_dvt + thromboembolsim + symptrcd_upper_respiratory_tract_symptoms | comorbid_hypertension, data = data)

#First half of the graph
dataforhypertensioncomorbiditybysymptoms1 <- data.frame(Comorbidity=rep(c("Hypertension- Yes", "Hypertension- No"),each=96), Symptoms=rep(c("Abdominal pain- Yes", "Abdominal pain- No", "Abdominal pain- Missing", "Acute kidney injury- Yes", "Acute kidney injury- No", "Acute kidney injury- Missing", "Altered consciousness confusion- Yes", "Altered consciousness confusion- No", "Altered consciousness confusion- Missing", "Anorexia- Yes", "Anorexia- No", "Anorexia- Missing", "Apnoea- Yes", "Apnoea- No", "Apnoea- Missing", "ARDS- Yes", "ARDS- No", "ARDS- Missing", "Asymptomatic- Yes", "Asymptomatic- No", "Asymptomatic- Missing", "Atrial fibrillation- Yes", "Atrial fibrillation- No", "Atrial fibrillation- Missing", "Bacteraemia- Yes", "Bacteraemia- No", "Bacteraemia- Missing", "Bacterial pneumonia- Yes", "Bacterial pneumonia- No", "Bacterial pneumonia- Missing", "Bleeding- Yes", "Bleeding- No", "Bleeding- Missing", "Cardiac arrest- Yes", "Cardiac arrest- No", "Cardiac arrest- Missing", "Chest pain- Yes", "Chest pain- No", "Chest pain- Missing", "Chronic cardiac disease- Yes", "Chronic cardiac disease- No", "Chronic cardiac disease- Missing", "Conjunctivitis- Yes", "Conjunctivitis- No", "Conjunctivitis- Missing", "Cough- Yes", "Cough- No", "Cough- Missing", "Diabetic ketoacidosis- Yes", "Diabetic ketoacidosis- No", "Diabetic ketoacidosis- Missing", "Diarrhoea- Yes", "Diarrhoea- No", "Diarrhoea- Missing", "Disseminated intravascular coagulation- Yes", "Disseminated intravascular coagulation- No", "Disseminated intravascular coagulation- Missing", "Dizziness- Yes", "Dizziness- No", "Dizziness- Missing", "Ear pain- Yes", "Ear pain- No", "Ear pain- Missing", "Encephalopathy- Yes", "Encephalopathy- No", "Encephalopathy- Missing", "Fatigue malaise- Yes", "Fatigue malaise- No", "Fatigue malaise- Missing", "Gastrointestinal bleeding- Yes", "Gastrointestinal bleeding- No", "Gastrointestinal bleeding- Missing", "Haemoglobinuria- Yes", "Haemoglobinuria- No", "Haemoglobinuria- Missing",  "Headache- Yes", "Headache- No", "Headache- Missing", "Hematuria- Yes", "Hematuria- No", "Hematuria- Missing", "History of fever- Yes", "History of fever- No", "History of fever- Missing", "Hyperglycaemia- Yes", "Hyperglycaemia- No", "Hyperglycaemia- Missing", "Hypoglycaemia- Yes", "Hypoglycaemia- No", "Hypoglycaemia- Missing", "Inability to walk- Yes", "Inability to walk- No", "Inability to walk- Missing", "Irritability- Yes", "Irritability- No", "Irritability- Missing"),2), Frequency_of_comorbidity=c(2142,25214,87647,       2,10,114991,     5528,22148,87327,     687,3919,110397,     0,11,114993,    0,12,114991,     1387,17169,96447,    0,12,114991,   0,12,114991,  1,11,114991,   443,26661,87899,   0,12,114991,   3382,24240,87381,   0,3,115000,  101,25945,88957,   18065,12812,84126,    0,12,114991,   4769,23393,86841,   0,12,114991,    0,12,114991,    53,19777,95173,      4,158,114841,     11484,15758,87761,    0,12,114991,    1,33,114969,     2766,24888,87349,    9,29,114865,      17195,13062,84746,   0,12,114991,   0,12,114991,    311,5115,109577,    0,14,114989,                    88,983,15364,    0,1,16434,    34,850,15551,    40,264,16131,    0,15,16420,    0,1,16434,     30,379,16026,      0,1,16434,     0,1,16434,     0,1,16434,   20,1043,15372,    0,1,16434,    90,968,15377,    0,1,16434,    8,1034,15393,    597,525,15313,    0,1,16434,     145,958,15332,   0,1,16434,   0,1,16434,    2,726,15707,   0,0,16435,    339,748,15348,    0,1,16434,   0,1,16434,    167,907,15361,    0,1,16434,   666,466,15303,   0,1,16434,   0,1,16434,   6,288,16141,   0,16,16419))
dataforhypertensioncomorbiditybysymptoms1
ggplot(data=dataforhypertensioncomorbiditybysymptoms1, aes(x=Symptoms, y=Frequency_of_comorbidity, fill=Comorbidity)) + geom_bar(stat="identity", position=position_dodge()) + geom_text(aes(label=Frequency_of_comorbidity), hjust=1, angle=90, color="black", position = position_dodge(0.9), size=3) + xlab("Symptoms") + ylab("Frequency of symptoms (pseudo log scale)") + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + theme(axis.text.x = element_text(angle = 90, hjust=1, vjust=0.5, size = 12)) + theme(axis.title.x=element_text(size=15), axis.title.y=element_text(size=15), axis.text.y=element_text(size=10))

#Second half of the graph
dataforhypertensioncomorbiditybysymptoms2 <- data.frame(Comorbidity=rep(c("Hypertension- Yes", "Hypertension- No"),each=93), Symptoms=rep(c("Leukocyturia- Yes", "Leukocyturia- No", "Leukocyturia- Missing", "Liver disease- Yes", "Liver disease- No", "Liver disease- Missing", "Lost altered sense of smell- Yes", "Lost altered sense of smell- No", "Lost altered sense of smell- Missing", "Lost altered sense of taste- Yes", "Lost altered sense of taste- No", "Lost altered sense of taste- Missing", "Lymphadenopathy- Yes", "Lymphadenopathy- No", "Lymphadenopathy- Missing", "Meningitis Encephalitis- Yes", "Meningitis Encephalitis- No", "Meningitis Encephalitis- Missing", "Muscle aches joint pain- Yes", "Muscle aches joint pain- No", "Muscle aches joint pain- Missing", "Myocardial infarction- Yes", "Myocardial infarction- No", "Myocardial infarction- Missing", "Myocarditis- Yes", "Myocarditis- No", "Myocarditis- Missing", "Other signs- Yes", "Other signs- No", "Other signs- Missing", "Other signs and symptoms- Yes", "Other signs and symptoms- No", "Other signs and symptoms- Missing", "Pleural effusion- Yes", "Pleural effusion- No", "Pleural effusion", "Pneumothorax- Yes", "Pneumothorax- No", "Pneumothorax- Missing", "Proteinuria- Yes", "Proteinuria- No", "Proteinuria- Missing", "Rhabdomyolysis- Yes", "Rhabdomyolysis- No", "Rhabdomyolysis- Missing", "Runny nose- Yes", "Runny nose- No", "Runny nose- Missing", "Seizures- Yes", "Seizures- No", "Seizures- Missing", "Sepsis- Yes", "Sepsis- No", "Sepsis- Missing", "Severe dehydration- Yes", "Severe dehydration- No", "Severe dehydration- Missing", "Shock- Yes", "Shock- No", "Shock- Missing", "Shortness of breath- Yes", "Shortness of breath- No", "Shortness of breath- Missing", "Skin rash- Yes", "Skin rash- No", "Skin rash- Missing", "Sore throat- Yes", "Sore throat- No", "Sore throat- Missing", "Stroke- Yes", "Stroke- No", "Stroke- Missing", "Upper respiratory tract symptoms- Yes", "Upper respiratory tract symptoms- No", "Upper respiratory tract symptoms- Missing", "Vomiting nausea- Yes", "Vomiting nausea- No", "Vomiting nausea- Missing", "Wheezing- Yes", "Wheezing- No", "Wheezing- Missing", "Pulmonary embolism- Yes", "Pulmonary embolism- No", "Pulmonary embolism- Missing", "Pulmonary embolism or DVT- Yes", "Pulmonary embolism or DVT- No", "Pulmonary embolism or DVT- Missing", "Thromboembolism- Yes", "Thromboembolism- No", "Thromboembolism- Missing", "Symptrcd upper respiratory tract symptoms- Yes", "Symptrcd upper respiratory tract symptoms- No", "Symptrcd upper respiratory tract symptoms- Missing"),2), Frequency_of_comorbidity=c(13,28,114962,    0,3,115000,     1621,22329,91053,    1916,21614,91473,   95,25293,89615,   0,12,114991,   4657,22832,87514,   0,12,114991,   0,12,114991,    48,114,114841,   815,5084,109104,   0,12,114991,    0,12,114991,     17,23,114963,    0,12,114991,    815,24426,89762,     244,26514,88245,     0,12,114991,    1531,10985,102487,    0,12,114991,    19057,12184,83762,     471,25917,88615,    1679,23664,89660,    0,12,114991,     0,34,114969,     4473,23399,87131,      1452,24906,88645,   771,21849,92383,      25,137,114841,     9,897,114097,    2238,23635,89130,                    0,1,16434,   0,0,16435,   91,912,15432,    88,906,15441,   4,835,15596,   0,1,16434,   212,870,15353,      0,1,16434,   0,1,16434,   0,0,16435,    26,251,16158,    0,1,16434,   0,1,16434,     0,1,16434,    0,1,16434,     97,928,15410,     6,874,15555,     0,1,16434,     17,279,16139,     0,1,16434,     536,611,15288,    18,1035,15382,     135,877,15423,      0,1,16434,    1,3,16431,      158,927,15350,      39,1003,15393,     26,1139,15270,     0,0,16435,      2,65,16368,       186,853,15396))
dataforhypertensioncomorbiditybysymptoms2
ggplot(data=dataforhypertensioncomorbiditybysymptoms2, aes(x=Symptoms, y=Frequency_of_comorbidity, fill=Comorbidity)) + geom_bar(stat="identity", position=position_dodge()) + geom_text(aes(label=Frequency_of_comorbidity), hjust=1, angle=90, color="black", position = position_dodge(0.9), size=3) + xlab("Symptoms") + ylab("Frequency of symptoms (pseudo log scale)") + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + theme(axis.text.x = element_text(angle = 90, hjust=1, vjust=0.5, size = 12)) + theme(axis.title.x=element_text(size=15), axis.title.y=element_text(size=15), axis.text.y=element_text(size=10))

#Myocardial infarction- Works
table1(~ symptoms_abdominal_pain + symptoms_acute_kidney_injury + symptoms_altered_consciousness_confusion + symptoms_anorexia + symptoms_apnoea + symptoms_ards + symptoms_asymptomatic + symptoms_atrial_fibrillation + symptoms_bacteraemia + symptoms_bacterial_pneumonia + symptoms_bleeding + symptoms_cardiac_arrest + symptoms_chest_pain + symptoms_chronic_cardiac_disease + symptoms_comorbidities + symptoms_conjunctivitis + symptoms_convulsions + symptoms_cough + symptoms_crepitant + symptoms_diabetic_ketoacidosis + symptoms_diarrhoea + symptoms_disseminated_intravascular_coagulation + symptoms_dizziness + symptoms_ear_pain + symptoms_encephalopathy + symptoms_fatigue_malaise + symptoms_gastrointestinal_bleeding + symptoms_haemoglobinuria + symptoms_headache + symptoms_hematuria + symptoms_history_of_fever + symptoms_hyperglycaemia + symptoms_hypoglycaemia + symptoms_inability_to_walk + symptoms_irritability + symptoms_leukocyturia + symptoms_liver_disease + symptoms_lost_altered_sense_of_smell + symptoms_lost_altered_sense_of_taste + symptoms_lymphadenopathy + symptoms_meningitis_encephalitis + symptoms_mouth_ulcers + symptoms_muscle_aches_joint_pain + symptoms_myocardial_infarction + symptoms_myocarditis + symptoms_nausea + symptoms_other_signs + symptoms_other_signs_and_symptoms + symptoms_pharyngeal_exudate + symptoms_pleural_effusion + symptoms_pneumothorax + symptoms_pretibial_edema_or_limb_peeling + symptoms_proteinuria + symptoms_rhabdomyolysis + symptoms_ronchus + symptoms_runny_nose + symptoms_seizures + symptoms_sepsis + symptoms_severe_dehydration + symptoms_shock + symptoms_shortness_of_breath + symptoms_skin_rash + symptoms_sore_throat + symptoms_strawberry_tongue + symptoms_stroke + symptoms_sub_crepitant + symptoms_transplantation + symptoms_upper_respiratory_tract_symptoms + symptoms_vomiting_nausea + symptoms_wheezing + pulmonary_embolism + pulmonary_embolism_or_dvt + thromboembolsim + symptrcd_upper_respiratory_tract_symptoms | comorbid_myocardial_infarction, data = data)

dataformyocardialinfarctioncomorbiditybysymptoms <- data.frame(Comorbidity=rep(c("Myocardial infarction- Yes"),each=33), Symptoms=rep(c("Altered consciousness confusion- Yes", "Altered consciousness confusion- No", "Altered consciousness confusion- Missing", "Cough- Yes", "Cough- No", "Cough- Missing", "Diarrhoea- Yes", "Diarrhoea- No", "Diarrhoea- Missing", "Encephalopathy- Yes", "Encephalopathy- No", "Encephalopathy- Missing", "Headache- Yes", "Headache- No", "Headache- Missing", "History of fever- Yes", "History of fever- No", "History of fever- Missing", "Lost altered sense of smell- Yes", "Lost altered sense of smell- No", "Lost altered sense of smell- Missing", "Muscle aches joint pain- Yes", "Muscle aches joint pain- No", "Muscle aches joint pain- Missing", "Other signs- Yes", "Other signs- No", "Other signs- Missing", "Shortness of breath- Yes", "Shortness of breath- No", "Shortness of breath- Missing", "Pulmonary embolism or DVT- Yes", "Pulmonary embolism or DVT- No", "Pulmonary embolism or DVT- Missing"),1), Frequency_of_comorbidity=c(0,23,1,7,16,1,3,20,1,0,23,1,4,19,1,18,5,1,0,23,1,6,17,1,6,17,1,18,5,1,3,20,1))
dataformyocardialinfarctioncomorbiditybysymptoms

ggplot(data=dataformyocardialinfarctioncomorbiditybysymptoms, aes(x=Symptoms, y=Frequency_of_comorbidity, fill=Comorbidity)) + geom_bar(stat="identity", position=position_dodge()) + xlab("Symptoms") + ylab("Frequency of symptoms") + theme(axis.title.x=element_text(size=15), axis.title.y=element_text(size=15), axis.text.y=element_text(size=10)) + theme(axis.text.x = element_text(angle = 90, hjust=1, vjust=0.5, size = 12)) + geom_text(aes(label=Frequency_of_comorbidity), vjust=0.4, hjust=1, angle = 90, color="black", size=5)

#Peripheral vascular disease- works
table1(~ symptoms_abdominal_pain + symptoms_acute_kidney_injury + symptoms_altered_consciousness_confusion + symptoms_anorexia + symptoms_apnoea + symptoms_ards + symptoms_asymptomatic + symptoms_atrial_fibrillation + symptoms_bacteraemia + symptoms_bacterial_pneumonia + symptoms_bleeding + symptoms_cardiac_arrest + symptoms_chest_pain + symptoms_chronic_cardiac_disease + symptoms_comorbidities + symptoms_conjunctivitis + symptoms_convulsions + symptoms_cough + symptoms_crepitant + symptoms_diabetic_ketoacidosis + symptoms_diarrhoea + symptoms_disseminated_intravascular_coagulation + symptoms_dizziness + symptoms_ear_pain + symptoms_encephalopathy + symptoms_fatigue_malaise + symptoms_gastrointestinal_bleeding + symptoms_haemoglobinuria + symptoms_headache + symptoms_hematuria + symptoms_history_of_fever + symptoms_hyperglycaemia + symptoms_hypoglycaemia + symptoms_inability_to_walk + symptoms_irritability + symptoms_leukocyturia + symptoms_liver_disease + symptoms_lost_altered_sense_of_smell + symptoms_lost_altered_sense_of_taste + symptoms_lymphadenopathy + symptoms_meningitis_encephalitis + symptoms_mouth_ulcers + symptoms_muscle_aches_joint_pain + symptoms_myocardial_infarction + symptoms_myocarditis + symptoms_nausea + symptoms_other_signs + symptoms_other_signs_and_symptoms + symptoms_pharyngeal_exudate + symptoms_pleural_effusion + symptoms_pneumothorax + symptoms_pretibial_edema_or_limb_peeling + symptoms_proteinuria + symptoms_rhabdomyolysis + symptoms_ronchus + symptoms_runny_nose + symptoms_seizures + symptoms_sepsis + symptoms_severe_dehydration + symptoms_shock + symptoms_shortness_of_breath + symptoms_skin_rash + symptoms_sore_throat + symptoms_strawberry_tongue + symptoms_stroke + symptoms_sub_crepitant + symptoms_transplantation + symptoms_upper_respiratory_tract_symptoms + symptoms_vomiting_nausea + symptoms_wheezing + pulmonary_embolism + pulmonary_embolism_or_dvt + thromboembolsim + symptrcd_upper_respiratory_tract_symptoms | comorbid_peripheral_vascular_disease, data = data)

dataforperipheralvasculardiseasecomorbiditybysymptoms <- data.frame(Comorbidity=rep(c("Peripheral vascular disease- Yes", "Peripheral vascular disease- No"),each=36), Symptoms=rep(c("Altered consciousness confusion- Yes", "Altered consciousness confusion- No", "Altered consciousness confusion- Missing", "Cough- Yes", "Cough- No", "Cough- Missing", "Diarrhoea- Yes", "Diarrhoea- No", "Diarrhoea- Missing", "Encephalopathy- Yes", "Encephalopathy- No", "Encephalopathy- Missing", "Headache- Yes", "Headache- No", "Headache- Missing", "History of fever- Yes", "History of fever- No", "History of fever- Missing", "Lost altered sense of smell- Yes", "Lost altered sense of smell- No", "Lost altered sense of smell- Missing", "Muscle aches joint pain- Yes", "Muscle aches joint pain- No", "Muscle aches, joint pain", "Other signs- Yes", "Other signs- No", "Other signs- Missing", "Severe dehydration- Yes", "Severe dehydration- No", "Severe dehydration- Missing", "Shortness of breath- Yes", "Shortness of breath- No", "Shortness of breath- Missing", "Pulmonary embolism or DVT- Yes", "Pulmonary embolism or DVT- No", "Pulmonary embolism or DVT- Missing"),2), Frequency_of_comorbidity=c(1,6,2,3,4,2,3,4,2,1,6,2,0,7,2,5,2,2,1,6,2,2,5,2,1,6,2,0,1,8,6,1,2,0,7,2,      0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1))
dataforperipheralvasculardiseasecomorbiditybysymptoms
ggplot(data=dataforperipheralvasculardiseasecomorbiditybysymptoms, aes(x=Symptoms, y=Frequency_of_comorbidity, fill=Comorbidity)) +  geom_bar(stat="identity", position=position_dodge()) + xlab("Symptoms") + ylab("Frequency of symptoms") + theme(axis.title.x=element_text(size=15), axis.title.y=element_text(size=15), axis.text.y=element_text(size=10)) + theme(axis.text.x = element_text(angle = 90, hjust=1, vjust=0.5, size = 12)) + geom_text(aes(label=Frequency_of_comorbidity), hjust=1, vjust=0.3, angle = 90, color="black", size=5)
```

#Frequencies of treatments by cardiovascular comorbidities
```{r}
label(data$treat_extracorporeal) <- "Treatment- Extracorporeal"
label(data$treat_high_flow_nasal_cannula) <- "Treatment- High flow nasal cannula"
label(data$treat_inhaled_nitric_oxide) <- "Treatment- Inhaled nitric oxide"
label(data$treat_invasive_ventilation) <- "Treatment- Invasive ventilation"
label(data$treat_mask_oxygen_therapy) <- "Treatment- Mask oxygen therapy"
label(data$treat_nasal_oxygen_therapy) <- "Treatment- Nasal oxygen therapy"
label(data$treat_non_invasive_ventilation) <- "Treatment- Non-invasive ventilation"
label(data$treat_oxy_therapy) <- "Treatment- Oxy therapy"
label(data$treat_respiratory_support) <- "Treatment- Respiratory support"
label(data$treat_tracheostomy) <- "Treatment- Tracheostomy"
label(data$treat_oxygen_therapy) <- "Treatment- Oxygen therapy"
label(data$d1_oxygen_therapy) <- "D1 oxygen therapy"
label(data$ever_icu) <- "Ever ICU"
label(data$icu_treat_extracorporeal) <- "ICU Treatment- Extracorporeal"
label(data$icu_treat_high_flow_nasal_cannula) <- "ICU Treatment- High flow nasal cannula"
label(data$icu_treat_inhaled_nitric_oxide) <- "ICU Treatment- Inhaled nitric oxide"
label(data$icu_treat_non_invasive_ventilation) <- "ICU Treatment- Non-invasive ventilation"
label(data$icu_treat_oxy_therapy) <- "ICU Treatment- Oxy therapy"
label(data$icu_treat_tracheostomy) <- "ICU Treatment- Tracheostomy"
label(data$icu_treat_oxygen_therapy) <- "ICU Treatment- Oxygen therapy"
label(data$dur_imv) <- "Dur IMV"
label(data$dur_niv) <- "Dur NIV"

table1(~ treat_extracorporeal + treat_high_flow_nasal_cannula + treat_inhaled_nitric_oxide + treat_invasive_ventilation + treat_mask_oxygen_therapy + treat_nasal_oxygen_therapy + treat_non_invasive_ventilation + treat_oxy_therapy + treat_respiratory_support + treat_tracheostomy + treat_oxygen_therapy + d1_oxygen_therapy + ever_icu + icu_treat_extracorporeal + icu_treat_high_flow_nasal_cannula + icu_treat_inhaled_nitric_oxide + icu_treat_non_invasive_ventilation + icu_treat_oxy_therapy + icu_treat_tracheostomy + icu_treat_oxygen_therapy + dur_imv + dur_niv | comorbid_cardiac_arrhythmia, data = data, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))

table1(~ treat_extracorporeal + treat_high_flow_nasal_cannula + treat_inhaled_nitric_oxide + treat_invasive_ventilation + treat_mask_oxygen_therapy + treat_nasal_oxygen_therapy + treat_non_invasive_ventilation + treat_oxy_therapy + treat_respiratory_support + treat_tracheostomy + treat_oxygen_therapy + d1_oxygen_therapy + ever_icu + icu_treat_extracorporeal + icu_treat_high_flow_nasal_cannula + icu_treat_inhaled_nitric_oxide + icu_treat_non_invasive_ventilation + icu_treat_oxy_therapy + icu_treat_tracheostomy + icu_treat_oxygen_therapy + dur_imv + dur_niv | comorbid_chronic_cardiac_disease, data = data, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))

table1(~ treat_extracorporeal + treat_high_flow_nasal_cannula + treat_inhaled_nitric_oxide + treat_invasive_ventilation + treat_mask_oxygen_therapy + treat_nasal_oxygen_therapy + treat_non_invasive_ventilation + treat_oxy_therapy + treat_respiratory_support + treat_tracheostomy + treat_oxygen_therapy + d1_oxygen_therapy + ever_icu + icu_treat_extracorporeal + icu_treat_high_flow_nasal_cannula + icu_treat_inhaled_nitric_oxide + icu_treat_non_invasive_ventilation + icu_treat_oxy_therapy + icu_treat_tracheostomy + icu_treat_oxygen_therapy + dur_imv + dur_niv | comorbid_congestive_heart_failure, data = data, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))

table1(~ treat_extracorporeal + treat_high_flow_nasal_cannula + treat_inhaled_nitric_oxide + treat_invasive_ventilation + treat_mask_oxygen_therapy + treat_nasal_oxygen_therapy + treat_non_invasive_ventilation + treat_oxy_therapy + treat_respiratory_support + treat_tracheostomy + treat_oxygen_therapy + d1_oxygen_therapy + ever_icu + icu_treat_extracorporeal + icu_treat_high_flow_nasal_cannula + icu_treat_inhaled_nitric_oxide + icu_treat_non_invasive_ventilation + icu_treat_oxy_therapy + icu_treat_tracheostomy + icu_treat_oxygen_therapy + dur_imv + dur_niv | comorbid_hypertension, data = data, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))

table1(~ treat_extracorporeal + treat_high_flow_nasal_cannula + treat_inhaled_nitric_oxide + treat_invasive_ventilation + treat_mask_oxygen_therapy + treat_nasal_oxygen_therapy + treat_non_invasive_ventilation + treat_oxy_therapy + treat_respiratory_support + treat_tracheostomy + treat_oxygen_therapy + d1_oxygen_therapy + ever_icu + icu_treat_extracorporeal + icu_treat_high_flow_nasal_cannula + icu_treat_inhaled_nitric_oxide + icu_treat_non_invasive_ventilation + icu_treat_oxy_therapy + icu_treat_tracheostomy + icu_treat_oxygen_therapy + dur_imv + dur_niv | comorbid_myocardial_infarction, data = data, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))

table1(~ treat_extracorporeal + treat_high_flow_nasal_cannula + treat_inhaled_nitric_oxide + treat_invasive_ventilation + treat_mask_oxygen_therapy + treat_nasal_oxygen_therapy + treat_non_invasive_ventilation + treat_oxy_therapy + treat_respiratory_support + treat_tracheostomy + treat_oxygen_therapy + d1_oxygen_therapy + ever_icu + icu_treat_extracorporeal + icu_treat_high_flow_nasal_cannula + icu_treat_inhaled_nitric_oxide + icu_treat_non_invasive_ventilation + icu_treat_oxy_therapy + icu_treat_tracheostomy + icu_treat_oxygen_therapy + dur_imv + dur_niv | comorbid_peripheral_vascular_disease, data = data, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))

dataforcomorbiditiesbytreatments <- data.frame(Comorbidity=rep(c("Cardiac arrhythmia- Yes", "Cardiac arrhythmia- No", "Chronic cardiac disease- Yes", "Chronic cardiac disease- No", "Congestive heart failure- Yes", "Hypertension- Yes", "Hypertension- No", "Myocardial infarction- Yes", "Peripheral vascular disease- Yes", "Peripheral vascular disease- No"),each=60), Treatments=rep(c("Extracorporeal- Yes", "Extracorporeal- No", "Extracorporeal- Missing", "High flow nasal cannulua- Yes", "High flow nasal cannula- No", "High flow nasal cannulua- Missing", "Inhaled nitric oxide- Yes", "Inhaled nitric oxide- No", "Inhaled nitric oxide- Missing", "Invasive ventilation- Yes", "Invasive ventilation- No", "Invasive ventilation- Missing", "Mask oxygen therapy- Yes", "Mask oxygen therapy- No", "Mask oxygen therapy- Missing", "Nasal oxygen therapy- Yes", "Nasal oxygen therapy- No", "Nasal oxygen therapy- Missing", "Non-invasive ventilation- Yes", "Non-invasive ventilation- No", "Non-invasive ventilation- Missing", "Oxy therapy- Yes", "Oxy therapy- No", "Oxy therapy- Missing", "Respiratory support- Yes", "Respiratory support- No", "Respiratory support- Missing", "Tracheostomy- Yes", "Tracheostomy- No", "Tracheostomy- Missing", "Oxygen therapy- Yes", "Oxygen therapy- No", "Oxygen therapy- Missing", "D1 oxygen therapy- Yes", "D1 oxygen therapy- No", "D1 oxygen therapy- Missing", "Ever ICU- Yes", "Ever ICU- No", "Ever ICU- Missing", "ICU Extracorporeal- Yes", "ICU Extracorporeal- No", "ICU Extracorporeal- Missing", "ICU High flow nasal cannula- Yes", "ICU High flow nasal cannula- No", "ICU High flow nasal cannula- Missing", "ICU Inhaled nitric oxide- Yes", "ICU Inhaled nitric oxide- No", "ICU Inhaled nitric oxide- Missing", "ICU- Non-invasive ventilation- Yes", "ICU Non-invasive ventilation- No", "ICU- Non-invasive ventilation- Missing", "ICU Oxy therapy- Yes", "ICU Oxy therapy- No", "ICU Oxy therapy- Missing", "ICU Tracheostomy- Yes", "ICU Tracheostomy- No", "ICU Tracheostomy- Missing", "ICU Oxygen therapy- Yes", "ICU Oxygen therapy- No", "ICU Oxygen therapy- Missing"),10), Frequency_of_comorbidity=c(1,19,0, 5,15,0, 1,19,0, 6,14,0, 0,0,20, 0,0,20, 3,17,0, 10,8,2, 0,0,20, 1,19,0, 13,7,0, 5,13,2, 16,2,2, 1,15,4, 5,11,4, 1,15,4, 1,15,4, 0,0,20, 1,15,4, 6,10,4, 0,20,0, 3,16,1, 0,20,0, 1,19,0, 0,0,20, 0,0,20, 1,19,0, 5,14,1, 0,0,20, 0,20,0, 5,15,0, 3,14,3, 11,9,0, 0,10,10, 3,8,9, 0,10,10, 1,9,10, 0,0,20, 0,10,10, 3,8,9, 73,22477,1236, 4400,17473,1913, 89,18228,5469, 2236,20737,813, 1,3,23782, 1,3,23782, 2781,19165,1840, 14263,7999,1524, 758,1352,21676, 346,18156,5284, 15296,7973,517, 4421,12263,7102, 4395,18330,1061, 27,2306,21453, 968,1185,21633, 36,1793,21957, 1131,1294,21361, 1591,394,21801, 166,1688,21932, 2003,514,21269, 31,15286,680, 3599,11255,1143, 11,2068,13918, 1440,13974,583, 0,0,15997, 0,0,15997, 366,4578,11053, 6100,9265,632, 433,2006,13558, 79,2275,13643, 6734,8760,503, 3701,11018,1278, 1769,13640,588, 16,528,15453, 230,291,15476, 5,438,15554, 190,360,15447, 310,98,15589, 45,429,15523, 420,137,15540, 0,3,0, 2,1,0, 0,3,0, 0,3,0, 0,3,0, 3,0,0, 1,2,0, 0,0,3, 0,0,3, 0,3,0, 3,0,0, 0,3,0, 2,1,0, 0,0,3, 0,0,3, 0,0,3, 0,0,3, 0,0,3, 0,0,3, 0,0,3, 354,112035,2614, 27567,81299,6137, 328,32012,82663, 15876,97387,1740, 2,10,114991, 11,1,114991, 7609,61550,45844, 67658,44129,3216, 10105,23376,81522, 1654,32382,80967, 73000,41026,977, 44507,58401,12095, 23812,89284,1907, 162,8744,106097,  3605,3779,107619, 189,6480,108334, 3642,4370,106991, 4852,1255,108896, 733,5901,108369, 6845,2380,105778, 23,15919,493, 3563,11880,992, 13,1270,15152, 1449,14561,425, 0,1,16434, 1,0,16434, 240,5159,11036, 6351,9579,505, 568,3226,12641, 50,1535,14850, 7045,8990,400, 4154,11341,940, 1687,14337,411, 8,379,16048, 147,178,16110, 5,266,16164, 125,240,16070, 182,117,16136, 20,291,16124, 267,121,16047, 0,0,24,    0,0,24,  2,21,1,   4,20,0,  0,0,24,   0,0,24,   4,20,0,    16,8,0,   0,0,24,   0,0,24,   20,4,0,    16,7,1,     23,1,0,    0,0,24,   0,0,24,   0,0,24,    4,11,9,   8,7,9,  0,0,24,  9,6,9, 0,1,8,     0,1,8,     0,8,1,   2,7,0,   0,0,9,   0,0,9,    2,7,0,   5,4,0,  0,0,9,   1,0,8,   7,2,0,   6,2,1,    8,1,0, 0,0,9,  0,0,9,   0,0,9,  2,2,5,   1,3,5,  0,0,9, 3,1,5,   0,1,0,   1,0,0,    0,1,0,   1,0,0,    0,0,1,   0,0,1,   1,0,0,    1,0,0,    0,0,1,  0,1,0,    1,0,0,   1,0,0,   1,0,0,    0,0,1,   0,0,1,   0,0,1,     0,0,1,   0,0,1,   0,0,1,  0,0,1))
dataforcomorbiditiesbytreatments
ggplot(data=dataforcomorbiditiesbytreatments, aes(x=Comorbidity, y=Frequency_of_comorbidity, fill=Comorbidity)) +  geom_bar(stat="identity", position=position_dodge()) + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + geom_text(aes(label=Frequency_of_comorbidity), hjust=1, angle=90, color="black", position = position_dodge(0.9), size=2.5) + xlab("Symptoms") + ylab("Frequency of comorbidity (pseudo log scale)") + theme(axis.text.x = element_text(angle = 90, hjust=1, vjust=0, size = 10)) + facet_wrap(vars(Treatments)) + theme(axis.title.x=element_text(size=15), axis.title.y=element_text(size=15), axis.text.y=element_text(size=5))

ggplot(data=dataforcomorbiditiesbytreatments, aes(x=Treatments, y=Frequency_of_comorbidity, fill=Treatments)) +  geom_bar(stat="identity", position=position_dodge()) + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + geom_text(aes(label=Frequency_of_comorbidity), hjust=1, angle=90, color="black", position = position_dodge(0.9), size=2.5) + xlab("Treatments") + ylab("Frequency of treatment (pseudo log scale)") + theme(axis.text.x = element_text(angle = 90, hjust=1, vjust=0, size = 6)) + facet_wrap(vars(Comorbidity)) + theme(axis.title.x=element_text(size=15), axis.title.y=element_text(size=15), axis.text.y=element_text(size=5)) + theme(legend.position = "none")
```

#Frequencies of complications by cardiovascular comorbidities
```{r}
table1(~ comps_atrial_fibrillation + comps_cardiac_arrest + comps_cardiac_arrhythmia + comps_cardiac_ischaemia + comps_cardiomyopathy + comps_coagulation_disorder + comps_congestive_heart_failure + comps_endocarditis + comps_endocarditis_myocarditis_pericarditis + comps_myocardial_infarction + comps_myocarditis + comps_myocarditis_pericarditis + comps_pericarditis + comps_pleural_effusion + comps_pulmonary_embolism + comps_pulmonary_embolism_or_dvt + comps_stroke + comps_thromboembolic_phenomena + comps_thromboembolsim | comorbid_cardiac_arrhythmia, data = data)

table1(~ comps_atrial_fibrillation + comps_cardiac_arrest + comps_cardiac_arrhythmia + comps_cardiac_ischaemia + comps_cardiomyopathy + comps_coagulation_disorder + comps_congestive_heart_failure + comps_endocarditis + comps_endocarditis_myocarditis_pericarditis + comps_myocardial_infarction + comps_myocarditis + comps_myocarditis_pericarditis + comps_pericarditis + comps_pleural_effusion + comps_pulmonary_embolism + comps_pulmonary_embolism_or_dvt + comps_stroke + comps_thromboembolic_phenomena + comps_thromboembolsim | comorbid_chronic_cardiac_disease, data = data)

table1(~ comps_atrial_fibrillation + comps_cardiac_arrest + comps_cardiac_arrhythmia + comps_cardiac_ischaemia + comps_cardiomyopathy + comps_coagulation_disorder + comps_congestive_heart_failure + comps_endocarditis + comps_endocarditis_myocarditis_pericarditis + comps_myocardial_infarction + comps_myocarditis + comps_myocarditis_pericarditis + comps_pericarditis + comps_pleural_effusion + comps_pulmonary_embolism + comps_pulmonary_embolism_or_dvt + comps_stroke + comps_thromboembolic_phenomena + comps_thromboembolsim | comorbid_congestive_heart_failure, data = data)

table1(~ comps_atrial_fibrillation + comps_cardiac_arrest + comps_cardiac_arrhythmia + comps_cardiac_ischaemia + comps_cardiomyopathy + comps_coagulation_disorder + comps_congestive_heart_failure + comps_endocarditis + comps_endocarditis_myocarditis_pericarditis + comps_myocardial_infarction + comps_myocarditis + comps_myocarditis_pericarditis + comps_pericarditis + comps_pleural_effusion + comps_pulmonary_embolism + comps_pulmonary_embolism_or_dvt + comps_stroke + comps_thromboembolic_phenomena + comps_thromboembolsim | comorbid_hypertension, data = data)

table1(~ comps_atrial_fibrillation + comps_cardiac_arrest + comps_cardiac_arrhythmia + comps_cardiac_ischaemia + comps_cardiomyopathy + comps_coagulation_disorder + comps_congestive_heart_failure + comps_endocarditis + comps_endocarditis_myocarditis_pericarditis + comps_myocardial_infarction + comps_myocarditis + comps_myocarditis_pericarditis + comps_pericarditis + comps_pleural_effusion + comps_pulmonary_embolism + comps_pulmonary_embolism_or_dvt + comps_stroke + comps_thromboembolic_phenomena + comps_thromboembolsim | comorbid_myocardial_infarction, data = data)

table1(~ comps_atrial_fibrillation + comps_cardiac_arrest + comps_cardiac_arrhythmia + comps_cardiac_ischaemia + comps_cardiomyopathy + comps_coagulation_disorder + comps_congestive_heart_failure + comps_endocarditis + comps_endocarditis_myocarditis_pericarditis + comps_myocardial_infarction + comps_myocarditis + comps_myocarditis_pericarditis + comps_pericarditis + comps_pleural_effusion + comps_pulmonary_embolism + comps_pulmonary_embolism_or_dvt + comps_stroke + comps_thromboembolic_phenomena + comps_thromboembolsim | comorbid_peripheral_vascular_disease, data = data)

dataforcomorbiditiesbycomplications <- data.frame(Comorbidity=rep(c("Cardiac arrhythmia- Yes", "Cardiac arrhythmia- No", "Chronic cardiac disease- Yes", "Chronic cardiac disease- No", "Congestive heart failure- Yes", "Hypertension- Yes", "Hypertension- No", "Myocardial infarction- Yes", "Peripheral vascular disease- Yes", "Peripheral vascular disease- No"),each=57), Complication=rep(c("Atrial fibrillation- Yes", "Atrial fibrillation- No", "Atrial fibrillation- Missing", "Cardiac arrest- Yes", "Cardiac arrest- No", "Cardiac arrest- Missing", "Cardiac arrhythmia- Yes", "Cardiac arrhythmia- No", "Cardiac arrhythmia- Missing", "Cardiac ischaemia- Yes", "Cardiac ischaemia- No", "Cardiac ischaemia- Missing", "Cardiomyopathy- Yes", "Cardiomyopathy- No", "Cardiomyopathy- Missing", "Coagulation disorder- Yes", "Coagulation disorder- No", "Coagulation disorder- Missing", "Congestive heart failure- Yes", "Congestive heart failure- No", "Congestive heart failure- Missing", "Endocarditis- Yes", "Endocarditis- No", "Endocarditis- Missing", "Endocarditis, Myocarditis, Pericarditis- Yes", "Endocarditis, Myocarditis, Pericarditis- No", "Endocarditis, Myocarditis, Pericarditis- Missing", "Myocardial infarction- Yes", "Myocardial infarction- No", "Myocardial infarction- Missing", "Myocarditis- Yes", "Myocarditis- No", "Myocarditis- Missing", "Myocarditis, Pericarditis- Yes", "Myocarditis, Pericarditis- No", "Myocarditis, Pericarditis- Missing", "Pericarditis- Yes", "Pericarditis- No", "Pericarditis- Missing", "Pleural effusion- Yes", "Pleural effusion- No", "Pleural effusion- Missing", "Pulmonary embolism- Yes", "Pulmonary embolism- No", "Pulmonary embolism- Missing", "Pulmonary embolism or DVT- Yes", "Pulmonary embolism or DVT- No", "Pulmonary embolism or DVT- Missing", "Stroke- Yes", "Stroke- No", "Stroke- Missing", "Thromboembolic phenomena- Yes", "Thromboembolic phenomena- No", "Thromboembolic phenomena- Missing", "Thromboembolism- Yes", "Thromboembolism- No", "Thromboembolism- Missing"),10), Frequency_of_comorbidity=c(0,0,20, 5,14,1, 0,0,20, 0,0,20, 0,0,20, 1,19,0, 0,17,3, 0,20,0, 0,0,20, 0,14,6, 0,20,0, 0,0,20, 0,20,0, 1,19,0, 0,0,20, 0,0,20, 1,16,3, 0,19,1, 0,0,20, 0,0,20, 1,18,1, 0,0,20, 0,0,20, 0,0,20, 0,19,1, 0,19,1, 0,19,1, 0,0,20, 0,17,3, 0,19,1, 0,0,20, 0,19,1, 0,19,1, 0,0,20, 0,0,20, 0,19,1, 0,19,1, 0,0,20, 0,0,23786, 688,16445,6653, 1897,15285,6604, 471,16487,6828, 163,13228,10395, 736,16453,6597, 1396,15846,6544, 22,2386,21378, 86,15071,8629, 44,1682,22060, 5,300,23481, 68,12956,10762, 1,94,23691, 1264,16058,6464, 253,9709,13824, 35,2285,21466, 360,17017,6409, 5,77,23704, 3,242,23541, 0,0,15997, 34,2182,13781, 49,2113,13835, 9,1920,14068, 5,1599,14393, 48,2205,13744, 6,2257,13734, 4,863,15130, 2,1449,14546, 2,762,15233, 0,115,15882, 7,1334,14656, 0,115,15882, 45,2221,13731, 32,1376,14589, 2,2437,13558, 10,2268,13719, 3,105,15889, 1,50,15946, 0,0,3, 0,3,0, 0,3,0, 0,0,3, 0,3,0, 0,3,0, 0,3,0, 0,3,0, 0,0,3, 0,0,3, 0,3,0, 0,0,3, 0,3,0, 0,3,0, 0,0,3, 0,0,3, 0,3,0, 0,0,3, 0,0,3, 0,0,115003, 1186,30034,83783, 2180,27451,85372, 447,29052,85504, 222,28847,85934, 1287,29397,84319, 1056,29687,84260, 38,9921,105044, 45,21603,93355, 98,8350,106555, 14,750,114239, 153,25237,89613, 0,602,114401, 1644,29232,84127, 771,21849,92383, 76,33567,81360, 587,30328,84088, 16,548,114439, 9,897,114097, 0,0,16435, 24,1406,15005, 23,1431,14981, 2,1303,15130, 4,1184,15247, 28,1494,14913, 4,1521,14910, 1,774,15660, 1,752,15682, 3,742,15690, 0,27,16408, 7,917,15511, 1,26,16408, 26,1500,14909, 26,1139,15270, 0,3794,12641, 5,1522,14908, 2,21,16412, 2,65,16368, 0,0,24, 3,21,0, 0,1,23, 0,0,24, 0,0,24, 0,0,24, 0,1,23, 0,0,24, 0,1,23, 0,0,24, 2,21,1, 0,0,24, 0,0,24, 0,1,23, 0,0,24, 3,20,1, 0,1,23, 0,0,24, 0,0,24, 0,0,9, 0,9,0,  0,2,7, 0,0,9, 0,0,9, 0,1,8, 1,1,7, 0,0,9, 0,2,7, 0,0,9, 0,7,2, 0,0,9, 0,0,9, 1,1,7, 0,0,9, 0,7,2, 0,2,7, 0,0,9, 0,0,9, 0,0,1, 0,0,1, 0,0,1, 0,0,1, 0,0,1, 0,0,1, 0,0,1, 0,0,1, 0,0,1, 0,0,1, 0,0,1, 0,0,1, 0,0,1, 0,0,1, 0,0,1, 0,0,1, 0,0,1, 0,0,1, 0,0,1))
dataforcomorbiditiesbycomplications
ggplot(data=dataforcomorbiditiesbycomplications, aes(x=Comorbidity, y=Frequency_of_comorbidity, fill=Comorbidity)) + geom_bar(stat="identity", position=position_dodge()) + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + geom_text(aes(label=Frequency_of_comorbidity), hjust=1, angle=90, color="black", position = position_dodge(0.9), size=3) + xlab("Complication") + ylab("Frequency of comorbidity (pseudo log scale)") + theme(axis.text.x = element_text(angle = 45, hjust=1, size = 6)) + facet_wrap(vars(Complication)) + ggtitle("Frequencies of the cardiovascular comorbidities by complications") + theme(plot.title=element_text(size=20), axis.title.x=element_text(size=15), axis.title.y=element_text(size=15), axis.text.y=element_text(size=5))

ggplot(data=dataforcomorbiditiesbycomplications, aes(x=Complication, y=Frequency_of_comorbidity, fill=Complication)) + geom_bar(stat="identity", position=position_dodge()) + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + geom_text(aes(label=Frequency_of_comorbidity), hjust=1, angle=90, color="black", position = position_dodge(0.9), size=3) + xlab("Complication") + ylab("Frequency of complication (pseudo log scale)") + theme(axis.text.x = element_text(angle = 90, hjust=1, vjust=0, size = 6)) + facet_wrap(vars(Comorbidity)) + theme(axis.title.x=element_text(size=12), axis.title.y=element_text(size=12), axis.text.y=element_text(size=5)) + theme(legend.position = "none")

ggplot(data=dataforcomorbiditiesbycomplications, aes(x=Complication, y=Frequency_of_comorbidity, fill=Complication)) + geom_bar(stat="identity", position=position_dodge()) + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + geom_text(aes(label=Frequency_of_comorbidity), hjust=1, angle=90, color="black", position = position_dodge(0.9), size=3) + xlab("Complication") + ylab("Frequency of complication (pseudo log scale)") + theme(axis.text.x = element_text(angle = 90, hjust=1, vjust=0, size = 6)) + facet_wrap(vars(Comorbidity)) + theme(axis.title.x=element_text(size=12), axis.title.y=element_text(size=12), axis.text.y=element_text(size=5))
```

#Outcomes of patients with CVD comorbidities by age, sex and over time
```{r}
table1(~ comorbid_cardiac_arrhythmia + comorbid_chronic_cardiac_disease + comorbid_congestive_heart_failure + comorbid_hypertension + comorbid_myocardial_infarction + comorbid_peripheral_vascular_disease | outcome, data = data)
table1(~ outcome | comorbid_cardiac_arrhythmia, data=data)
table1(~ outcome | comorbid_chronic_cardiac_disease, data=data)
table1(~ outcome | comorbid_congestive_heart_failure, data=data)
table1(~ outcome | comorbid_hypertension, data=data)
table1(~ outcome | comorbid_myocardial_infarction, data=data)
table1(~ outcome | comorbid_peripheral_vascular_disease, data=data)

table1(~ comorbid_cardiac_arrhythmia + comorbid_chronic_cardiac_disease + comorbid_congestive_heart_failure + comorbid_hypertension + comorbid_myocardial_infarction + comorbid_peripheral_vascular_disease | sex*outcome, data = data)
table1(~ outcome | comorbid_cardiac_arrhythmia*sex, data = data)
table1(~ outcome | comorbid_chronic_cardiac_disease*sex, data = data)
table1(~ outcome | comorbid_congestive_heart_failure*sex, data = data)
table1(~ outcome | comorbid_hypertension*sex, data = data)
table1(~ outcome | comorbid_myocardial_infarction*sex, data = data)
table1(~ outcome | comorbid_peripheral_vascular_disease*sex, data = data)

AGE<-data$age
summary(AGE)
hist(AGE)
AGEgrp<-cut(AGE,c(0,10,20,30,40,50,60,70,80,90,100,120), labels=c("0-9","10-19","20-29","30-39","40-49","50-59","60-69","70-79","80-89","90-99","100+"))
table1(~ AGEgrp, data=data)
table1(~ outcome | comorbid_cardiac_arrhythmia*AGEgrp, data = data)
table1(~ outcome | comorbid_chronic_cardiac_disease*AGEgrp, data = data)
table1(~ outcome | comorbid_congestive_heart_failure*AGEgrp, data = data)
table1(~ outcome | comorbid_hypertension*AGEgrp, data = data)
table1(~ outcome | comorbid_myocardial_infarction*AGEgrp, data = data)
table1(~ outcome | comorbid_peripheral_vascular_disease*AGEgrp, data = data)
dsstdyA<-data$dsstdy
summary(dsstdyA)
hist(dsstdyA)
dsstdyAgrp<-cut(dsstdyA,c(-70000,-60000,-10000,0,10,20,30,40,50,60,70,80,90,100,20000,40000),labels=c("-70000 - -60001","-60000 - -10001","-10000 - -1", "0-9","10-19","20-29","30-39","40-49","50-59","60-69","70-79","80-89","90-99","100-19999","20000+"))
table1(~ comorbid_cardiac_arrhythmia + comorbid_chronic_cardiac_disease + comorbid_congestive_heart_failure + comorbid_hypertension + comorbid_myocardial_infarction + comorbid_peripheral_vascular_disease | dsstdyAgrp*outcome, data = data)
table1(~ dsstdyAgrp, data=data)
#dsstdy is the number of days since admission for the start date of the outcome. For outcomes such as discharge from hospital or transfer this is often the same as dsdy and the outcome date is the date of data capture (date of discharge). For outcomes such as death dsstdy is the number of days since admission that death was reported.
#dsstdy is the right one to use, need to get rid of the negative values and of the values that are too large
#have 800 as the max?
#number of days since admission for the start date of the outcome
relevantdsstdydata<-filter(data, dsstdy>=0 & dsstdy<=800)
relevantdsstdydata
relevantdsstdydataA<-relevantdsstdydata$dsstdy
summary(relevantdsstdydataA)
hist(relevantdsstdydataA)
relevantdsstdydataAgrp<-cut(relevantdsstdydataA,c(0,10,20,30,40,50,60,70,80,90,100,200,300,400,800),labels=c("0-9","10-19","20-29","30-39","40-49","50-59","60-69","70-79","80-89",   "90-99","100-199","200-299","300-399","400-800"))
table1(~ relevantdsstdydataAgrp, data=relevantdsstdydata)
table1(~ comorbid_cardiac_arrhythmia + comorbid_chronic_cardiac_disease + comorbid_congestive_heart_failure + comorbid_hypertension + comorbid_myocardial_infarction + comorbid_peripheral_vascular_disease | relevantdsstdydataAgrp, data = relevantdsstdydata)
table1(~ comorbid_cardiac_arrhythmia + comorbid_chronic_cardiac_disease + comorbid_congestive_heart_failure + comorbid_hypertension + comorbid_myocardial_infarction + comorbid_peripheral_vascular_disease | relevantdsstdydataAgrp*outcome, data = relevantdsstdydata)
table1(~ outcome | comorbid_cardiac_arrhythmia*relevantdsstdydataAgrp, data = relevantdsstdydata)
table1(~ outcome | comorbid_chronic_cardiac_disease*relevantdsstdydataAgrp, data = relevantdsstdydata)
table1(~ outcome | comorbid_congestive_heart_failure*relevantdsstdydataAgrp, data = relevantdsstdydata) #no data for congestive heart failure here
table1(~ outcome | comorbid_hypertension*relevantdsstdydataAgrp, data = relevantdsstdydata)
table1(~ outcome | comorbid_myocardial_infarction*relevantdsstdydataAgrp, data = relevantdsstdydata)
table1(~ outcome | comorbid_peripheral_vascular_disease*relevantdsstdydataAgrp, data = relevantdsstdydata)
```

#Cox for death
```{r}
datafordeath <- data[data$outcome %in% c("death"),] 
#I think this is the data for the people with the outcome of death
died <- gsub("death", "1", datafordeath$outcome)
diednumeric <- as.numeric(died)
diednumeric
class(diednumeric)
install.packages(c("survival", "survminer","ggplot2","rlang"))
library("survival","survminer","ggplot2","rlang")

#Cardiac arrhythmia- error
coxph(Surv(dsstdy, diednumeric) ~ comorbid_cardiac_arrhythmia + sex + age + I(age^2) + strata(country), data = datafordeath)
#Chronic cardiac disease- stat sig, don't think Schoenfeld holds
coxph(Surv(dsstdy, diednumeric) ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2) + strata(country), data = datafordeath)
summary(coxph(Surv(dsstdy, diednumeric) ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2) + strata(country), data = datafordeath))
cox.zph(coxph(Surv(dsstdy, diednumeric) ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2) + strata(country), data = datafordeath))
#Congestive heart failure- error 
coxph(Surv(dsstdy, diednumeric) ~ comorbid_congestive_heart_failure + sex + age + I(age^2) + strata(country), data = datafordeath)
#Hypertension- stat sig, Schoenfeld doesn't hold
coxph(Surv(dsstdy, diednumeric) ~ comorbid_hypertension + sex + age + I(age^2) + strata(country), data = datafordeath)
summary(coxph(Surv(dsstdy, diednumeric) ~ comorbid_hypertension + sex + age + I(age^2) + strata(country), data = datafordeath))
cox.zph(coxph(Surv(dsstdy, diednumeric) ~ comorbid_hypertension + sex + age + I(age^2) + strata(country), data = datafordeath))
#Myocardial infarction- error
coxph(Surv(dsstdy, diednumeric) ~ comorbid_myocardial_infarction + sex + age + I(age^2) + strata(country), data = datafordeath)
#Peripheral vascular disease- NA and error
coxph(Surv(dsstdy, diednumeric) ~ comorbid_peripheral_vascular_disease + sex + age + I(age^2) + strata(country), data = datafordeath)
summary(coxph(Surv(dsstdy, diednumeric) ~ comorbid_peripheral_vascular_disease + sex + age + I(age^2) + strata(country), data = datafordeath))
cox.zph(coxph(Surv(dsstdy, diednumeric) ~ comorbid_peripheral_vascular_disease + sex + age + I(age^2) + strata(country), data = datafordeath))
#Graph for Cox for death
ComorbidityDeath <- c("Chronic cardiac disease", "Hypertension")
HRDeath <- c(1.18, 1.24)
Lower95Death <- c(1.10, 1.19)
Upper95Death <- c(1.26, 1.29)
HRdatadeath <- data.frame(ComorbidityDeath, HRDeath, Lower95Death, Upper95Death)
HRdatadeath
ggplot(HRdatadeath, aes(ComorbidityDeath,HRDeath)) + geom_point() + geom_errorbar(aes(ymin = Lower95Death, ymax = Upper95Death)) + xlab("Comorbidity") + ylab("HR (95% CI)") + theme(axis.text.x = element_text(size=25)) + theme(axis.title.x=element_text(size=25), axis.title.y=element_text(size=25), axis.text.y=element_text(size=25))
```

#Cox for IMV
```{r}
#Cardiac arrhythmia- error
coxph(Surv(dur_imv, treat_invasive_ventilation) ~ comorbid_cardiac_arrhythmia + sex + age + I(age^2) + strata(country), data = data)
#Chronic cardiac disease- not stat sig, Schoenfeld residual holds
coxph(Surv(dur_imv, treat_invasive_ventilation) ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2) + strata(country), data = data)
summary(coxph(Surv(dur_imv, treat_invasive_ventilation) ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2) + strata(country), data = data))
cox.zph(coxph(Surv(dur_imv, treat_invasive_ventilation) ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2) + strata(country), data = data))
#Congestive heart failure- error
coxph(Surv(dur_imv, treat_invasive_ventilation) ~ comorbid_congestive_heart_failure + sex + age + I(age^2) + strata(country), data = data)
#Hypertension- not stat sig, Schoenfeld holds
coxph(Surv(dur_imv, treat_invasive_ventilation) ~ comorbid_hypertension + sex + age + I(age^2) + strata(country), data = data)
summary(coxph(Surv(dur_imv, treat_invasive_ventilation) ~ comorbid_hypertension + sex + age + I(age^2) + strata(country), data = data))
cox.zph(coxph(Surv(dur_imv, treat_invasive_ventilation) ~ comorbid_hypertension + sex + age + I(age^2) + strata(country), data = data))
#Myocardial infarction- error
coxph(Surv(dur_imv, treat_invasive_ventilation) ~ comorbid_myocardial_infarction + sex + age + I(age^2) + strata(country), data = data)
#Peripheral vascular disease- error
coxph(Surv(dur_imv, treat_invasive_ventilation) ~ comorbid_peripheral_vascular_disease + sex + age + I(age^2) + strata(country), data = data)
#Graph for Cox for IMV
ComorbidityIMV <- c("Chronic cardiac disease", "Hypertension")
HRIMV <- c(1.02, 1.01)
Lower95IMV <- c(0.90, 0.91)
Upper95IMV <- c(1.15, 1.13)
HRdataIMV <- data.frame(ComorbidityIMV, HRIMV, Lower95IMV, Upper95IMV)
HRdataIMV
ggplot(HRdataIMV, aes(ComorbidityIMV,HRIMV)) + geom_point() + geom_errorbar(aes(ymin = Lower95IMV, ymax = Upper95IMV)) + xlab("Comorbidity") + ylab("HR (95% CI)") + theme(axis.text.x = element_text(size=25)) +  theme(axis.title.x=element_text(size=25), axis.title.y=element_text(size=25), axis.text.y=element_text(size=25))
```

#ICU logistic regression
```{r}
#Cardiac arrhythmia- stat sig, ANOVA sig
glm(ever_icu ~ comorbid_cardiac_arrhythmia + sex + age + I(age^2), data=data, family="binomial")
summary(glm(ever_icu ~ comorbid_cardiac_arrhythmia + sex + age + I(age^2), data=data, family="binomial"))
anova(glm(ever_icu ~ comorbid_cardiac_arrhythmia + sex + age + I(age^2), data=data, family="binomial"), test="Chisq")
exp(cbind(OR = coef(glm(ever_icu ~ comorbid_cardiac_arrhythmia + sex + age + I(age^2), data=data, family="binomial")), confint(glm(ever_icu ~ comorbid_cardiac_arrhythmia + sex + age + I(age^2), data=data, family="binomial"))))
#Chronic cardiac disease- stat sig, ANOVA sig
glm(ever_icu ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial")
summary(glm(ever_icu ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"))
anova(glm(ever_icu ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"), test="Chisq")
exp(cbind(OR = coef(glm(ever_icu ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial")), confint(glm(ever_icu ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"))))
#Congestive heart failure- error
glm(ever_icu ~ comorbid_congestive_heart_failure + sex + age + I(age^2), data=data, family="binomial")
#Hypertension- stat sig, ANOVA sig
glm(ever_icu ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial")
summary(glm(ever_icu ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial"))
anova(glm(ever_icu ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial"), test="Chisq")
exp(cbind(OR = coef(glm(ever_icu ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial")), confint(glm(ever_icu ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial"))))
#Myocardial infarction- NA
glm(ever_icu ~ comorbid_myocardial_infarction + sex + age + I(age^2), data=data, family="binomial")
#Peripheral vascular disease- error
glm(ever_icu ~ comorbid_peripheral_vascular_disease + sex + age + I(age^2), data=data, family="binomial")
#Graph for ICU logistic regression
#Cardiac arrhythmia
Comorbidity2Cardiacarrhythmia <- c("Cardiac arrhythmia")
ORCardiacarrhythmia <- c(27.4)
LowerCICardiacarrhythmia <- c(1.74)
UpperCICardiacarrhythmia <- c(1480)
ORICUdatacardiacarrhythmia <- data.frame(Comorbidity2Cardiacarrhythmia, ORCardiacarrhythmia, LowerCICardiacarrhythmia, UpperCICardiacarrhythmia)
ORICUdatacardiacarrhythmia
ggplot(ORICUdatacardiacarrhythmia, aes(Comorbidity2Cardiacarrhythmia, ORCardiacarrhythmia, label=ORCardiacarrhythmia)) + geom_point() + geom_errorbar(aes(ymin = LowerCICardiacarrhythmia, ymax = UpperCICardiacarrhythmia)) + xlab("Comorbidity") + ylab("OR (95% CI)") + theme(axis.text.x = element_text(size=25)) + theme(axis.title.x=element_text(size=25), axis.title.y=element_text(size=25), axis.text.y=element_text(size=25))
#Chronic cardiac disease and hypertension
Comorbidity2 <- c("Chronic cardiac disease", "Hypertension")
OR <- c(3.21, 2.03)
LowerCI <- c(2.98, 1.92)
UpperCI <- c(3.46, 2.15)
ORICUdata <- data.frame(Comorbidity2, OR, LowerCI, UpperCI)
ORICUdata
ggplot(ORICUdata, aes(Comorbidity2, OR)) + geom_point() + geom_errorbar(aes(ymin = LowerCI, ymax = UpperCI)) +
xlab("Comorbidity") + ylab("OR (95% CI)") + theme(axis.text.x = element_text(size=25)) + theme(axis.title.x=element_text(size=25), axis.title.y=element_text(size=25), axis.text.y=element_text(size=25))
```

#Case fatalitity ratio
```{r}
#Think about whether need to calculate for 'missing'
summary(data)
#800459 reported cases in this data set
table(data$outcome, useNA = "ifany")
#Overall 163388 with outcome as death
(163388/800459)*100
#Overall case fatality ratio for the data set is 20.41179

#Comorbid- cardiac arrhythmia
table(data$comorbid_cardiac_arrhythmia)
#20 people TRUE, 20 people FALSE
#Data for those who do have comorbid- cardiac arrhythmia
dataforcomorbidcardiacarrhythmia <- data[data$comorbid_cardiac_arrhythmia %in% c("TRUE"),]
table(dataforcomorbidcardiacarrhythmia$outcome, useNA = "ifany")
#5 of the people with comorbid- cardiac arrhythmia TRUE died
(5/20)*100
#Case fatality ratio for those with comorbid- cardiac arrhythmia TRUE is 25
#Data for those who do not have comorbid- cardiac arrhythmia
datafornocomorbidcardiacarrhythmia <- data[data$comorbid_cardiac_arrhythmia %in% c("FALSE"),]
table(datafornocomorbidcardiacarrhythmia$outcome, useNA = "ifany")
#1 of the people with comorbid- cardiac arrhythmia FALSE died
(1/20)*100
#Case fatality ratio for those with comorbid- cardiac arrhythmia FALSE is 5

#Comorbid- chronic cardiac disease
table(data$comorbid_chronic_cardiac_disease)
#23786 TRUE, 15997 FALSE
#Data for those who do have comorbid- chronic cardiac disease
dataforcomorbidchroniccardiacdisease <- data[data$comorbid_chronic_cardiac_disease %in% c("TRUE"),]
table(dataforcomorbidchroniccardiacdisease$outcome, useNA = "ifany")
#7429 of the 23786 people with comorbid- chronic cardiac disease TRUE died
(7429/23786)*100
#Case fatality ratio for those with comorbid- chronic cardiac disease TRUE is 31.23266
#Data for those who do not have comorbid- chronic cardiac disease
datafornocomorbidchroniccardiacdisease <- data[data$comorbid_chronic_cardiac_disease %in% c("FALSE"),]
table(datafornocomorbidchroniccardiacdisease$outcome, useNA = "ifany")
#2321 of the 15997 people with comorbid- chronic cardiac disease FALSE died
(2321/15997)*100
#Case fatality ratio for those with comorbid- chronic cardiac disease FALSE is 14.50897

#Comorbid- congestive heart failure
table(data$comorbid_congestive_heart_failure)
#3 people recorded as TRUE
#Data for those who do have comorbid- congestive heart failure
dataforcomorbidcongestiveheartfailure <- data[data$comorbid_congestive_heart_failure %in% c("TRUE"),]
table(dataforcomorbidcongestiveheartfailure$outcome, useNA = "ifany")
#2 of the 3 people with comorbid- congestive heart failure TRUE died
(2/3)*100
#Case fatality ratio for those with comorbid- congestive heart failure TRUE is 66.66667

#Comorbid- hypertension
table(data$comorbid_hypertension)
#115003 TRUE, 16435 FALSE
#Data for those who do have comorbid- hypertension
dataforcomorbidhypertension <- data[data$comorbid_hypertension %in% c("TRUE"),]
table(dataforcomorbidhypertension$outcome, useNA = "ifany")
#31314 of the 115003 people with comorbid- hypertension TRUE died
(31314/115003)*100
#Case fatality ratio for those with comorbid- hypertension TRUE is 27.22885
#Data for those who do not have comorbid- hypertension
datafornocomorbidhypertension <- data[data$comorbid_hypertension %in% c("FALSE"),]
table(datafornocomorbidhypertension$outcome, useNA = "ifany")
#2525 of the 16435 people with comorbid- hypertension FALSE died
(2525/16435)*100
#Case fatality ratio for those with comorbid- hypertension FALSE is 15.36355

#Comorbid- myocardial infarction
table(data$comorbid_myocardial_infarction)
#24 people were recorded with comorbid myocardial infarction as true
#Data for those who do have comorbid- myocardial infarction 
dataforcomorbidmyocardialinfarction <- data[data$comorbid_myocardial_infarction %in% c("TRUE"),]
table(dataforcomorbidmyocardialinfarction$outcome, useNA = "ifany")
#5 of the 24 people with comorbid- myocardial infarction recorded as true died
(5/24)*100
#Case fatality ratio for those with comorbid- myocardial infarction recorded as true is 20.83333

#Comorbid- peripheral vascular disease
table(data$comorbid_peripheral_vascular_disease)
#9 people recorded as true, 1 person recorded as false
#Data for those who do have comorbid- peripheral vascular disease
dataforcomorbidperipheralvasculardisease <- data[data$comorbid_peripheral_vascular_disease %in% c("TRUE"),]
table(dataforcomorbidperipheralvasculardisease$outcome, useNA = "ifany")
#2 people of the 9 people recorded as comorbid- peripheral vascular disease TRUE died
(2/9)*100
#Case fatality ratio for those with comorbid- peripheral vascular disease TRUE is 22.22222
#Data for those who do not have comorbid- peripheral vascular disease
datafornocomorbidperipheralvasculardisease <- data[data$comorbid_peripheral_vascular_disease %in% c("FALSE"),]
table(datafornocomorbidperipheralvasculardisease$outcome, useNA = "ifany")
(0/1)*100
#Case fatality ratio for those with comorbid- peripheral vascular disease FALSE is 0

#plotting the case fatality ratio results
Status <- c("Overall", "Cardiac arrhythmia- Yes", "Cardiac arrhythmia- No", "Chronic cardiac disease- Yes", "Chronic cardiac disease- No", "Congestive heart failure- Yes", "Hypertension- Yes", "Hypertension- No", "Myocardial infarction- Yes", "Peripheral vascular disease- Yes", "Peripheral vascular disease- No")
CFR <- c(20.41, 25, 5, 31.23, 14.51, 66.67, 27.23, 15.36, 20.83, 22.22, 0)
LowerSE <- c(20.365, 15.32, 0.13, 30.93, 14.23, 39.45, 27.1, 15.08, 12.54, 8.36, 0)
UpperSE <- c(20.455, 34.68, 9.87, 31.53, 14.79, 93.89, 27.36, 15.64, 29.12, 36.08, 0)
CFRdata <- data.frame(Status, CFR, LowerSE, UpperSE)
CFRdata
ggplot(CFRdata, aes(Status, CFR)) + geom_point() + geom_point() + geom_errorbar(aes(ymin = LowerSE, ymax = UpperSE)) + xlab("Comorbidity") + ylab("Case fatality ratio (Standard Error)") + theme(axis.text.x = element_text(size=17, angle=90, hjust=1, vjust=0.5)) + theme(axis.title.x=element_text(size=17), axis.title.y=element_text(size=17), axis.text.y=element_text(size=17))
```

#Risk of cardiovascular complications overall and by CVD status
```{r}
#Complication atrial fibrillation- all error

#Complication- cardiac arrest
#Comorbidity cardiac arrhythmia
glm(comps_cardiac_arrest ~ comorbid_cardiac_arrhythmia + sex + age + I(age^2), data=data, family="binomial")
summary(glm(comps_cardiac_arrest ~ comorbid_cardiac_arrhythmia + sex + age + I(age^2), data=data, family="binomial"))
anova(glm(comps_cardiac_arrest ~ comorbid_cardiac_arrhythmia + sex + age + I(age^2), data=data, family="binomial"), test="Chisq")
exp(cbind(OR = coef(glm(comps_cardiac_arrest ~ comorbid_cardiac_arrhythmia + sex + age + I(age^2), data=data, family="binomial")), confint(glm(comps_cardiac_arrest ~ comorbid_cardiac_arrhythmia + sex + age + I(age^2), data=data, family="binomial"))))
#Comorbidity chronic cardiac disease
glm(comps_cardiac_arrest ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial")
summary(glm(comps_cardiac_arrest ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"))
anova(glm(comps_cardiac_arrest ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"), test="Chisq")
exp(cbind(OR = coef(glm(comps_cardiac_arrest ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial")), confint(glm(comps_cardiac_arrest ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"))))
#Comorbidity congestive heart failure- error
#Comorbidity hypertension
glm(comps_cardiac_arrest ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial")
summary(glm(comps_cardiac_arrest ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial"))
anova(glm(comps_cardiac_arrest ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial"), test="Chisq")
exp(cbind(OR = coef(glm(comps_cardiac_arrest ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial")), confint(glm(comps_cardiac_arrest ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial"))))
#Comorbidity myocardial infarction- NA
#Comorbidity peripheral vascular disease- NA

#Complication cardiac arrhythmia
#Comorbidity cardiac arrhythmia- error
#Comorbidity chronic cardiac disease
glm(comps_cardiac_arrhythmia ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial")
summary(glm(comps_cardiac_arrhythmia ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"))
anova(glm(comps_cardiac_arrhythmia ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"), test="Chisq")
exp(cbind(OR = coef(glm(comps_cardiac_arrhythmia ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial")), confint(glm(comps_cardiac_arrhythmia ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"))))
#Comorbidity congestive heart failure- error
#Comorbidity hypertension
glm(comps_cardiac_arrhythmia ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial")
summary(glm(comps_cardiac_arrhythmia ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial"))
anova(glm(comps_cardiac_arrhythmia ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial"), test="Chisq")
exp(cbind(OR = coef(glm(comps_cardiac_arrhythmia ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial")), confint(glm(comps_cardiac_arrhythmia ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial"))))
#Comorbidity myocardial infarction- error
#Comorbidity peripheral vascular disease- NA

#Complication cardiac ischaemia
#Comorbidity cardiac arrhythmia- error
#Comorbidity chronic cardiac disease
glm(comps_cardiac_ischaemia ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial")
summary(glm(comps_cardiac_ischaemia ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"))
anova(glm(comps_cardiac_ischaemia ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"), test="Chisq")
exp(cbind(OR = coef(glm(comps_cardiac_ischaemia ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial")), confint(glm(comps_cardiac_ischaemia ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"))))
#Comorbidity congestive heart failure- error
#Comorbidity hypertension
glm(comps_cardiac_ischaemia ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial")
summary(glm(comps_cardiac_ischaemia ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial"))
anova(glm(comps_cardiac_ischaemia ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial"), test="Chisq")
exp(cbind(OR = coef(glm(comps_cardiac_ischaemia ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial")), confint(glm(comps_cardiac_ischaemia ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial"))))
#Comorbidity myocardial infarction- error
#Comorbidity peripheral vascular disease- error

#Complication cardiomyopathy
#Comorbidity cardiac arrhythmia- error
#Comorbidity chronic cardiac disease
glm(comps_cardiomyopathy ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial")
summary(glm(comps_cardiomyopathy ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"))
anova(glm(comps_cardiomyopathy ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"), test="Chisq")
exp(cbind(OR = coef(glm(comps_cardiomyopathy ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial")), confint(glm(comps_cardiomyopathy ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"))))
#Comorbidity congestive heart failure- error
#Comorbidity hypertension
glm(comps_cardiomyopathy ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial")
summary(glm(comps_cardiomyopathy ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial"))
anova(glm(comps_cardiomyopathy ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial"), test="Chisq")
exp(cbind(OR = coef(glm(comps_cardiomyopathy ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial")), confint(glm(comps_cardiomyopathy ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial"))))
#Comorbidity myocardial infarction- error
#Comorbidity peripheral vascular disease- error

#Complication coagulation disorder
#Comorbidity cardiac arrhythmia- NA
#Comorbidity chronic cardiac disease
glm(comps_coagulation_disorder ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial")
summary(glm(comps_coagulation_disorder ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"))
anova(glm(comps_coagulation_disorder ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"), test="Chisq")
exp(cbind(OR = coef(glm(comps_coagulation_disorder ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial")), confint(glm(comps_coagulation_disorder ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"))))
#Comorbidity congestive heart failure- error
#Comorbidity hypertension
glm(comps_coagulation_disorder ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial")
summary(glm(comps_coagulation_disorder ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial"))
anova(glm(comps_coagulation_disorder ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial"), test="Chisq")
exp(cbind(OR = coef(glm(comps_coagulation_disorder ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial")), confint(glm(comps_coagulation_disorder ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial"))))
#Comorbidity myocardial infarction- error
#Comorbidity peripheral vascular disease- error

#Complication congestive heart failure
#Comorbidity cardiac arrhythmia- NA
#Comorbidity chronic cardiac disease
glm(comps_congestive_heart_failure ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial")
summary(glm(comps_congestive_heart_failure ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"))
anova(glm(comps_congestive_heart_failure ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"), test="Chisq")
exp(cbind(OR = coef(glm(comps_congestive_heart_failure ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial")), confint(glm(comps_congestive_heart_failure ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"))))
#Comorbidity congestive heart failure- error
#Comorbidity hypertension
glm(comps_congestive_heart_failure ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial")
summary(glm(comps_congestive_heart_failure ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial"))
anova(glm(comps_congestive_heart_failure ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial"), test="Chisq")
exp(cbind(OR = coef(glm(comps_congestive_heart_failure ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial")), confint(glm(comps_congestive_heart_failure ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial"))))
#Comorbidity myocardial infarction- error
#Comorbidity peripheral vascular disease- NA

#Complication endocarditis
#Comorbidity cardiac arrhythmia- NA
#Comorbidity chronic cardiac disease
glm(comps_endocarditis ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial")
summary(glm(comps_endocarditis ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"))
anova(glm(comps_endocarditis ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"), test="Chisq")
exp(cbind(OR = coef(glm(comps_endocarditis ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial")), confint(glm(comps_endocarditis ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"))))
#Comorbidity congestive heart failure- error
#Comorbidity hypertension- warning
#Comorbidity myocardial infarction- error
#Comorbidity peripheral vascular disease- error

#Complication endocarditis myocarditis pericarditis
#Comorbidity cardiac arrhythmia- error
#Comorbidity chronic cardiac disease
glm(comps_endocarditis_myocarditis_pericarditis ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial")
summary(glm(comps_endocarditis_myocarditis_pericarditis ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"))
anova(glm(comps_endocarditis_myocarditis_pericarditis ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"), test="Chisq")
exp(cbind(OR = coef(glm(comps_endocarditis_myocarditis_pericarditis ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial")), confint(glm(comps_endocarditis_myocarditis_pericarditis ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"))))
#Comorbidity congestive heart failure- error
#Comorbidity hypertension
glm(comps_endocarditis_myocarditis_pericarditis ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial")
summary(glm(comps_endocarditis_myocarditis_pericarditis ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial"))
anova(glm(comps_endocarditis_myocarditis_pericarditis ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial"), test="Chisq")
exp(cbind(OR = coef(glm(comps_endocarditis_myocarditis_pericarditis ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial")), confint(glm(comps_endocarditis_myocarditis_pericarditis ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial"))))
#Comorbidity myocardial infarction- error
#Comorbidity peripheral vascular disease- NA

#Complication myocardial infarction
#Comorbidity cardiac arrhythmia- NA
#Comorbidity chronic cardiac disease
glm(comps_myocardial_infarction ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial")
summary(glm(comps_myocardial_infarction ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"))
anova(glm(comps_myocardial_infarction ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"), test="Chisq")
exp(cbind(OR = coef(glm(comps_myocardial_infarction ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial")), confint(glm(comps_myocardial_infarction ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"))))
#Comorbidity congestive heart failure- error
#Comorbidity hypertension
glm(comps_myocardial_infarction ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial")
summary(glm(comps_myocardial_infarction ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial"))
anova(glm(comps_myocardial_infarction ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial"), test="Chisq")
exp(cbind(OR = coef(glm(comps_myocardial_infarction ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial")), confint(glm(comps_myocardial_infarction ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial"))))
#Comorbidity myocardial infarction- error
#Comorbidity peripheral vascular disease- error

#Complication myocarditis
#Comorbidity cardiac arrhythmia- NA
#Comorbidity chronic cardiac disease- warning + NA
#Comorbidity congestive heart failure- error
#Comorbidity hypertension- warning + NA
#Comorbidity myocardial infarction- NA
#Comorbidity peripheral vascular disease- NA

#Complication myocarditis pericarditis
#Comorbidity cardiac arrhythmia- error
#Comorbidity chronic cardiac disease
glm(comps_myocarditis_pericarditis ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial")
summary(glm(comps_myocarditis_pericarditis ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"))
anova(glm(comps_myocarditis_pericarditis ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"), test="Chisq")
exp(cbind(OR = coef(glm(comps_myocarditis_pericarditis ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial")), confint(glm(comps_myocarditis_pericarditis ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"))))
#Comorbidity congestive heart failure- error
#Comorbidity hypertension
glm(comps_myocarditis_pericarditis ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial")
summary(glm(comps_myocarditis_pericarditis ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial"))
anova(glm(comps_myocarditis_pericarditis ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial"), test="Chisq")
exp(cbind(OR = coef(glm(comps_myocarditis_pericarditis ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial")), confint(glm(comps_myocarditis_pericarditis ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial"))))
#Comorbidity myocardial infarction- error
#Comorbidity peripheral vascular disease- error

#Complication pericarditis
#Comorbidity cardiac arrhythmia- NA
#Comorbidity chronic cardiac disease- NA + warning
#Comorbidity congestive heart failure- error
#Comorbidity hypertension- Inf + warning
#Comorbidity myocardial infarction- error
#Comorbidity peripheral vascular disease- error

#Complication pleural effusion
#Comorbidity cardiac arrhythmia- Warning + inf
#Comorbidity chronic cardiac disease
glm(comps_pleural_effusion ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial")
summary(glm(comps_pleural_effusion ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"))
anova(glm(comps_pleural_effusion ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"), test="Chisq")
exp(cbind(OR = coef(glm(comps_pleural_effusion ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial")), confint(glm(comps_pleural_effusion ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"))))
#Comorbidity congestive heart failure- error
#Comorbidity hypertension
glm(comps_pleural_effusion ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial")
summary(glm(comps_pleural_effusion ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial"))
anova(glm(comps_pleural_effusion ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial"), test="Chisq")
exp(cbind(OR = coef(glm(comps_pleural_effusion ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial")), confint(glm(comps_pleural_effusion ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial"))))
#Comorbidity myocardial infarction- error
#Comorbidity peripheral vascular disease- NA

#Complication pulmonary embolism
#Comorbidity cardiac arrhythmia- error
#Comorbidity chronic cardiac disease
glm(comps_pulmonary_embolism ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial")
summary(glm(comps_pulmonary_embolism ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"))
anova(glm(comps_pulmonary_embolism ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"), test="Chisq")
exp(cbind(OR = coef(glm(comps_pulmonary_embolism ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial")), confint(glm(comps_pulmonary_embolism ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"))))
#Comorbidity congestive heart failure- error
#Comorbidity hypertension
glm(comps_pulmonary_embolism ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial")
summary(glm(comps_pulmonary_embolism ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial"))
anova(glm(comps_pulmonary_embolism ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial"), test="Chisq")
exp(cbind(OR = coef(glm(comps_pulmonary_embolism ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial")), confint(glm(comps_pulmonary_embolism ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial"))))
#Comorbidity myocardial infarction- error
#Comorbidity peripheral vascular disease- error

#Complication pulmonary embolism or DVT
#Comorbidity cardiac arrhythmia- error
#Comorbidity chronic cardiac disease
glm(comps_pulmonary_embolism_or_dvt ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial")
summary(glm(comps_pulmonary_embolism_or_dvt ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"))
anova(glm(comps_pulmonary_embolism_or_dvt ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"), test="Chisq")
exp(cbind(OR = coef(glm(comps_pulmonary_embolism_or_dvt ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial")), confint(glm(comps_pulmonary_embolism_or_dvt ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"))))
#Comorbidity congestive heart failure- error
#Comorbidity hypertension- warnings
#Comorbidity myocardial infarction- NA
#Comorbidity peripheral vascular disease- error

#Complication stroke
#Comorbidity cardiac arrhythmia- warnings
#Comorbidity chronic cardiac disease
glm(comps_stroke ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial")
summary(glm(comps_stroke ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"))
anova(glm(comps_stroke ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"), test="Chisq")
exp(cbind(OR = coef(glm(comps_stroke ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial")), confint(glm(comps_stroke ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"))))
#Comorbidity congestive heart failure- error
#Comorbidity hypertension
glm(comps_stroke ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial")
summary(glm(comps_stroke ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial"))
anova(glm(comps_stroke ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial"), test="Chisq")
exp(cbind(OR = coef(glm(comps_stroke ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial")), confint(glm(comps_stroke ~ comorbid_hypertension + sex + age + I(age^2), data=data, family="binomial"))))
#Comorbidity myocardial infarction- error
#Comorbidity peripheral vascular disease- error

#Complication thromboembolic phenomena
#Comorbidity cardiac arrhythmia- error
#Comorbidity chronic cardiac disease
glm(comps_thromboembolic_phenomena ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial")
summary(glm(comps_thromboembolic_phenomena ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"))
anova(glm(comps_thromboembolic_phenomena ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"), test="Chisq")
exp(cbind(OR = coef(glm(comps_thromboembolic_phenomena ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial")), confint(glm(comps_thromboembolic_phenomena ~ comorbid_chronic_cardiac_disease + sex + age + I(age^2), data=data, family="binomial"))))
#Comorbidity congestive heart failure- error
#Comorbidity hypertension- warning
#Comorbidity myocardial infarction- error
#Comorbidity peripheral vascular disease- error

#Complication thromboembolism
#Comorbidity cardiac arrhythmia- error
#Comorbidity chronic cardiac disease- warning
#Comorbidity congestive heart failure- error
#Comorbidity hypertension- warning
#Comorbidity myocardial infarction- error
#Comorbidity peripheral vascular disease- error

#Graph for risk of cardiovascular complications
ComorbidityA <- c("Cardiac arrest- Cardiac arrhythmia", "Cardiac arrest- CCD", "Cardiac arrest- Hypertension", "Cardiac arrhythmia- CCD", "Cardiac arrhythmia- Hypertension", "Cardiac ischaemia- CCD", "Cardiac ischaemia- Hypertension", "Cardiomyopathy- CCD", "Cardiomyopathy- Hypertension", "Coagulation disorder- CCD", "Coagulation disorder- Hypertension", "Congestive heart failure- CCD", "Congestive heart failure- Hypertension", "Endocarditis- CCD", "Endocarditis, myocarditis, pericarditis- CCD", "Endocarditis, myocarditis, pericarditis- Hypertension", "Myocardial infarction- CCD", "Myocardial infarction- Hypertension", "Myocarditis, pericarditis- CCD", "Myocarditis, pericarditis- Hypertension", "Pleural effusion- CCD", "Pleural effusion- Hypertension", "Pulmonary embolism- CCD", "Pulmonary embolism- Hypertension", "Pulmonary embolism or DVT- CCD", "Stroke- CCD", "Stroke- Hypertension", "Thromboembolic phenomena- CCD")
ORA <- c(2.68, 3.13, 1.96, 4.41, 3.24, 5.45, 6.67, 9.12, 2.02, 2.95, 1.82, 24.85, 6.94, 3.80, 10.60, 2.55, 9.53, 2.19, 3.31, 1.32, 2.66, 2.05, 1.32, 1.24, 15.4, 3.07, 3.10, 0.093)
LowerCIA <- c(0.080, 2.16, 1.31, 3.28, 2.14, 2.91, 2.13, 3.98, 0.83, 2.13, 1.26, 12.03, 2.93, 1.32, 3.08, 0.39, 2.78, 0.81, 1.49, 0.59, 1.93, 1.39, 0.89, 0.84, 4.40, 1.65, 1.41, 0.0064)
UpperCIA <- c(202.35, 4.66, 3.11, 6.07, 5.20, 11.65, 40.4, 26.38, 6.71, 4.18, 2.74, 63.26, 22.58, 13.77, 66.77, 55.22, 60.01, 9.01, 8.39, 3.55, 3.76, 3.17, 2.02, 1.90, 98.03, 6.40, 8.74, 0.93)
ORComplicationsdata <- data.frame(ComorbidityA, ORA, LowerCIA, UpperCIA)
ORComplicationsdata
ggplot(ORComplicationsdata, aes(ComorbidityA, ORA)) + geom_point() + geom_errorbar(aes(ymin = LowerCIA, ymax = UpperCIA)) + xlab("Comorbidity") + ylab("Odds Ratio (95% CI)") + theme(axis.text.x = element_text(angle=90, hjust=1, vjust=0.5, size=15)) + theme(axis.title.x=element_text(size=15), axis.title.y=element_text(size=15), axis.text.y=element_text(size=15))
```

#Serological variables
```{r}
#APTT
ggplot(data, aes(x=lborres_lab_aptt)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory APTT") + theme(legend.position="bottom")

summary(data$lborres_lab_aptt)
lborreslabapttdata<-filter(data, lborres_lab_aptt>=0 & lborres_lab_aptt<=100)
summary(lborreslabapttdata$lborres_lab_aptt)

ggplot(lborreslabapttdata, aes(x=lborres_lab_aptt)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory APTT") + theme(legend.position="bottom")

table1(~ lborres_lab_aptt, data=lborreslabapttdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_aptt | comorbid_cardiac_arrhythmia, data=lborreslabapttdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_aptt | comorbid_chronic_cardiac_disease, data=lborreslabapttdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_aptt | comorbid_congestive_heart_failure, data=lborreslabapttdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_aptt | comorbid_hypertension, data=lborreslabapttdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_aptt | comorbid_myocardial_infarction, data=lborreslabapttdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_aptt | comorbid_peripheral_vascular_disease, data=lborreslabapttdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))

ggplot(lborreslabapttdata, aes(x=comorbid_cardiac_arrhythmia, y=lborres_lab_aptt)) + geom_boxplot()
ggplot(lborreslabapttdata, aes(x=comorbid_chronic_cardiac_disease, y=lborres_lab_aptt)) + geom_boxplot()
ggplot(lborreslabapttdata, aes(x=comorbid_congestive_heart_failure, y=lborres_lab_aptt)) + geom_boxplot()
ggplot(lborreslabapttdata, aes(x=comorbid_hypertension, y=lborres_lab_aptt)) + geom_boxplot()
ggplot(lborreslabapttdata, aes(x=comorbid_myocardial_infarction, y=lborres_lab_aptt)) + geom_boxplot()
ggplot(lborreslabapttdata, aes(x=comorbid_peripheral_vascular_disease, y=lborres_lab_aptt)) + geom_boxplot()

#Creatine kinase
ggplot(data, aes(x=lborres_lab_ck)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory Creatine Kinase") + theme(legend.position="bottom")

setDT(data)[lborresu_lab_ck == "mg/dL", lborres_lab_ck := lborres_lab_ck*0.00001 ]
setDT(data)[lborresu_lab_ck == "MG/DL", lborres_lab_ck := lborres_lab_ck*0.00001 ]
setDT(data)[lborresu_lab_ck == "mg/L", lborres_lab_ck := lborres_lab_ck*0.000001 ]
setDT(data)[lborresu_lab_ck == "MILIGRAM PER LITRE", lborres_lab_ck := lborres_lab_ck*0.000001 ]
setDT(data)[lborresu_lab_ck == "ng/L", lborres_lab_ck := lborres_lab_ck*0.000000001 ]
setDT(data)[lborresu_lab_ck == "ng/mL", lborres_lab_ck := lborres_lab_ck*0.000000000001 ]

lborreslabckdata<-filter(data, lborres_lab_ck>=0 & lborres_lab_ck<=1000)
summary(lborreslabckdata$lborres_lab_ck)

ggplot(lborreslabckdata, aes(x=lborres_lab_ck)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory Creatine Kinase") + theme(legend.position="bottom")

table1(~ lborres_lab_ck, data=lborreslabckdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_ck | comorbid_cardiac_arrhythmia, data=lborreslabckdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_ck | comorbid_chronic_cardiac_disease, data=lborreslabckdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_ck | comorbid_congestive_heart_failure, data=lborreslabckdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_ck | comorbid_hypertension, data=lborreslabckdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_ck | comorbid_myocardial_infarction, data=lborreslabckdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_ck | comorbid_peripheral_vascular_disease, data=lborreslabckdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))

ggplot(lborreslabckdata, aes(x=comorbid_cardiac_arrhythmia, y=lborres_lab_ck)) + geom_boxplot()
ggplot(lborreslabckdata, aes(x=comorbid_chronic_cardiac_disease, y=lborres_lab_ck)) + geom_boxplot()
ggplot(lborreslabckdata, aes(x=comorbid_congestive_heart_failure, y=lborres_lab_ck)) + geom_boxplot()
ggplot(lborreslabckdata, aes(x=comorbid_hypertension, y=lborres_lab_ck)) + geom_boxplot()
ggplot(lborreslabckdata, aes(x=comorbid_myocardial_infarction, y=lborres_lab_ck)) + geom_boxplot()
ggplot(lborreslabckdata, aes(x=comorbid_peripheral_vascular_disease, y=lborres_lab_ck)) + geom_boxplot()

#Creatinine- seems to have already worked
ggplot(data, aes(x=lborres_lab_creat)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory Creatinine") + theme(legend.position="bottom")

# Standardise measurements
setDT(data)[lborresu_lab_creat == "mg/dL", lborres_lab_creat := lborres_lab_creat*10 ]
setDT(data)[lborresu_lab_creat == "mg/dl", lborres_lab_creat := lborres_lab_creat*10 ]
setDT(data)[lborresu_lab_creat == "MG/DL", lborres_lab_creat := lborres_lab_creat*10 ]
setDT(data)[lborresu_lab_creat == "mmol/L", lborres_lab_creat := lborres_lab_creat*1000 ]
setDT(data)[lborresu_lab_creat == "MMOL/L", lborres_lab_creat := lborres_lab_creat*1000 ]
setDT(data)[lborresu_lab_creat == "U/L", lborres_lab_creat := lborres_lab_creat*0.000001 ]

setDT(data)[lborresu_lab_creat == "mg/dL", lborres_lab_creat := lborres_lab_creat/10 ]
setDT(data)[lborresu_lab_creat == "mg/dl", lborres_lab_creat := lborres_lab_creat/10 ]
setDT(data)[lborresu_lab_creat == "MG/DL", lborres_lab_creat := lborres_lab_creat/10 ]
setDT(data)[lborresu_lab_creat == "mmol/L", lborres_lab_creat := lborres_lab_creat/1000 ]
setDT(data)[lborresu_lab_creat == "MMOL/L", lborres_lab_creat := lborres_lab_creat/1000 ]
setDT(data)[lborresu_lab_creat == "U/L", lborres_lab_creat := lborres_lab_creat/0.000001 ]

lborreslabcreatininedata<-filter(data, lborres_lab_creat>=0 & lborres_lab_creat<=1000)
summary(lborreslabcreatininedata$lborres_lab_creat)

ggplot(lborreslabcreatininedata, aes(x=lborres_lab_creat)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory Creatinine") + theme(legend.position="bottom")

table1(~ lborres_lab_creat, data=lborreslabcreatininedata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_creat | comorbid_cardiac_arrhythmia, data=lborreslabcreatininedata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_creat | comorbid_chronic_cardiac_disease, data=lborreslabcreatininedata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_creat | comorbid_congestive_heart_failure, data=lborreslabcreatininedata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_creat | comorbid_hypertension, data=lborreslabcreatininedata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_creat | comorbid_myocardial_infarction, data=lborreslabcreatininedata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_creat | comorbid_peripheral_vascular_disease, data=lborreslabcreatininedata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))

ggplot(lborreslabcreatininedata, aes(x=comorbid_cardiac_arrhythmia, y=lborres_lab_creat)) + geom_boxplot()
ggplot(lborreslabcreatininedata, aes(x=comorbid_chronic_cardiac_disease, y=lborres_lab_creat)) + geom_boxplot()
ggplot(lborreslabcreatininedata, aes(x=comorbid_congestive_heart_failure, y=lborres_lab_creat)) + geom_boxplot()
ggplot(lborreslabcreatininedata, aes(x=comorbid_hypertension, y=lborres_lab_creat)) + geom_boxplot()
ggplot(lborreslabcreatininedata, aes(x=comorbid_myocardial_infarction, y=lborres_lab_creat)) + geom_boxplot()
ggplot(lborreslabcreatininedata, aes(x=comorbid_peripheral_vascular_disease, y=lborres_lab_creat)) + geom_boxplot()

#Prior code
# Creatinine

ggplot(data, aes(x=lborres_lab_creat)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory Creatinine") + theme(legend.position="bottom")

data %>%
  filter(!is.na(lborresu_lab_creat)) %>%
  ggplot(aes(x=reorder(lborresu_lab_creat, lborresu_lab_creat, function(x)-length(x))), na.rm = TRUE) +
  geom_bar(fill='red', na.rm = TRUE) +  labs(x='Creatinine Units')

sum(is.na(data$lborres_lab_creat))
(sum(is.na(data$lborres_lab_creat))/800459)*100

# Standardise measurements
setDT(data)[lborresu_lab_creat == "mg/dL", lborres_lab_creat := lborres_lab_creat*10 ]
setDT(data)[lborresu_lab_creat == "mg/dl", lborres_lab_creat := lborres_lab_creat*10 ]
setDT(data)[lborresu_lab_creat == "MG/DL", lborres_lab_creat := lborres_lab_creat*10 ]
setDT(data)[lborresu_lab_creat == "mmol/L", lborres_lab_creat := lborres_lab_creat*1000 ]
setDT(data)[lborresu_lab_creat == "MMOL/L", lborres_lab_creat := lborres_lab_creat*1000 ]
setDT(data)[lborresu_lab_creat == "U/L", lborres_lab_creat := lborres_lab_creat*0.000001 ]

data$lborres_lab_creat[data$lborres_lab_creat > 1000] <- NA
data$lborres_lab_creat[data$lborres_lab_creat < 0] <- NA

ggplot(data, aes(x=lborres_lab_creat)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory Creatinine") + theme(legend.position="bottom")

#C reactive protein (CRP)
ggplot(data, aes(x=lborres_lab_crp)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory C reactive protein") + theme(legend.position="bottom")

setDT(data)[lborresu_lab_crp == "mg/dL", lborres_lab_crp := lborres_lab_crp*10 ]
setDT(data)[lborresu_lab_crp == "mg/dl", lborres_lab_crp := lborres_lab_crp*10 ]
setDT(data)[lborresu_lab_crp == "ML/DL", lborres_lab_crp := lborres_lab_crp*10 ]
setDT(data)[lborresu_lab_crp == "MG/DL", lborres_lab_crp := lborres_lab_crp*10 ]
setDT(data)[lborresu_lab_crp == "nmol/L", lborres_lab_crp := lborres_lab_crp*0.105 ]
setDT(data)[lborresu_lab_crp == "MMOL/L", lborres_lab_crp := lborres_lab_crp*105000 ]
setDT(data)[lborresu_lab_crp == "ng/ml", lborres_lab_crp := lborres_lab_crp*0.001 ]

lborreslabcrpdata<-filter(data, lborres_lab_crp>=0 & lborres_lab_crp<=30)

summary(lborreslabcrpdata$lborres_lab_crp)

ggplot(lborreslabcrpdata, aes(x=lborres_lab_crp)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory C reactive protein") + theme(legend.position="bottom")

table1(~ lborres_lab_crp, data=lborreslabcrpdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_crp | comorbid_cardiac_arrhythmia, data=lborreslabcrpdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_crp | comorbid_chronic_cardiac_disease, data=lborreslabcrpdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_crp | comorbid_congestive_heart_failure, data=lborreslabcrpdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_crp | comorbid_hypertension, data=lborreslabcrpdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_crp | comorbid_myocardial_infarction, data=lborreslabcrpdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_crp | comorbid_peripheral_vascular_disease, data=lborreslabcrpdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))

ggplot(lborreslabcrpdata, aes(x=comorbid_cardiac_arrhythmia, y=lborres_lab_crp)) + geom_boxplot()
ggplot(lborreslabcrpdata, aes(x=comorbid_chronic_cardiac_disease, y=lborres_lab_crp)) + geom_boxplot()
ggplot(lborreslabcrpdata, aes(x=comorbid_congestive_heart_failure, y=lborres_lab_crp)) + geom_boxplot()
ggplot(lborreslabcrpdata, aes(x=comorbid_hypertension, y=lborres_lab_crp)) + geom_boxplot()
ggplot(lborreslabcrpdata, aes(x=comorbid_myocardial_infarction, y=lborres_lab_crp)) + geom_boxplot()
ggplot(lborreslabcrpdata, aes(x=comorbid_peripheral_vascular_disease, y=lborres_lab_crp)) + geom_boxplot()

#D-dimer
ggplot(data, aes(x=lborres_lab_ddimer)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory Ddimer") + theme(legend.position="bottom")

# Standardise measurements (ng/mL)
setDT(data)[lborresu_lab_ddimer == "mg/L", lborres_lab_ddimer := lborres_lab_ddimer*1000000000 ]
setDT(data)[lborresu_lab_ddimer == "ug/L", lborres_lab_ddimer := lborres_lab_ddimer*1000000 ]
setDT(data)[lborresu_lab_ddimer == "ug/mL", lborres_lab_ddimer := lborres_lab_ddimer*1000 ]

lborreslabddimerdata<-filter(data, lborres_lab_ddimer>=0 & lborres_lab_ddimer<=1000)
summary(lborreslabddimerdata$lborres_lab_ddimer)

ggplot(lborreslabddimerdata, aes(x=lborres_lab_ddimer)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory Ddimer") + theme(legend.position="bottom")

table1(~ lborres_lab_ddimer, data=lborreslabddimerdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_ddimer | comorbid_cardiac_arrhythmia, data=lborreslabddimerdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_ddimer | comorbid_chronic_cardiac_disease, data=lborreslabddimerdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_ddimer | comorbid_congestive_heart_failure, data=lborreslabddimerdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_ddimer | comorbid_hypertension, data=lborreslabddimerdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_ddimer | comorbid_myocardial_infarction, data=lborreslabddimerdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_ddimer | comorbid_peripheral_vascular_disease, data=lborreslabddimerdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))

ggplot(lborreslabddimerdata, aes(x=comorbid_cardiac_arrhythmia, y=lborres_lab_ddimer)) + geom_boxplot()
ggplot(lborreslabddimerdata, aes(x=comorbid_chronic_cardiac_disease, y=lborres_lab_ddimer)) + geom_boxplot()
ggplot(lborreslabddimerdata, aes(x=comorbid_congestive_heart_failure, y=lborres_lab_ddimer)) + geom_boxplot()
ggplot(lborreslabddimerdata, aes(x=comorbid_hypertension, y=lborres_lab_ddimer)) + geom_boxplot()
ggplot(lborreslabddimerdata, aes(x=comorbid_myocardial_infarction, y=lborres_lab_ddimer)) + geom_boxplot()
ggplot(lborreslabddimerdata, aes(x=comorbid_peripheral_vascular_disease, y=lborres_lab_ddimer)) + geom_boxplot()

#Ferritin
ggplot(data, aes(x=lborres_lab_ferritin)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory Ferritin") + theme(legend.position="bottom")

lborreslabferritindata<-filter(data, lborres_lab_ferritin>=0 & lborres_lab_ferritin<=1000)
summary(lborreslabferritindata$lborres_lab_ferritin)

ggplot(lborreslabferritindata, aes(x=lborres_lab_ferritin)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory Ferritin") + theme(legend.position="bottom")

table1(~ lborres_lab_ferritin, data=lborreslabferritindata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_ferritin | comorbid_cardiac_arrhythmia, data=lborreslabferritindata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_ferritin | comorbid_chronic_cardiac_disease, data=lborreslabferritindata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_ferritin | comorbid_congestive_heart_failure, data=lborreslabferritindata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_ferritin | comorbid_hypertension, data=lborreslabferritindata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_ferritin | comorbid_myocardial_infarction, data=lborreslabferritindata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_ferritin | comorbid_peripheral_vascular_disease, data=lborreslabferritindata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))

ggplot(lborreslabferritindata, aes(x=comorbid_cardiac_arrhythmia, y=lborres_lab_ferritin)) + geom_boxplot()
ggplot(lborreslabferritindata, aes(x=comorbid_chronic_cardiac_disease, y=lborres_lab_ferritin)) + geom_boxplot()
ggplot(lborreslabferritindata, aes(x=comorbid_congestive_heart_failure, y=lborres_lab_ferritin)) + geom_boxplot()
ggplot(lborreslabferritindata, aes(x=comorbid_hypertension, y=lborres_lab_ferritin)) + geom_boxplot()
ggplot(lborreslabferritindata, aes(x=comorbid_myocardial_infarction, y=lborres_lab_ferritin)) + geom_boxplot()
ggplot(lborreslabferritindata, aes(x=comorbid_peripheral_vascular_disease, y=lborres_lab_ferritin)) + geom_boxplot()

#Fibrinogen
ggplot(data, aes(x=lborres_lab_fibrino)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory Fibrino") + theme(legend.position="bottom")

# Standardise measurements
setDT(data)[lborresu_lab_fibrino == "g/L", lborres_lab_fibrino := lborres_lab_fibrino*100 ]

lborreslabfibrinodata<-filter(data, lborres_lab_fibrino>=0 & lborres_lab_fibrino<=1000)

summary(lborreslabfibrinodata$lborres_lab_fibrino)

ggplot(lborreslabfibrinodata, aes(x=lborres_lab_fibrino)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory Fibrino") + theme(legend.position="bottom")

table1(~ lborres_lab_fibrino, data=lborreslabfibrinodata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_fibrino | comorbid_cardiac_arrhythmia, data=lborreslabfibrinodata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_fibrino | comorbid_chronic_cardiac_disease, data=lborreslabfibrinodata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_fibrino | comorbid_congestive_heart_failure, data=lborreslabfibrinodata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_fibrino | comorbid_hypertension, data=lborreslabfibrinodata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_fibrino | comorbid_myocardial_infarction, data=lborreslabfibrinodata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_fibrino | comorbid_peripheral_vascular_disease, data=lborreslabfibrinodata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))

ggplot(lborreslabfibrinodata, aes(x=comorbid_cardiac_arrhythmia, y=lborres_lab_fibrino)) + geom_boxplot()
ggplot(lborreslabfibrinodata, aes(x=comorbid_chronic_cardiac_disease, y=lborres_lab_fibrino)) + geom_boxplot()
ggplot(lborreslabfibrinodata, aes(x=comorbid_congestive_heart_failure, y=lborres_lab_fibrino)) + geom_boxplot()
ggplot(lborreslabfibrinodata, aes(x=comorbid_hypertension, y=lborres_lab_fibrino)) + geom_boxplot()
ggplot(lborreslabfibrinodata, aes(x=comorbid_myocardial_infarction, y=lborres_lab_fibrino)) + geom_boxplot()
ggplot(lborreslabfibrinodata, aes(x=comorbid_peripheral_vascular_disease, y=lborres_lab_fibrino)) + geom_boxplot()

#Fibrinogen F
ggplot(data, aes(x=lborres_lab_fibrinof)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory Fibrinof") + theme(legend.position="bottom")

# Standardise measurements
setDT(data)[lborresu_lab_fibrinof == "g/L", lborres_lab_fibrinof := lborres_lab_fibrinof*100 ]

lborreslabfibrinofdata<-filter(data, lborres_lab_fibrinof>=0 & lborres_lab_fibrinof<=1000)

summary(lborreslabfibrinofdata$lborres_lab_fibrinof)

ggplot(lborreslabfibrinofdata, aes(x=lborres_lab_fibrinof)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory Fibrinof") + theme(legend.position="bottom")

table1(~ lborres_lab_fibrinof, data=lborreslabfibrinofdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_fibrinof | comorbid_cardiac_arrhythmia, data=lborreslabfibrinofdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_fibrinof | comorbid_chronic_cardiac_disease, data=lborreslabfibrinofdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_fibrinof | comorbid_congestive_heart_failure, data=lborreslabfibrinofdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_fibrinof | comorbid_hypertension, data=lborreslabfibrinofdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_fibrinof | comorbid_myocardial_infarction, data=lborreslabfibrinofdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_fibrinof | comorbid_peripheral_vascular_disease, data=lborreslabfibrinofdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))

ggplot(lborreslabfibrinofdata, aes(x=comorbid_cardiac_arrhythmia, y=lborres_lab_fibrinof)) + geom_boxplot()
ggplot(lborreslabfibrinofdata, aes(x=comorbid_chronic_cardiac_disease, y=lborres_lab_fibrinof)) + geom_boxplot()
ggplot(lborreslabfibrinofdata, aes(x=comorbid_congestive_heart_failure, y=lborres_lab_fibrinof)) + geom_boxplot()
ggplot(lborreslabfibrinofdata, aes(x=comorbid_hypertension, y=lborres_lab_fibrinof)) + geom_boxplot()
ggplot(lborreslabfibrinofdata, aes(x=comorbid_myocardial_infarction, y=lborres_lab_fibrinof)) + geom_boxplot()
ggplot(lborreslabfibrinofdata, aes(x=comorbid_peripheral_vascular_disease, y=lborres_lab_fibrinof)) + geom_boxplot()

#Intlk6
ggplot(data, aes(x=lborres_lab_intlk6)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory INTLK6") + theme(legend.position="bottom")

# Standardise measurements
setDT(data)[lborresu_lab_intlk6 == "ng/L", lborres_lab_intlk6 := (lborres_lab_intlk6*0.000001)]

ggplot(data, aes(x=lborres_lab_intlk6)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory INTLK6") + theme(legend.position="bottom")

table1(~ lborres_lab_intlk6, data=data, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_intlk6 | comorbid_cardiac_arrhythmia, data=data, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_intlk6 | comorbid_chronic_cardiac_disease, data=data, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_intlk6 | comorbid_congestive_heart_failure, data=data, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_intlk6 | comorbid_hypertension, data=data, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_intlk6 | comorbid_myocardial_infarction, data=data, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_intlk6 | comorbid_peripheral_vascular_disease, data=data, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))

ggplot(data, aes(x=comorbid_cardiac_arrhythmia, y=lborres_lab_intlk6)) + geom_boxplot()
ggplot(data, aes(x=comorbid_chronic_cardiac_disease, y=lborres_lab_intlk6)) + geom_boxplot()
ggplot(data, aes(x=comorbid_congestive_heart_failure, y=lborres_lab_intlk6)) + geom_boxplot()
ggplot(data, aes(x=comorbid_hypertension, y=lborres_lab_intlk6)) + geom_boxplot()
ggplot(data, aes(x=comorbid_myocardial_infarction, y=lborres_lab_intlk6)) + geom_boxplot()
ggplot(data, aes(x=comorbid_peripheral_vascular_disease, y=lborres_lab_intlk6)) + geom_boxplot()

#Lactate dehydrogenase
ggplot(data, aes(x=lborres_lab_ldh)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory LDH") + theme(legend.position="bottom")

lborreslabldhdata<-filter(data, lborres_lab_ldh>=0 & lborres_lab_ldh<=1000)
summary(lborreslabldhdata$lborres_lab_ldh)

ggplot(lborreslabldhdata, aes(x=lborres_lab_ldh)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory LDH") + theme(legend.position="bottom")

table1(~ lborres_lab_ldh, data=lborreslabldhdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_ldh | comorbid_cardiac_arrhythmia, data=lborreslabldhdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_ldh | comorbid_chronic_cardiac_disease, data=lborreslabldhdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_ldh | comorbid_congestive_heart_failure, data=lborreslabldhdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_ldh | comorbid_hypertension, data=lborreslabldhdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_ldh | comorbid_myocardial_infarction, data=lborreslabldhdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_ldh | comorbid_peripheral_vascular_disease, data=lborreslabldhdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))

ggplot(lborreslabldhdata, aes(x=comorbid_cardiac_arrhythmia, y=lborres_lab_ldh)) + geom_boxplot()
ggplot(lborreslabldhdata, aes(x=comorbid_chronic_cardiac_disease, y=lborres_lab_ldh)) + geom_boxplot()
ggplot(lborreslabldhdata, aes(x=comorbid_congestive_heart_failure, y=lborres_lab_ldh)) + geom_boxplot()
ggplot(lborreslabldhdata, aes(x=comorbid_hypertension, y=lborres_lab_ldh)) + geom_boxplot()
ggplot(lborreslabldhdata, aes(x=comorbid_myocardial_infarction, y=lborres_lab_ldh)) + geom_boxplot()
ggplot(lborreslabldhdata, aes(x=comorbid_peripheral_vascular_disease, y=lborres_lab_ldh)) + geom_boxplot()

#Lymphocytes
ggplot(data, aes(x=lborres_lab_lym)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory Lymphocytes") + theme(legend.position="bottom")

# Standardise measurements
setDT(data)[lborresu_lab_lym == "10^6/L", lborres_lab_lym := (lborres_lab_lym/1000)]

lborreslablymdata<-filter(data, lborres_lab_lym>=0 & lborres_lab_lym<=15)

summary(lborreslablymdata$lborres_lab_lym)

ggplot(lborreslablymdata, aes(x=lborres_lab_lym)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory Lymphocytes") + theme(legend.position="bottom")

table1(~ lborres_lab_lym, data=lborreslablymdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_lym | comorbid_cardiac_arrhythmia, data=lborreslablymdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_lym | comorbid_chronic_cardiac_disease, data=lborreslablymdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_lym | comorbid_congestive_heart_failure, data=lborreslablymdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_lym | comorbid_hypertension, data=lborreslablymdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_lym | comorbid_myocardial_infarction, data=lborreslablymdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_lym | comorbid_peripheral_vascular_disease, data=lborreslablymdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))

ggplot(lborreslablymdata, aes(x=comorbid_cardiac_arrhythmia, y=lborres_lab_lym)) + geom_boxplot()
ggplot(lborreslablymdata, aes(x=comorbid_chronic_cardiac_disease, y=lborres_lab_lym)) + geom_boxplot()
ggplot(lborreslablymdata, aes(x=comorbid_congestive_heart_failure, y=lborres_lab_lym)) + geom_boxplot()
ggplot(lborreslablymdata, aes(x=comorbid_hypertension, y=lborres_lab_lym)) + geom_boxplot()
ggplot(lborreslablymdata, aes(x=comorbid_myocardial_infarction, y=lborres_lab_lym)) + geom_boxplot()
ggplot(lborreslablymdata, aes(x=comorbid_peripheral_vascular_disease, y=lborres_lab_lym)) + geom_boxplot()

#Monocytes
ggplot(data, aes(x=lborres_lab_mono)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory Monocytes") + theme(legend.position="bottom")

# Standardise measurements
setDT(data)[lborresu_lab_mono == "10^6/L", lborres_lab_mono := (lborres_lab_mono/1000)]

lborreslabmonodata<-filter(data, lborres_lab_mono>=0 & lborres_lab_mono<=2)
summary(lborreslabmonodata$lborres_lab_mono)

ggplot(lborreslabmonodata, aes(x=lborres_lab_mono)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory Monocytes") + theme(legend.position="bottom")

table1(~ lborres_lab_mono, data=lborreslabmonodata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_mono | comorbid_cardiac_arrhythmia, data=lborreslabmonodata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_mono | comorbid_chronic_cardiac_disease, data=lborreslabmonodata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_mono | comorbid_congestive_heart_failure, data=lborreslabmonodata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_mono | comorbid_hypertension, data=lborreslabmonodata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_mono | comorbid_myocardial_infarction, data=lborreslabmonodata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_mono | comorbid_peripheral_vascular_disease, data=lborreslabmonodata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))

ggplot(lborreslabmonodata, aes(x=comorbid_cardiac_arrhythmia, y=lborres_lab_mono)) + geom_boxplot()
ggplot(lborreslabmonodata, aes(x=comorbid_chronic_cardiac_disease, y=lborres_lab_mono)) + geom_boxplot()
ggplot(lborreslabmonodata, aes(x=comorbid_congestive_heart_failure, y=lborres_lab_mono)) + geom_boxplot()
ggplot(lborreslabmonodata, aes(x=comorbid_hypertension, y=lborres_lab_mono)) + geom_boxplot()
ggplot(lborreslabmonodata, aes(x=comorbid_myocardial_infarction, y=lborres_lab_mono)) + geom_boxplot()
ggplot(lborreslabmonodata, aes(x=comorbid_peripheral_vascular_disease, y=lborres_lab_mono)) + geom_boxplot()

#Neutrophils
ggplot(data, aes(x=lborres_lab_neut)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory Neutrophils") + theme(legend.position="bottom")

# Standardise measurements
setDT(data)[lborresu_lab_neut == "10^6/L", lborres_lab_neut := (lborres_lab_neut/1000)]

lborreslabneutdata<-filter(data, lborres_lab_neut>=0 & lborres_lab_neut<=15)
summary(lborreslabneutdata$lborres_lab_neut)

ggplot(lborreslabneutdata, aes(x=lborres_lab_neut)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory Neutrophils") + theme(legend.position="bottom")

table1(~ lborres_lab_neut, data=lborreslabneutdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_neut | comorbid_cardiac_arrhythmia, data=lborreslabneutdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_neut | comorbid_chronic_cardiac_disease, data=lborreslabneutdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_neut | comorbid_congestive_heart_failure, data=lborreslabneutdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_neut | comorbid_hypertension, data=lborreslabneutdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_neut | comorbid_myocardial_infarction, data=lborreslabneutdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_neut | comorbid_peripheral_vascular_disease, data=lborreslabneutdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))

ggplot(lborreslabneutdata, aes(x=comorbid_cardiac_arrhythmia, y=lborres_lab_neut)) + geom_boxplot()
ggplot(lborreslabneutdata, aes(x=comorbid_chronic_cardiac_disease, y=lborres_lab_neut)) + geom_boxplot()
ggplot(lborreslabneutdata, aes(x=comorbid_congestive_heart_failure, y=lborres_lab_neut)) + geom_boxplot()
ggplot(lborreslabneutdata, aes(x=comorbid_hypertension, y=lborres_lab_neut)) + geom_boxplot()
ggplot(lborreslabneutdata, aes(x=comorbid_myocardial_infarction, y=lborres_lab_neut)) + geom_boxplot()
ggplot(lborreslabneutdata, aes(x=comorbid_peripheral_vascular_disease, y=lborres_lab_neut)) + geom_boxplot()

#Procalcitonin
ggplot(data, aes(x=lborres_lab_pct)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory PCT") + theme(legend.position="bottom")

# Standardise measurements
setDT(data)[lborresu_lab_pct == "pg/mL", lborres_lab_pct := (lborres_lab_pct*0.001)]

lborreslabpctdata<-filter(data, lborres_lab_pct>=0 & lborres_lab_pct<=10)
summary(lborreslabpctdata$lborres_lab_pct)

ggplot(lborreslabpctdata, aes(x=lborres_lab_pct)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory PCT") + theme(legend.position="bottom")

table1(~ lborres_lab_pct, data=lborreslabpctdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_pct | comorbid_cardiac_arrhythmia, data=lborreslabpctdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_pct | comorbid_chronic_cardiac_disease, data=lborreslabpctdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_pct | comorbid_congestive_heart_failure, data=lborreslabpctdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_pct | comorbid_hypertension, data=lborreslabpctdata,render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_pct | comorbid_myocardial_infarction, data=lborreslabpctdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_pct | comorbid_peripheral_vascular_disease, data=lborreslabpctdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))

ggplot(lborreslabpctdata, aes(x=comorbid_cardiac_arrhythmia, y=lborres_lab_pct)) + geom_boxplot()
ggplot(lborreslabpctdata, aes(x=comorbid_chronic_cardiac_disease, y=lborres_lab_pct)) + geom_boxplot()
ggplot(lborreslabpctdata, aes(x=comorbid_congestive_heart_failure, y=lborres_lab_pct)) + geom_boxplot()
ggplot(lborreslabpctdata, aes(x=comorbid_hypertension, y=lborres_lab_pct)) + geom_boxplot()
ggplot(lborreslabpctdata, aes(x=comorbid_myocardial_infarction, y=lborres_lab_pct)) + geom_boxplot()
ggplot(lborreslabpctdata, aes(x=comorbid_peripheral_vascular_disease, y=lborres_lab_pct)) + geom_boxplot()

#Platelets
ggplot(data, aes(x=lborres_lab_plat)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory Platelets") + theme(legend.position="bottom")

lborreslabplatdata<-filter(data, lborres_lab_plat>=0 & lborres_lab_plat<=1000)
summary(lborreslabplatdata$lborres_lab_plat)

ggplot(lborreslabplatdata, aes(x=lborres_lab_plat)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory Platelets") + theme(legend.position="bottom")

table1(~ lborres_lab_plat, data=lborreslabplatdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_plat | comorbid_cardiac_arrhythmia, data=lborreslabplatdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_plat | comorbid_chronic_cardiac_disease, data=lborreslabplatdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_plat | comorbid_congestive_heart_failure, data=lborreslabplatdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_plat | comorbid_hypertension, data=lborreslabplatdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_plat | comorbid_myocardial_infarction, data=lborreslabplatdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_plat | comorbid_peripheral_vascular_disease, data=lborreslabplatdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))

ggplot(lborreslabplatdata, aes(x=comorbid_cardiac_arrhythmia, y=lborres_lab_plat)) + geom_boxplot()
ggplot(lborreslabplatdata, aes(x=comorbid_chronic_cardiac_disease, y=lborres_lab_plat)) + geom_boxplot()
ggplot(lborreslabplatdata, aes(x=comorbid_congestive_heart_failure, y=lborres_lab_plat)) + geom_boxplot()
ggplot(lborreslabplatdata, aes(x=comorbid_hypertension, y=lborres_lab_plat)) + geom_boxplot()
ggplot(lborreslabplatdata, aes(x=comorbid_myocardial_infarction, y=lborres_lab_plat)) + geom_boxplot()
ggplot(lborreslabplatdata, aes(x=comorbid_peripheral_vascular_disease, y=lborres_lab_plat)) + geom_boxplot()

#Prothrombin time
ggplot(data, aes(x=lborres_lab_pt)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory Prothrombin Time") + theme(legend.position="bottom")

lborreslabptdata<-filter(data, lborres_lab_pt>=0 & lborres_lab_pt<=20)
summary(lborreslabptdata$lborres_lab_pt)

ggplot(lborreslabptdata, aes(x=lborres_lab_pt)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory Prothrombin Time") + theme(legend.position="bottom")

table1(~ lborres_lab_pt, data=lborreslabptdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_pt | comorbid_cardiac_arrhythmia, data=lborreslabptdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_pt | comorbid_chronic_cardiac_disease, data=lborreslabptdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_pt | comorbid_congestive_heart_failure, data=lborreslabptdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_pt | comorbid_hypertension, data=lborreslabptdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_pt | comorbid_myocardial_infarction, data=lborreslabptdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_pt | comorbid_peripheral_vascular_disease, data=lborreslabptdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))

ggplot(lborreslabptdata, aes(x=comorbid_cardiac_arrhythmia, y=lborres_lab_pt)) + geom_boxplot()
ggplot(lborreslabptdata, aes(x=comorbid_chronic_cardiac_disease, y=lborres_lab_pt)) + geom_boxplot()
ggplot(lborreslabptdata, aes(x=comorbid_congestive_heart_failure, y=lborres_lab_pt)) + geom_boxplot()
ggplot(lborreslabptdata, aes(x=comorbid_hypertension, y=lborres_lab_pt)) + geom_boxplot()
ggplot(lborreslabptdata, aes(x=comorbid_myocardial_infarction, y=lborres_lab_pt)) + geom_boxplot()
ggplot(lborreslabptdata, aes(x=comorbid_peripheral_vascular_disease, y=lborres_lab_pt)) + geom_boxplot()

#T troponin I
ggplot(data, aes(x=lborres_lab_troponi)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory TROPONI") + theme(legend.position="bottom")

# Standardise measurements
setDT(data)[lborresu_lab_troponi == "ng/L", lborres_lab_troponi := (lborres_lab_troponi*0.001)]

lborreslabtroponidata<-filter(data, lborres_lab_troponi>=0 & lborres_lab_troponi<=0.1)
summary(lborreslabtroponidata$lborres_lab_troponi)

ggplot(lborreslabtroponidata, aes(x=lborres_lab_troponi)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory TROPONI") + theme(legend.position="bottom")

table1(~ lborres_lab_troponi, data=lborreslabtroponidata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_troponi | comorbid_cardiac_arrhythmia, data=lborreslabtroponidata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_troponi | comorbid_chronic_cardiac_disease, data=lborreslabtroponidata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_troponi | comorbid_congestive_heart_failure, data=lborreslabtroponidata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_troponi | comorbid_hypertension, data=lborreslabtroponidata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_troponi | comorbid_myocardial_infarction, data=lborreslabtroponidata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_troponi | comorbid_peripheral_vascular_disease, data=lborreslabtroponidata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))

ggplot(lborreslabtroponidata, aes(x=comorbid_cardiac_arrhythmia, y=lborres_lab_troponi)) + geom_boxplot()
ggplot(lborreslabtroponidata, aes(x=comorbid_chronic_cardiac_disease, y=lborres_lab_troponi)) + geom_boxplot()
ggplot(lborreslabtroponidata, aes(x=comorbid_congestive_heart_failure, y=lborres_lab_troponi)) + geom_boxplot()
ggplot(lborreslabtroponidata, aes(x=comorbid_hypertension, y=lborres_lab_troponi)) + geom_boxplot()
ggplot(lborreslabtroponidata, aes(x=comorbid_myocardial_infarction, y=lborres_lab_troponi)) + geom_boxplot()
ggplot(lborreslabtroponidata, aes(x=comorbid_peripheral_vascular_disease, y=lborres_lab_troponi)) + geom_boxplot()

#Troponin
ggplot(data, aes(x=lborres_lab_troponin)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory TROPONIN") + theme(legend.position="bottom")

# Standardise measurements
setDT(data)[lborresu_lab_troponin == "ng/L", lborres_lab_troponin := (lborres_lab_troponin*0.001)]

lborreslabtroponindata<-filter(data, lborres_lab_troponin>=0 & lborres_lab_troponin<=0.1)
summary(lborreslabtroponindata$lborres_lab_troponin)

ggplot(lborreslabtroponindata, aes(x=lborres_lab_troponin)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory TROPONIN") + theme(legend.position="bottom")

table1(~ lborres_lab_troponin, data=lborreslabtroponindata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_troponin | comorbid_cardiac_arrhythmia, data=lborreslabtroponindata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_troponin | comorbid_chronic_cardiac_disease, data=lborreslabtroponindata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_troponin | comorbid_congestive_heart_failure, data=lborreslabtroponindata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_troponin | comorbid_hypertension, data=lborreslabtroponindata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_troponin | comorbid_myocardial_infarction, data=lborreslabtroponindata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_troponin | comorbid_peripheral_vascular_disease, data=lborreslabtroponindata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))

ggplot(lborreslabtroponindata, aes(x=comorbid_cardiac_arrhythmia, y=lborres_lab_troponin)) + geom_boxplot()
ggplot(lborreslabtroponindata, aes(x=comorbid_chronic_cardiac_disease, y=lborres_lab_troponin)) + geom_boxplot()
ggplot(lborreslabtroponindata, aes(x=comorbid_congestive_heart_failure, y=lborres_lab_troponin)) + geom_boxplot()
ggplot(lborreslabtroponindata, aes(x=comorbid_hypertension, y=lborres_lab_troponin)) + geom_boxplot()
ggplot(lborreslabtroponindata, aes(x=comorbid_myocardial_infarction, y=lborres_lab_troponin)) + geom_boxplot()
ggplot(lborreslabtroponindata, aes(x=comorbid_peripheral_vascular_disease, y=lborres_lab_troponin)) + geom_boxplot()

#Troponin T
ggplot(data, aes(x=lborres_lab_tropont)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory TROPONIN T") + theme(legend.position="bottom")

table1(~ lborres_lab_tropont, data=data, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_tropont | comorbid_cardiac_arrhythmia, data=data, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_tropont | comorbid_chronic_cardiac_disease, data=data, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_tropont | comorbid_congestive_heart_failure, data=data, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_tropont | comorbid_hypertension, data=data, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_tropont | comorbid_myocardial_infarction, data=data, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_tropont | comorbid_peripheral_vascular_disease, data=data, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))

ggplot(data, aes(x=comorbid_cardiac_arrhythmia, y=lborres_lab_tropont)) + geom_boxplot()
ggplot(data, aes(x=comorbid_chronic_cardiac_disease, y=lborres_lab_tropont)) + geom_boxplot()
ggplot(data, aes(x=comorbid_congestive_heart_failure, y=lborres_lab_tropont)) + geom_boxplot()
ggplot(data, aes(x=comorbid_hypertension, y=lborres_lab_tropont)) + geom_boxplot()
ggplot(data, aes(x=comorbid_myocardial_infarction, y=lborres_lab_tropont)) + geom_boxplot()
ggplot(data, aes(x=comorbid_peripheral_vascular_disease, y=lborres_lab_tropont)) + geom_boxplot()

#White blood cell count
ggplot(data, aes(x=lborres_lab_wbc)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory WBC") + theme(legend.position="bottom")

# Standardise measurements
setDT(data)[lborresu_lab_wbc == "10^6/L", lborres_lab_wbc := (lborres_lab_wbc*0.001)]

lborreslabwbcdata<-filter(data, lborres_lab_wbc>=0 & lborres_lab_wbc<=20)
summary(lborreslabwbcdata$lborres_lab_wbc)

ggplot(lborreslabwbcdata, aes(x=lborres_lab_wbc)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory WBC") + theme(legend.position="bottom")

table1(~ lborres_lab_wbc, data=lborreslabwbcdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_wbc | comorbid_cardiac_arrhythmia, data=lborreslabwbcdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_wbc | comorbid_chronic_cardiac_disease, data=lborreslabwbcdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_wbc | comorbid_congestive_heart_failure, data=lborreslabwbcdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_wbc | comorbid_hypertension, data=lborreslabwbcdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_wbc | comorbid_myocardial_infarction, data=lborreslabwbcdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_wbc | comorbid_peripheral_vascular_disease, data=lborreslabwbcdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))

ggplot(lborreslabwbcdata, aes(x=comorbid_cardiac_arrhythmia, y=lborres_lab_wbc)) + geom_boxplot()
ggplot(lborreslabwbcdata, aes(x=comorbid_chronic_cardiac_disease, y=lborres_lab_wbc)) + geom_boxplot()
ggplot(lborreslabwbcdata, aes(x=comorbid_congestive_heart_failure, y=lborres_lab_wbc)) + geom_boxplot()
ggplot(lborreslabwbcdata, aes(x=comorbid_hypertension, y=lborres_lab_wbc)) + geom_boxplot()
ggplot(lborreslabwbcdata, aes(x=comorbid_myocardial_infarction, y=lborres_lab_wbc)) + geom_boxplot()
ggplot(lborreslabwbcdata, aes(x=comorbid_peripheral_vascular_disease, y=lborres_lab_wbc)) + geom_boxplot()

#ALT
ggplot(data, aes(x=lborres_lab_alt)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory ALT") + theme(legend.position="bottom")

# Standardise measurements
setDT(data)[lborresu_lab_alt == "ukat/L", lborres_lab_alt := lborres_lab_alt*58.8235294117647]
setDT(data)[lborresu_lab_alt == "ukat/l", lborres_lab_alt := lborres_lab_alt*58.8235294117647]

lborreslabaltdata<-filter(data, lborres_lab_alt>=0 & lborres_lab_alt<=100)
summary(lborreslabaltdata$lborres_lab_alt)

ggplot(lborreslabaltdata, aes(x=lborres_lab_alt)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory ALT") + theme(legend.position="bottom")

table1(~ lborres_lab_alt, data=lborreslabaltdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_alt | comorbid_cardiac_arrhythmia, data=lborreslabaltdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_alt | comorbid_chronic_cardiac_disease, data=lborreslabaltdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_alt | comorbid_congestive_heart_failure, data=lborreslabaltdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_alt | comorbid_hypertension, data=lborreslabaltdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_alt | comorbid_myocardial_infarction, data=lborreslabaltdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_alt | comorbid_peripheral_vascular_disease, data=lborreslabaltdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))

ggplot(lborreslabaltdata, aes(x=comorbid_cardiac_arrhythmia, y=lborres_lab_alt)) + geom_boxplot()
ggplot(lborreslabaltdata, aes(x=comorbid_chronic_cardiac_disease, y=lborres_lab_alt)) + geom_boxplot()
ggplot(lborreslabaltdata, aes(x=comorbid_congestive_heart_failure, y=lborres_lab_alt)) + geom_boxplot()
ggplot(lborreslabaltdata, aes(x=comorbid_hypertension, y=lborres_lab_alt)) + geom_boxplot()
ggplot(lborreslabaltdata, aes(x=comorbid_myocardial_infarction, y=lborres_lab_alt)) + geom_boxplot()
ggplot(lborreslabaltdata, aes(x=comorbid_peripheral_vascular_disease, y=lborres_lab_alt)) + geom_boxplot()

#AST
ggplot(data, aes(x=lborres_lab_ast)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory AST") + theme(legend.position="bottom")

# Standardise measurements
setDT(data)[lborresu_lab_ast == "nkat/L", lborres_lab_ast := lborres_lab_ast*0.06]
setDT(data)[lborresu_lab_ast == "mg/dL", lborres_lab_ast := lborres_lab_ast*0.00001]
setDT(data)[lborresu_lab_ast == "ukat/l", lborres_lab_ast := lborres_lab_ast*58.8235294117647]

lborreslabastdata<-filter(data, lborres_lab_ast>=0 & lborres_lab_ast<=100)
summary(lborreslabastdata$lborres_lab_ast)

ggplot(lborreslabastdata, aes(x=lborres_lab_ast)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory AST") + theme(legend.position="bottom")

table1(~ lborres_lab_ast, data=lborreslabastdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_ast | comorbid_cardiac_arrhythmia, data=lborreslabastdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_ast | comorbid_chronic_cardiac_disease, data=lborreslabastdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_ast | comorbid_congestive_heart_failure, data=lborreslabastdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_ast | comorbid_hypertension, data=lborreslabastdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_ast | comorbid_myocardial_infarction, data=lborreslabastdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_ast | comorbid_peripheral_vascular_disease, data=lborreslabastdata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))

ggplot(lborreslabastdata, aes(x=comorbid_cardiac_arrhythmia, y=lborres_lab_ast)) + geom_boxplot()
ggplot(lborreslabastdata, aes(x=comorbid_chronic_cardiac_disease, y=lborres_lab_ast)) + geom_boxplot()
ggplot(lborreslabastdata, aes(x=comorbid_congestive_heart_failure, y=lborres_lab_ast)) + geom_boxplot()
ggplot(lborreslabastdata, aes(x=comorbid_hypertension, y=lborres_lab_ast)) + geom_boxplot()
ggplot(lborreslabastdata, aes(x=comorbid_myocardial_infarction, y=lborres_lab_ast)) + geom_boxplot()
ggplot(lborreslabastdata, aes(x=comorbid_peripheral_vascular_disease, y=lborres_lab_ast)) + geom_boxplot()

#Bilirubin
ggplot(data, aes(x=lborres_lab_bili)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory Bilirubin") + theme(legend.position="bottom")

# Standardise measurements
setDT(data)[lborresu_lab_bili == "mg/dL", lborres_lab_bili := lborres_lab_bili*88.4 ]
setDT(data)[lborresu_lab_bili == "MG/DL", lborres_lab_bili := lborres_lab_bili*88.4 ]
setDT(data)[lborresu_lab_bili == "mg/dl", lborres_lab_bili := lborres_lab_bili*88.4 ]
setDT(data)[lborresu_lab_bili == "mg /dL", lborres_lab_bili := lborres_lab_bili*88.4 ]

lborreslabbilidata<-filter(data, lborres_lab_bili>=0 & lborres_lab_bili<=300)
summary(lborreslabbilidata$lborres_lab_bili)

ggplot(lborreslabbilidata, aes(x=lborres_lab_bili)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory Bilirubin") + theme(legend.position="bottom")

table1(~ lborres_lab_bili, data=lborreslabbilidata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_bili | comorbid_cardiac_arrhythmia, data=lborreslabbilidata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_bili | comorbid_chronic_cardiac_disease, data=lborreslabbilidata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_bili | comorbid_congestive_heart_failure, data=lborreslabbilidata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_bili | comorbid_hypertension, data=lborreslabbilidata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_bili | comorbid_myocardial_infarction, data=lborreslabbilidata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_bili | comorbid_peripheral_vascular_disease, data=lborreslabbilidata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))

ggplot(lborreslabbilidata, aes(x=comorbid_cardiac_arrhythmia, y=lborres_lab_bili)) + geom_boxplot()
ggplot(lborreslabbilidata, aes(x=comorbid_chronic_cardiac_disease, y=lborres_lab_bili)) + geom_boxplot()
ggplot(lborreslabbilidata, aes(x=comorbid_congestive_heart_failure, y=lborres_lab_bili)) + geom_boxplot()
ggplot(lborreslabbilidata, aes(x=comorbid_hypertension, y=lborres_lab_bili)) + geom_boxplot()
ggplot(lborreslabbilidata, aes(x=comorbid_myocardial_infarction, y=lborres_lab_bili)) + geom_boxplot()
ggplot(lborreslabbilidata, aes(x=comorbid_peripheral_vascular_disease, y=lborres_lab_bili)) + geom_boxplot()

#Urea
ggplot(data, aes(x=lborres_lab_urean)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory Urean") + theme(legend.position="bottom")

# Standardise measurements
setDT(data)[lborresu_lab_urean == "mg/dL", lborres_lab_urean := (lborres_lab_urean*0.0555)]
setDT(data)[lborresu_lab_urean == "mg/dl", lborres_lab_urean := (lborres_lab_urean*0.0555)]
setDT(data)[lborresu_lab_urean == "MG/DL", lborres_lab_urean := (lborres_lab_urean*0.0555)]

lborreslabureandata<-filter(data, lborres_lab_urean>=0 & lborres_lab_urean<=20)
summary(lborreslabureandata$lborres_lab_urean)

ggplot(lborreslabureandata, aes(x=lborres_lab_urean)) + geom_density(alpha = 0.4) + theme_bw() + theme(axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black")) + labs(x = "Laboratory Urean") + theme(legend.position="bottom")

table1(~ lborres_lab_urean, data=lborreslabureandata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_urean | comorbid_cardiac_arrhythmia, data=lborreslabureandata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_urean | comorbid_chronic_cardiac_disease, data=lborreslabureandata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_urean | comorbid_congestive_heart_failure, data=lborreslabureandata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_urean | comorbid_hypertension, data=lborreslabureandata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_urean | comorbid_myocardial_infarction, data=lborreslabureandata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))
table1(~ lborres_lab_urean | comorbid_peripheral_vascular_disease, data=lborreslabureandata, render.continuous=c(.="Median [Q1, Q3]", .="Mean [SD]"))

ggplot(lborreslabureandata, aes(x=comorbid_cardiac_arrhythmia, y=lborres_lab_urean)) + geom_boxplot()
ggplot(lborreslabureandata, aes(x=comorbid_chronic_cardiac_disease, y=lborres_lab_urean)) + geom_boxplot()
ggplot(lborreslabureandata, aes(x=comorbid_congestive_heart_failure, y=lborres_lab_urean)) + geom_boxplot()
ggplot(lborreslabureandata, aes(x=comorbid_hypertension, y=lborres_lab_urean)) + geom_boxplot()
ggplot(lborreslabureandata, aes(x=comorbid_myocardial_infarction, y=lborres_lab_urean)) + geom_boxplot()
ggplot(lborreslabureandata, aes(x=comorbid_peripheral_vascular_disease, y=lborres_lab_urean)) + geom_boxplot()
```

#Extra graphs for project presentation
```{r}
#Oxygen saturation graph
Oxygen <- c("Cardiac arrhythmia- True", "Cardiac arrhythmia- False", "Chronic cardiac disease- True", "Chronic cardiac disease- False", "Hypertension- True", "Hypertension- False", "Peripheral vascular disease- True", "Peripheral vascular disease- False", "Overall")
Percentage <- c(95.5, 98, 95, 96, 95, 96, 95, 94, 96)
LowerPercentage <- c(93.8, 95.5, 93, 93, 92, 93, 95, 94, 92)
UpperPercentage <- c(98, 99, 97, 98, 97, 98, 95, 94, 97)
Oxygendata <- data.frame(Oxygen, Percentage, LowerPercentage, UpperPercentage)
Oxygendata
ggplot(Oxygendata, aes(Oxygen, Percentage)) + geom_point() + geom_errorbar(aes(ymin = LowerPercentage, ymax = UpperPercentage)) + xlab("Comorbidity") + ylab("Oxygen saturation on admission (%), median [IQR]") + theme(axis.text.x = element_text(angle=55, hjust=1, vjust=1, size=17)) + theme(axis.title.x=element_text(size=17), axis.title.y=element_text(size=15), axis.text.y=element_text(size=15))

#Edited down version of graph for risk of cardiovascular complications
ComorbidityA1 <- c("Cardiac ischaemia- CCD", "Cardiomyopathy- CCD", "Congestive heart failure- CCD", "Endocarditis, myocarditis, pericarditis- CCD", "Myocardial infarction- CCD", "Pulmonary embolism or DVT- CCD", "Cardiac ischaemia- Hypertension", "Congestive heart failure- Hypertension")
ORA1 <- c(5.45, 9.12, 24.85, 10.60, 9.53, 15.4, 6.67, 6.94)
LowerCIA1 <- c(2.91, 3.98, 12.03, 3.08, 2.78, 4.40, 2.13, 2.93)
UpperCIA1 <- c(11.65, 26.38, 63.26, 66.77, 60.01, 98.03, 40.4, 22.58)
ORComplicationsdata1 <- data.frame(ComorbidityA1, ORA1, LowerCIA1, UpperCIA1)
ORComplicationsdata1
ggplot(ORComplicationsdata1, aes(ComorbidityA1, ORA1)) + geom_point() + geom_errorbar(aes(ymin = LowerCIA1, ymax = UpperCIA1)) + xlab("Comorbidity") + ylab("Odds Ratio (95% CI)") + theme(axis.text.x = element_text(angle=55, hjust=1, vjust=1, size=17)) + theme(axis.title.x=element_text(size=17), axis.title.y=element_text(size=17), axis.text.y=element_text(size=17))
```
